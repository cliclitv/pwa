(function(){"use strict";var t;function e(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}function r(t){var r="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return r?r.call(t):{next:e(t)}}function n(t){for(var e,r=[];!(e=t.next()).done;)r.push(e.value);return r}var i="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this,a="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,r){t!=Array.prototype&&t!=Object.prototype&&(t[e]=r.value)};function o(){o=function(){},i.Symbol||(i.Symbol=d)}function s(t,e){this.a=t,a(this,"description",{configurable:!0,writable:!0,value:e})}s.prototype.toString=function(){return this.a};var l,u,d=(l=0,function t(e){if(this instanceof t)throw new TypeError("Symbol is not a constructor");return new s("jscomp_symbol_"+(e||"")+"_"+l++,e)});function c(){o();var t=i.Symbol.iterator;t||(t=i.Symbol.iterator=i.Symbol("Symbol.iterator")),"function"!=typeof Array.prototype[t]&&a(Array.prototype,t,{configurable:!0,writable:!0,value:function(){return function(t){return c(),(t={next:t})[i.Symbol.iterator]=function(){return this},t}(e(this))}}),c=function(){}}if("function"==typeof Object.setPrototypeOf)u=Object.setPrototypeOf;else{var h;t:{var f={};try{f.__proto__={Pa:!0},h=f.Pa;break t}catch(Wt){}h=!1}u=h?function(t,e){if(t.__proto__=e,t.__proto__!==e)throw new TypeError(t+" is not extensible");return t}:null}var p=u;function v(){this.l=!1,this.b=null,this.Ea=void 0,this.a=1,this.Y=0,this.c=null}function g(t){if(t.l)throw new TypeError("Generator is already running");t.l=!0}function m(t,e){t.c={Sa:e,Wa:!0},t.a=t.Y}function y(t,e){return t.a=3,{value:e}}function _(t){this.a=new v,this.b=t}function b(t,e,r,n){try{var i=e.call(t.a.b,r);if(!(i instanceof Object))throw new TypeError("Iterator result "+i+" is not an object");if(!i.done)return t.a.l=!1,i;var a=i.value}catch(o){return t.a.b=null,m(t.a,o),E(t)}return t.a.b=null,n.call(t.a,a),E(t)}function E(t){for(;t.a.a;)try{var e=t.b(t.a);if(e)return t.a.l=!1,{value:e.value,done:!1}}catch(r){t.a.Ea=void 0,m(t.a,r)}if(t.a.l=!1,t.a.c){if(e=t.a.c,t.a.c=null,e.Wa)throw e.Sa;return{value:e.return,done:!0}}return{value:void 0,done:!0}}function T(t){this.next=function(e){return g(t.a),t.a.b?e=b(t,t.a.b.next,e,t.a.J):(t.a.J(e),e=E(t)),e},this.throw=function(e){return g(t.a),t.a.b?e=b(t,t.a.b.throw,e,t.a.J):(m(t.a,e),e=E(t)),e},this.return=function(e){return function(t,e){g(t.a);var r=t.a.b;return r?b(t,"return"in r?r.return:function(t){return{value:t,done:!0}},e,t.a.return):(t.a.return(e),E(t))}(t,e)},c(),this[Symbol.iterator]=function(){return this}}function S(t,e){return e=new T(new _(e)),p&&p(e,t.prototype),e}v.prototype.J=function(t){this.Ea=t},v.prototype.return=function(t){this.c={return:t},this.a=this.Y},Array.from||(Array.from=function(t){return[].slice.call(t)}),Object.assign||(Object.assign=function(t){for(var e,r=[].slice.call(arguments,1),n=0;n<r.length;n++)if(e=r[n])for(var i=t,a=e,o=Object.getOwnPropertyNames(a),s=0;s<o.length;s++)i[e=o[s]]=a[e];return t}),function(){if((e=document.createEvent("Event")).initEvent("foo",!0,!0),e.preventDefault(),!e.defaultPrevented){var t=Event.prototype.preventDefault;Event.prototype.preventDefault=function(){this.cancelable&&(t.call(this),Object.defineProperty(this,"defaultPrevented",{get:function(){return!0},configurable:!0}))}}var e,r=/Trident/.test(navigator.userAgent);if(!window.Event||r&&"function"!=typeof window.Event){var n=window.Event;if(window.Event=function(t,e){e=e||{};var r=document.createEvent("Event");return r.initEvent(t,!!e.bubbles,!!e.cancelable),r},n){for(var i in n)window.Event[i]=n[i];window.Event.prototype=n.prototype}}if((!window.CustomEvent||r&&"function"!=typeof window.CustomEvent)&&(window.CustomEvent=function(t,e){e=e||{};var r=document.createEvent("CustomEvent");return r.initCustomEvent(t,!!e.bubbles,!!e.cancelable,e.detail),r},window.CustomEvent.prototype=window.Event.prototype),!window.MouseEvent||r&&"function"!=typeof window.MouseEvent){if(r=window.MouseEvent,window.MouseEvent=function(t,e){e=e||{};var r=document.createEvent("MouseEvent");return r.initMouseEvent(t,!!e.bubbles,!!e.cancelable,e.view||window,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget),r},r)for(var a in r)window.MouseEvent[a]=r[a];window.MouseEvent.prototype=r.prototype}}(),function(){function t(){}function e(t,e){if(!t.childNodes.length)return[];switch(t.nodeType){case Node.DOCUMENT_NODE:return v.call(t,e);case Node.DOCUMENT_FRAGMENT_NODE:return g.call(t,e);default:return p.call(t,e)}}var r="undefined"==typeof HTMLTemplateElement,n=!(document.createDocumentFragment().cloneNode()instanceof DocumentFragment),i=!1;/Trident/.test(navigator.userAgent)&&function(){function t(t,e){if(t instanceof DocumentFragment)for(var n;n=t.firstChild;)r.call(this,n,e);else r.call(this,t,e);return t}i=!0;var e=Node.prototype.cloneNode;Node.prototype.cloneNode=function(t){return t=e.call(this,t),this instanceof DocumentFragment&&(t.__proto__=DocumentFragment.prototype),t},DocumentFragment.prototype.querySelectorAll=HTMLElement.prototype.querySelectorAll,DocumentFragment.prototype.querySelector=HTMLElement.prototype.querySelector,Object.defineProperties(DocumentFragment.prototype,{nodeType:{get:function(){return Node.DOCUMENT_FRAGMENT_NODE},configurable:!0},localName:{get:function(){},configurable:!0},nodeName:{get:function(){return"#document-fragment"},configurable:!0}});var r=Node.prototype.insertBefore;Node.prototype.insertBefore=t;var n=Node.prototype.appendChild;Node.prototype.appendChild=function(e){return e instanceof DocumentFragment?t.call(this,e,null):n.call(this,e),e};var a=Node.prototype.removeChild,o=Node.prototype.replaceChild;Node.prototype.replaceChild=function(e,r){return e instanceof DocumentFragment?(t.call(this,e,r),a.call(this,r)):o.call(this,e,r),r},Document.prototype.createDocumentFragment=function(){var t=this.createElement("df");return t.__proto__=DocumentFragment.prototype,t};var s=Document.prototype.importNode;Document.prototype.importNode=function(t,e){return e=s.call(this,t,e||!1),t instanceof DocumentFragment&&(e.__proto__=DocumentFragment.prototype),e}}();var a=Node.prototype.cloneNode,o=Document.prototype.createElement,s=Document.prototype.importNode,l=Node.prototype.removeChild,u=Node.prototype.appendChild,d=Node.prototype.replaceChild,c=DOMParser.prototype.parseFromString,h=Object.getOwnPropertyDescriptor(window.HTMLElement.prototype,"innerHTML")||{get:function(){return this.innerHTML},set:function(t){this.innerHTML=t}},f=Object.getOwnPropertyDescriptor(window.Node.prototype,"childNodes")||{get:function(){return this.childNodes}},p=Element.prototype.querySelectorAll,v=Document.prototype.querySelectorAll,g=DocumentFragment.prototype.querySelectorAll,m=function(){if(!r){var t=document.createElement("template"),e=document.createElement("template");return e.content.appendChild(document.createElement("div")),t.content.appendChild(e),0===(t=t.cloneNode(!0)).content.childNodes.length||0===t.content.firstChild.content.childNodes.length||n}}();if(r){var y=document.implementation.createHTMLDocument("template"),_=!0,b=document.createElement("style");b.textContent="template{display:none;}";var E=document.head;E.insertBefore(b,E.firstElementChild),t.prototype=Object.create(HTMLElement.prototype);var T=!document.createElement("div").hasOwnProperty("innerHTML");t.U=function(e){if(!e.content&&e.namespaceURI===document.documentElement.namespaceURI){e.content=y.createDocumentFragment();for(var r;r=e.firstChild;)u.call(e.content,r);if(T)e.__proto__=t.prototype;else if(e.cloneNode=function(e){return t.b(this,e)},_)try{w(e),A(e)}catch(n){_=!1}t.a(e.content)}};var S={option:["select"],thead:["table"],col:["colgroup","table"],tr:["tbody","table"],th:["tr","tbody","table"],td:["tr","tbody","table"]},w=function(e){Object.defineProperty(e,"innerHTML",{get:function(){return O(this)},set:function(e){var r=S[(/<([a-z][^/\0>\x20\t\r\n\f]+)/i.exec(e)||["",""])[1].toLowerCase()];if(r)for(var n=0;n<r.length;n++)e="<"+r[n]+">"+e+"</"+r[n]+">";for(y.body.innerHTML=e,t.a(y);this.content.firstChild;)l.call(this.content,this.content.firstChild);if(e=y.body,r)for(n=0;n<r.length;n++)e=e.lastChild;for(;e.firstChild;)u.call(this.content,e.firstChild)},configurable:!0})},A=function(t){Object.defineProperty(t,"outerHTML",{get:function(){return"<template>"+this.innerHTML+"</template>"},set:function(t){if(!this.parentNode)throw Error("Failed to set the 'outerHTML' property on 'Element': This element has no parent node.");for(y.body.innerHTML=t,t=this.ownerDocument.createDocumentFragment();y.body.firstChild;)u.call(t,y.body.firstChild);d.call(this.parentNode,t,this)},configurable:!0})};w(t.prototype),A(t.prototype),t.a=function(r){for(var n,i=0,a=(r=e(r,"template")).length;i<a&&(n=r[i]);i++)t.U(n)},document.addEventListener("DOMContentLoaded",(function(){t.a(document)})),Document.prototype.createElement=function(){var e=o.apply(this,arguments);return"template"===e.localName&&t.U(e),e},DOMParser.prototype.parseFromString=function(){var e=c.apply(this,arguments);return t.a(e),e},Object.defineProperty(HTMLElement.prototype,"innerHTML",{get:function(){return O(this)},set:function(e){h.set.call(this,e),t.a(this)},configurable:!0,enumerable:!0});var C=/[&\u00A0"]/g,R=/[&\u00A0<>]/g,L=function(t){switch(t){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case" ":return"&nbsp;"}},D=(b=function(t){for(var e={},r=0;r<t.length;r++)e[t[r]]=!0;return e})("area base br col command embed hr img input keygen link meta param source track wbr".split(" ")),k=b("style script xmp iframe noembed noframes plaintext noscript".split(" ")),O=function(t,e){"template"===t.localName&&(t=t.content);for(var r,n="",i=e?e(t):f.get.call(t),a=0,o=i.length;a<o&&(r=i[a]);a++){t:{var s=r,l=t,u=e;switch(s.nodeType){case Node.ELEMENT_NODE:for(var d=s.localName,c="<"+d,h=s.attributes,p=0;l=h[p];p++)c+=" "+l.name+'="'+l.value.replace(C,L)+'"';c+=">",s=D[d]?c:c+O(s,u)+"</"+d+">";break t;case Node.TEXT_NODE:s=s.data,s=l&&k[l.localName]?s:s.replace(R,L);break t;case Node.COMMENT_NODE:s="\x3c!--"+s.data+"--\x3e";break t;default:throw window.console.error(s),Error("not implemented")}}n+=s}return n}}if(r||m){t.b=function(t,e){var r=a.call(t,!1);return this.U&&this.U(r),e&&(u.call(r.content,a.call(t.content,!0)),N(r.content,t.content)),r};var N=function(r,n){if(n.querySelectorAll&&0!==(n=e(n,"template")).length)for(var i,a,o=0,s=(r=e(r,"template")).length;o<s;o++)a=n[o],i=r[o],t&&t.U&&t.U(a),d.call(i.parentNode,x.call(a,!0),i)},x=Node.prototype.cloneNode=function(e){if(!i&&n&&this instanceof DocumentFragment){if(!e)return this.ownerDocument.createDocumentFragment();var r=I.call(this.ownerDocument,this,!0)}else r=this.nodeType===Node.ELEMENT_NODE&&"template"===this.localName&&this.namespaceURI==document.documentElement.namespaceURI?t.b(this,e):a.call(this,e);return e&&N(r,this),r},I=Document.prototype.importNode=function(r,n){if(n=n||!1,"template"===r.localName)return t.b(r,n);var i=s.call(this,r,n);if(n){N(i,r),r=e(i,'script:not([type]),script[type="application/javascript"],script[type="text/javascript"]');for(var a,l=0;l<r.length;l++){a=r[l],(n=o.call(document,"script")).textContent=a.textContent;for(var u,c=a.attributes,h=0;h<c.length;h++)n.setAttribute((u=c[h]).name,u.value);d.call(a.parentNode,n,a)}}return i}}r&&(window.HTMLTemplateElement=t)}();var w=setTimeout;function A(){}function C(t){if(!(this instanceof C))throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this.I=0,this.za=!1,this.C=void 0,this.W=[],N(t,this)}function R(t,e){for(;3===t.I;)t=t.C;0===t.I?t.W.push(e):(t.za=!0,x((function(){var r=1===t.I?e.Ya:e.Za;if(null===r)(1===t.I?L:D)(e.va,t.C);else{try{var n=r(t.C)}catch(i){return void D(e.va,i)}L(e.va,n)}})))}function L(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var r=e.then;if(e instanceof C)return t.I=3,t.C=e,void k(t);if("function"==typeof r)return void N(function(t,e){return function(){t.apply(e,arguments)}}(r,e),t)}t.I=1,t.C=e,k(t)}catch(n){D(t,n)}}function D(t,e){t.I=2,t.C=e,k(t)}function k(t){2===t.I&&0===t.W.length&&x((function(){t.za||"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t.C)}));for(var e=0,r=t.W.length;e<r;e++)R(t,t.W[e]);t.W=null}function O(t,e,r){this.Ya="function"==typeof t?t:null,this.Za="function"==typeof e?e:null,this.va=r}function N(t,e){var r=!1;try{t((function(t){r||(r=!0,L(e,t))}),(function(t){r||(r=!0,D(e,t))}))}catch(n){r||(r=!0,D(e,n))}}C.prototype.catch=function(t){return this.then(null,t)},C.prototype.then=function(t,e){var r=new this.constructor(A);return R(this,new O(t,e,r)),r},C.prototype.finally=function(t){var e=this.constructor;return this.then((function(r){return e.resolve(t()).then((function(){return r}))}),(function(r){return e.resolve(t()).then((function(){return e.reject(r)}))}))};var x="function"==typeof setImmediate&&function(t){setImmediate(t)}||function(t){w(t,0)};if(!window.Promise){window.Promise=C,C.prototype.then=C.prototype.then,C.all=function(t){return new C((function(e,r){function n(t,o){try{if(o&&("object"==typeof o||"function"==typeof o)){var s=o.then;if("function"==typeof s)return void s.call(o,(function(e){n(t,e)}),r)}i[t]=o,0==--a&&e(i)}catch(l){r(l)}}if(!t||void 0===t.length)throw new TypeError("Promise.all accepts an array");var i=Array.prototype.slice.call(t);if(0===i.length)return e([]);for(var a=i.length,o=0;o<i.length;o++)n(o,i[o])}))},C.race=function(t){return new C((function(e,r){for(var n=0,i=t.length;n<i;n++)t[n].then(e,r)}))},C.resolve=function(t){return t&&"object"==typeof t&&t.constructor===C?t:new C((function(e){e(t)}))},C.reject=function(t){return new C((function(e,r){r(t)}))};var I=document.createTextNode(""),P=[];new MutationObserver((function(){for(var t=P.length,e=0;e<t;e++)P[e]();P.splice(0,t)})).observe(I,{characterData:!0}),x=function(t){P.push(t),I.textContent=0<I.textContent.length?"":"a"}}!function(t,e){if(!(e in t)){var r=typeof global==typeof r?window:global,n=0,i=""+Math.random(),a="__symbol@@"+i,o=t.getOwnPropertyNames,s=t.getOwnPropertyDescriptor,l=t.create,u=t.keys,d=t.freeze||t,c=t.defineProperty,h=t.defineProperties,f=s(t,"getOwnPropertyNames"),p=t.prototype,v=p.hasOwnProperty,g=p.propertyIsEnumerable,m=p.toString,y=function(t,e,r){v.call(t,a)||c(t,a,{enumerable:!1,configurable:!1,writable:!1,value:{}}),t[a]["@@"+e]=r},_=function(t,e){var r=l(t);return o(e).forEach((function(t){S.call(e,t)&&D(r,t,e[t])})),r},b=function(){},E=function(t){return t!=a&&!v.call(C,t)},T=function(t){return t!=a&&v.call(C,t)},S=function(t){var e=""+t;return T(e)?v.call(this,e)&&this[a]["@@"+e]:g.call(this,t)},w=function(e){return c(p,e,{enumerable:!1,configurable:!0,get:b,set:function(t){O(this,e,{enumerable:!1,configurable:!0,writable:!0,value:t}),y(this,e,!0)}}),d(C[e]=c(t(e),"constructor",R))},A=function(t){if(this&&this!==r)throw new TypeError("Symbol is not a constructor");return w("__symbol:".concat(t||"",i,++n))},C=l(null),R={value:A},L=function(t){return C[t]},D=function(t,e,r){var n=""+e;if(T(n)){if(e=O,r.enumerable){var i=l(r);i.enumerable=!1}else i=r;e(t,n,i),y(t,n,!!r.enumerable)}else c(t,e,r);return t},k=function(t){return o(t).filter(T).map(L)};f.value=D,c(t,"defineProperty",f),f.value=k,c(t,e,f),f.value=function(t){return o(t).filter(E)},c(t,"getOwnPropertyNames",f),f.value=function(t,e){var r=k(e);return r.length?u(e).concat(r).forEach((function(r){S.call(e,r)&&D(t,r,e[r])})):h(t,e),t},c(t,"defineProperties",f),f.value=S,c(p,"propertyIsEnumerable",f),f.value=A,c(r,"Symbol",f),f.value=function(t){return(t="__symbol:".concat("__symbol:",t,i))in p?C[t]:w(t)},c(A,"for",f),f.value=function(t){if(E(t))throw new TypeError(t+" is not a symbol");return v.call(C,t)?t.slice(20,-i.length):void 0},c(A,"keyFor",f),f.value=function(t,e){var r=s(t,e);return r&&T(e)&&(r.enumerable=S.call(t,e)),r},c(t,"getOwnPropertyDescriptor",f),f.value=function(t,e){return 1===arguments.length?l(t):_(t,e)},c(t,"create",f),f.value=function(){var t=m.call(this);return"[object String]"===t&&T(this)?"[object Symbol]":t},c(p,"toString",f);try{var O=l(c({},"__symbol:",{get:function(){return c(this,"__symbol:",{value:!1})["__symbol:"]}}))["__symbol:"]||c}catch(N){O=function(t,e,r){var n=s(p,e);delete p[e],c(t,e,r),c(p,e,n)}}}}(Object,"getOwnPropertySymbols"),function(t){var e,r=t.defineProperty,n=t.prototype,i=n.toString;"iterator match replace search split hasInstance isConcatSpreadable unscopables species toPrimitive toStringTag".split(" ").forEach((function(a){if(!(a in Symbol))switch(r(Symbol,a,{value:Symbol(a)}),a){case"toStringTag":(e=t.getOwnPropertyDescriptor(n,"toString")).value=function(){var t=i.call(this),e=this[Symbol.toStringTag];return void 0===e?t:"[object "+e+"]"},r(n,"toString",e)}}))}(Object,Symbol),function(t,e,r){function n(){return this}e[t]||(e[t]=function(){var e=0,r=this,i={next:function(){var t=r.length<=e;return t?{done:t}:{done:t,value:r[e++]}}};return i[t]=n,i}),r[t]||(r[t]=function(){var e=String.fromCodePoint,r=this,i=0,a=r.length,o={next:function(){var t=a<=i,n=t?"":e(r.codePointAt(i));return i+=n.length,t?{done:t}:{done:t,value:n}}};return o[t]=n,o})}(Symbol.iterator,Array.prototype,String.prototype);var M=Object.prototype.toString;Object.prototype.toString=function(){return void 0===this?"[object Undefined]":null===this?"[object Null]":M.call(this)},Object.keys=function(t){return Object.getOwnPropertyNames(t).filter((function(e){return(e=Object.getOwnPropertyDescriptor(t,e))&&e.enumerable}))};var F=window.Symbol.iterator;String.prototype[F]&&String.prototype.codePointAt||(String.prototype[F]=function t(){var e,r=this;return S(t,(function(t){if(1==t.a&&(e=0),3!=t.a)return e<r.length?t=y(t,r[e]):(t.a=0,t=void 0),t;e++,t.a=2}))}),Set.prototype[F]||(Set.prototype[F]=function t(){var e,r,n=this;return S(t,(function(t){if(1==t.a&&(e=[],n.forEach((function(t){e.push(t)})),r=0),3!=t.a)return r<e.length?t=y(t,e[r]):(t.a=0,t=void 0),t;r++,t.a=2}))}),Map.prototype[F]||(Map.prototype[F]=function t(){var e,r,n=this;return S(t,(function(t){if(1==t.a&&(e=[],n.forEach((function(t,r){e.push([r,t])})),r=0),3!=t.a)return r<e.length?t=y(t,e[r]):(t.a=0,t=void 0),t;r++,t.a=2}))}),window.WebComponents=window.WebComponents||{flags:{}};var U=document.querySelector('script[src*="webcomponents-bundle"]'),B=/wc-(.+)/,j={};if(!j.noOpts){if(location.search.slice(1).split("&").forEach((function(t){var e;(t=t.split("="))[0]&&(e=t[0].match(B))&&(j[e[1]]=t[1]||!0)})),U)for(var G=0,H=void 0;H=U.attributes[G];G++)"src"!==H.name&&(j[H.name]=H.value||!0);if(j.log&&j.log.split){var K=j.log.split(",");j.log={},K.forEach((function(t){j.log[t]=!0}))}else j.log={}}window.WebComponents.flags=j;var V=j.shadydom;if(V){window.ShadyDOM=window.ShadyDOM||{},window.ShadyDOM.force=V;var W=j.noPatch;window.ShadyDOM.noPatch="true"===W||W}var q=j.register||j.ce;function Y(){}function z(t){return t.__shady||(t.__shady=new Y),t.__shady}function X(t){return t&&t.__shady}q&&window.customElements&&(window.customElements.forcePolyfill=q),Y.prototype.toJSON=function(){return{}};var $=window.ShadyDOM||{};$.Ua=!(!Element.prototype.attachShadow||!Node.prototype.getRootNode);var J=Object.getOwnPropertyDescriptor(Node.prototype,"firstChild");function Z(t){return(t=X(t))&&void 0!==t.firstChild}function Q(t){return t instanceof ShadowRoot}function tt(t){return(t=(t=X(t))&&t.root)&&kr(t)}$.B=!!(J&&J.configurable&&J.get),$.sa=$.force||!$.Ua,$.D=$.noPatch||!1,$.la=$.preferPerformance,$.ua="on-demand"===$.D,$.Ia=navigator.userAgent.match("Trident");var et=Element.prototype,rt=et.matches||et.matchesSelector||et.mozMatchesSelector||et.msMatchesSelector||et.oMatchesSelector||et.webkitMatchesSelector,nt=document.createTextNode(""),it=0,at=[];function ot(t){at.push(t),nt.textContent=it++}new MutationObserver((function(){for(;at.length;)try{at.shift()()}catch(Wt){throw nt.textContent=it++,Wt}})).observe(nt,{characterData:!0});var st=!!document.contains;function lt(t,e){for(;e;){if(e==t)return!0;e=e.__shady_parentNode}return!1}function ut(t){for(var e=t.length-1;0<=e;e--){var n=t[e],i=n.getAttribute("id")||n.getAttribute("name");i&&"length"!==i&&isNaN(i)&&(t[i]=n)}return t.item=function(e){return t[e]},t.namedItem=function(e){if("length"!==e&&isNaN(e)&&t[e])return t[e];for(var n=r(t),i=n.next();!i.done;i=n.next())if(((i=i.value).getAttribute("id")||i.getAttribute("name"))==e)return i;return null},t}function dt(t){var e=[];for(t=t.__shady_native_firstChild;t;t=t.__shady_native_nextSibling)e.push(t);return e}function ct(t){var e=[];for(t=t.__shady_firstChild;t;t=t.__shady_nextSibling)e.push(t);return e}function ht(t,e,r){if(r.configurable=!0,r.value)t[e]=r.value;else try{Object.defineProperty(t,e,r)}catch(n){}}function ft(t,e,r,n){for(var i in r=void 0===r?"":r,e)n&&0<=n.indexOf(i)||ht(t,r+i,e[i])}function pt(t,e){for(var r in e)r in t&&ht(t,r,e[r])}function vt(t){var e={};return Object.getOwnPropertyNames(t).forEach((function(r){e[r]=Object.getOwnPropertyDescriptor(t,r)})),e}function gt(t,e){for(var r,n=Object.getOwnPropertyNames(e),i=0;i<n.length;i++)t[r=n[i]]=e[r]}var mt,yt=[];function _t(t){mt||(mt=!0,ot(bt)),yt.push(t)}function bt(){mt=!1;for(var t=!!yt.length;yt.length;)yt.shift()();return t}function Et(){this.a=!1,this.addedNodes=[],this.removedNodes=[],this.ia=new Set}bt.list=yt,Et.prototype.flush=function(){if(this.a){this.a=!1;var t=this.takeRecords();t.length&&this.ia.forEach((function(e){e(t)}))}},Et.prototype.takeRecords=function(){if(this.addedNodes.length||this.removedNodes.length){var t=[{addedNodes:this.addedNodes,removedNodes:this.removedNodes}];return this.addedNodes=[],this.removedNodes=[],t}return[]};var Tt=/[&\u00A0"]/g,St=/[&\u00A0<>]/g;function wt(t){switch(t){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case" ":return"&nbsp;"}}function At(t){for(var e={},r=0;r<t.length;r++)e[t[r]]=!0;return e}var Ct=At("area base br col command embed hr img input keygen link meta param source track wbr".split(" ")),Rt=At("style script xmp iframe noembed noframes plaintext noscript".split(" "));function Lt(t,e){"template"===t.localName&&(t=t.content);for(var r="",n=e?e(t):t.childNodes,i=0,a=n.length,o=void 0;i<a&&(o=n[i]);i++){t:{var s=o,l=t,u=e;switch(s.nodeType){case Node.ELEMENT_NODE:for(var d,c="<"+(l=s.localName),h=s.attributes,f=0;d=h[f];f++)c+=" "+d.name+'="'+d.value.replace(Tt,wt)+'"';c+=">",s=Ct[l]?c:c+Lt(s,u)+"</"+l+">";break t;case Node.TEXT_NODE:s=s.data,s=l&&Rt[l.localName]?s:s.replace(St,wt);break t;case Node.COMMENT_NODE:s="\x3c!--"+s.data+"--\x3e";break t;default:throw window.console.error(s),Error("not implemented")}}r+=s}return r}var Dt=$.B,kt={querySelector:function(t){return this.__shady_native_querySelector(t)},querySelectorAll:function(t){return this.__shady_native_querySelectorAll(t)}},Ot={};function Nt(t){Ot[t]=function(e){return e["__shady_native_"+t]}}function xt(t,e){for(var r in ft(t,e,"__shady_native_"),e)Nt(r)}function It(t,e){e=void 0===e?[]:e;for(var r=0;r<e.length;r++){var n=e[r],i=Object.getOwnPropertyDescriptor(t,n);i&&(Object.defineProperty(t,"__shady_native_"+n,i),i.value?kt[n]||(kt[n]=i.value):Nt(n))}}var Pt=document.createTreeWalker(document,NodeFilter.SHOW_ALL,null,!1),Mt=document.createTreeWalker(document,NodeFilter.SHOW_ELEMENT,null,!1),Ft=document.implementation.createHTMLDocument("inert");function Ut(t){for(var e;e=t.__shady_native_firstChild;)t.__shady_native_removeChild(e)}var Bt=["firstElementChild","lastElementChild","children","childElementCount"],jt=["querySelector","querySelectorAll"],Gt=vt({get childNodes(){return this.__shady_childNodes},get firstChild(){return this.__shady_firstChild},get lastChild(){return this.__shady_lastChild},get childElementCount(){return this.__shady_childElementCount},get children(){return this.__shady_children},get firstElementChild(){return this.__shady_firstElementChild},get lastElementChild(){return this.__shady_lastElementChild},get shadowRoot(){return this.__shady_shadowRoot}}),Ht=vt({get textContent(){return this.__shady_textContent},set textContent(t){this.__shady_textContent=t},get innerHTML(){return this.__shady_innerHTML},set innerHTML(t){return this.__shady_innerHTML=t}}),Kt=vt({get parentElement(){return this.__shady_parentElement},get parentNode(){return this.__shady_parentNode},get nextSibling(){return this.__shady_nextSibling},get previousSibling(){return this.__shady_previousSibling},get nextElementSibling(){return this.__shady_nextElementSibling},get previousElementSibling(){return this.__shady_previousElementSibling},get className(){return this.__shady_className},set className(t){return this.__shady_className=t}});function Vt(t){for(var e in t){var r=t[e];r&&(r.enumerable=!1)}}Vt(Gt),Vt(Ht),Vt(Kt);var Wt,qt=$.B||!0===$.D,Yt=qt?function(){}:function(t){var e=z(t);e.Ka||(e.Ka=!0,pt(t,Kt))},zt=qt?function(){}:function(t){var e=z(t);e.Ja||(e.Ja=!0,pt(t,Gt),window.customElements&&window.customElements.polyfillWrapFlushCallback&&!$.D||pt(t,Ht))},Xt="__eventWrappers"+Date.now(),$t=(Wt=Object.getOwnPropertyDescriptor(Event.prototype,"composed"))?function(t){return Wt.get.call(t)}:null,Jt=function(){function t(){}var e=!1,r={get capture(){return e=!0,!1}};return window.addEventListener("test",t,r),window.removeEventListener("test",t,r),e}();function Zt(t){if(t&&"object"==typeof t)var e=!!t.capture,r=!!t.once,n=!!t.passive,i=t.O;else e=!!t,n=r=!1;return{Ga:i,capture:e,once:r,passive:n,Fa:Jt?t:e}}var Qt={blur:!0,focus:!0,focusin:!0,focusout:!0,click:!0,dblclick:!0,mousedown:!0,mouseenter:!0,mouseleave:!0,mousemove:!0,mouseout:!0,mouseover:!0,mouseup:!0,wheel:!0,beforeinput:!0,input:!0,keydown:!0,keyup:!0,compositionstart:!0,compositionupdate:!0,compositionend:!0,touchstart:!0,touchend:!0,touchmove:!0,touchcancel:!0,pointerover:!0,pointerenter:!0,pointerdown:!0,pointermove:!0,pointerup:!0,pointercancel:!0,pointerout:!0,pointerleave:!0,gotpointercapture:!0,lostpointercapture:!0,dragstart:!0,drag:!0,dragenter:!0,dragleave:!0,dragover:!0,drop:!0,dragend:!0,DOMActivate:!0,DOMFocusIn:!0,DOMFocusOut:!0,keypress:!0},te={DOMAttrModified:!0,DOMAttributeNameChanged:!0,DOMCharacterDataModified:!0,DOMElementNameChanged:!0,DOMNodeInserted:!0,DOMNodeInsertedIntoDocument:!0,DOMNodeRemoved:!0,DOMNodeRemovedFromDocument:!0,DOMSubtreeModified:!0};function ee(t){return t instanceof Node?t.__shady_getRootNode():t}function re(t,e){var r=[],n=t;for(t=ee(t);n;)r.push(n),n=n.__shady_assignedSlot?n.__shady_assignedSlot:n.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&n.host&&(e||n!==t)?n.host:n.__shady_parentNode;return r[r.length-1]===document&&r.push(window),r}function ne(t,e){if(!Q)return t;t=re(t,!0);for(var r,n,i=0,a=void 0,o=void 0;i<e.length;i++)if((n=ee(r=e[i]))!==a&&(o=t.indexOf(n),a=n),!Q(n)||-1<o)return r}function ie(t){function e(e,r){return(e=new t(e,r)).__composed=r&&!!r.composed,e}return e.__proto__=t,e.prototype=t.prototype,e}var ae={focus:!0,blur:!0};function oe(t){return t.__target!==t.target||t.__relatedTarget!==t.relatedTarget}function se(t,e,r){if(r=e.__handlers&&e.__handlers[t.type]&&e.__handlers[t.type][r])for(var n,i=0;(n=r[i])&&(!oe(t)||t.target!==t.relatedTarget)&&(n.call(e,t),!t.__immediatePropagationStopped);i++);}function le(t){var e,r=t.composedPath();Object.defineProperty(t,"currentTarget",{get:function(){return i},configurable:!0});for(var n=r.length-1;0<=n;n--){var i=r[n];if(se(t,i,"capture"),t.ma)return}for(Object.defineProperty(t,"eventPhase",{get:function(){return Event.AT_TARGET}}),n=0;n<r.length;n++){var a=X(i=r[n]);if(a=a&&a.root,(0===n||a&&a===e)&&(se(t,i,"bubble"),i!==window&&(e=i.__shady_getRootNode()),t.ma))break}}function ue(t,e,r,n,i,a){for(var o=0;o<t.length;o++){var s=t[o];if(e===s.node&&r===s.type&&n===s.capture&&i===s.once&&a===s.passive)return o}return-1}function de(t){return bt(),this.__shady_native_dispatchEvent(t)}function ce(t,e,r){var n=Zt(r),i=n.capture,a=n.once,o=n.passive,s=n.Ga;if(n=n.Fa,e){var l=typeof e;if(("function"===l||"object"===l)&&("object"!==l||e.handleEvent&&"function"==typeof e.handleEvent)){if(te[t])return this.__shady_native_addEventListener(t,e,n);var u=s||this;if(s=e[Xt]){if(-1<ue(s,u,t,i,a,o))return}else e[Xt]=[];s=function(n){if(a&&this.__shady_removeEventListener(t,e,r),n.__target||pe(n),u!==this){var i=Object.getOwnPropertyDescriptor(n,"currentTarget");Object.defineProperty(n,"currentTarget",{get:function(){return u},configurable:!0})}if(n.__previousCurrentTarget=n.currentTarget,(!Q(u)&&"slot"!==u.localName||-1!=n.composedPath().indexOf(u))&&(n.composed||-1<n.composedPath().indexOf(u)))if(oe(n)&&n.target===n.relatedTarget)n.eventPhase===Event.BUBBLING_PHASE&&n.stopImmediatePropagation();else if(n.eventPhase===Event.CAPTURING_PHASE||n.bubbles||n.target===u||u instanceof Window){var o="function"===l?e.call(u,n):e.handleEvent&&e.handleEvent(n);return u!==this&&(i?(Object.defineProperty(n,"currentTarget",i),i=null):delete n.currentTarget),o}},e[Xt].push({node:u,type:t,capture:i,once:a,passive:o,lb:s}),ae[t]?(this.__handlers=this.__handlers||{},this.__handlers[t]=this.__handlers[t]||{capture:[],bubble:[]},this.__handlers[t][i?"capture":"bubble"].push(s)):this.__shady_native_addEventListener(t,s,n)}}}function he(t,e,r){if(e){var n=Zt(r);r=n.capture;var i=n.once,a=n.passive,o=n.Ga;if(n=n.Fa,te[t])return this.__shady_native_removeEventListener(t,e,n);var s=o||this;o=void 0;var l=null;try{l=e[Xt]}catch(u){}l&&-1<(i=ue(l,s,t,r,i,a))&&(o=l.splice(i,1)[0].lb,l.length||(e[Xt]=void 0)),this.__shady_native_removeEventListener(t,o||e,n),o&&ae[t]&&this.__handlers&&this.__handlers[t]&&-1<(e=(t=this.__handlers[t][r?"capture":"bubble"]).indexOf(o))&&t.splice(e,1)}}var fe=vt({get composed(){return void 0===this.__composed&&($t?this.__composed="focusin"===this.type||"focusout"===this.type||$t(this):!1!==this.isTrusted&&(this.__composed=Qt[this.type])),this.__composed||!1},composedPath:function(){return this.__composedPath||(this.__composedPath=re(this.__target,this.composed)),this.__composedPath},get target(){return ne(this.currentTarget||this.__previousCurrentTarget,this.composedPath())},get relatedTarget(){return this.__relatedTarget?(this.__relatedTargetComposedPath||(this.__relatedTargetComposedPath=re(this.__relatedTarget,!0)),ne(this.currentTarget||this.__previousCurrentTarget,this.__relatedTargetComposedPath)):null},stopPropagation:function(){Event.prototype.stopPropagation.call(this),this.ma=!0},stopImmediatePropagation:function(){Event.prototype.stopImmediatePropagation.call(this),this.ma=this.__immediatePropagationStopped=!0}});function pe(t){if(t.__target=t.target,t.__relatedTarget=t.relatedTarget,$.B){var e=Object.getPrototypeOf(t);if(!e.hasOwnProperty("__shady_patchedProto")){var r=Object.create(e);r.__shady_sourceProto=e,ft(r,fe),e.__shady_patchedProto=r}t.__proto__=e.__shady_patchedProto}else ft(t,fe)}var ve=ie(Event),ge=ie(CustomEvent),me=ie(MouseEvent),ye=Object.getOwnPropertyNames(Element.prototype).filter((function(t){return"on"===t.substring(0,2)})),_e=Object.getOwnPropertyNames(HTMLElement.prototype).filter((function(t){return"on"===t.substring(0,2)}));function be(t){return{set:function(e){var r=z(this),n=t.substring(2);r.N||(r.N={}),r.N[t]&&this.removeEventListener(n,r.N[t]),this.__shady_addEventListener(n,e),r.N[t]=e},get:function(){var e=X(this);return e&&e.N&&e.N[t]},configurable:!0}}function Ee(t,e){return{index:t,aa:[],ha:e}}function Te(t,e,r,n){var i=0,a=0,o=0,s=0,l=Math.min(e-i,n-a);if(0==i&&0==a)t:{for(o=0;o<l;o++)if(t[o]!==r[o])break t;o=l}if(e==t.length&&n==r.length){s=t.length;for(var u=r.length,d=0;d<l-o&&Se(t[--s],r[--u]);)d++;s=d}if(a+=o,n-=s,0==(e-=s)-(i+=o)&&0==n-a)return[];if(i==e){for(e=Ee(i,0);a<n;)e.aa.push(r[a++]);return[e]}if(a==n)return[Ee(i,e-i)];for(n=n-(o=a)+1,s=e-(l=i)+1,e=Array(n),u=0;u<n;u++)e[u]=Array(s),e[u][0]=u;for(u=0;u<s;u++)e[0][u]=u;for(u=1;u<n;u++)for(d=1;d<s;d++)if(t[l+d-1]===r[o+u-1])e[u][d]=e[u-1][d-1];else{var c=e[u-1][d]+1,h=e[u][d-1]+1;e[u][d]=c<h?c:h}for(n=e[l=e.length-1][o=e[0].length-1],t=[];0<l||0<o;)0==l?(t.push(2),o--):0==o?(t.push(3),l--):(s=e[l-1][o-1],(c=(u=e[l-1][o])<(d=e[l][o-1])?u<s?u:s:d<s?d:s)==s?(s==n?t.push(0):(t.push(1),n=s),l--,o--):c==u?(t.push(3),l--,n=u):(t.push(2),o--,n=d));for(t.reverse(),e=void 0,l=[],o=0;o<t.length;o++)switch(t[o]){case 0:e&&(l.push(e),e=void 0),i++,a++;break;case 1:e||(e=Ee(i,0)),e.ha++,i++,e.aa.push(r[a]),a++;break;case 2:e||(e=Ee(i,0)),e.ha++,i++;break;case 3:e||(e=Ee(i,0)),e.aa.push(r[a]),a++}return e&&l.push(e),l}function Se(t,e){return t===e}var we=vt({dispatchEvent:de,addEventListener:ce,removeEventListener:he}),Ae=null;function Ce(){return Ae||(Ae=window.ShadyCSS&&window.ShadyCSS.ScopingShim),Ae||null}function Re(t,e,r){var n=Ce();return!(!n||"class"!==e||(n.setElementClass(t,r),0))}function Le(t,e){var r=Ce();r&&r.unscopeNode(t,e)}function De(t){if(t.nodeType!==Node.ELEMENT_NODE)return"";var e=Ce();return e?e.currentScopeForNode(t):""}function ke(t,e){if(t)for(t.nodeType===Node.ELEMENT_NODE&&e(t),t=t.__shady_firstChild;t;t=t.__shady_nextSibling)t.nodeType===Node.ELEMENT_NODE&&ke(t,e)}var Oe=window.document,Ne=$.la,xe=Object.getOwnPropertyDescriptor(Node.prototype,"isConnected"),Ie=xe&&xe.get;function Pe(t){for(var e;e=t.__shady_firstChild;)t.__shady_removeChild(e)}function Me(t,e,r){if(t=(t=X(t))&&t.Z){if(e)if(e.nodeType===Node.DOCUMENT_FRAGMENT_NODE)for(var n=0,i=e.childNodes.length;n<i;n++)t.addedNodes.push(e.childNodes[n]);else t.addedNodes.push(e);r&&t.removedNodes.push(r),function(t){t.a||(t.a=!0,ot((function(){t.flush()})))}(t)}}var Fe=vt({get parentNode(){var t=X(this);return void 0!==(t=t&&t.parentNode)?t:this.__shady_native_parentNode},get firstChild(){var t=X(this);return void 0!==(t=t&&t.firstChild)?t:this.__shady_native_firstChild},get lastChild(){var t=X(this);return void 0!==(t=t&&t.lastChild)?t:this.__shady_native_lastChild},get nextSibling(){var t=X(this);return void 0!==(t=t&&t.nextSibling)?t:this.__shady_native_nextSibling},get previousSibling(){var t=X(this);return void 0!==(t=t&&t.previousSibling)?t:this.__shady_native_previousSibling},get childNodes(){if(Z(this)){var t=X(this);if(!t.childNodes){t.childNodes=[];for(var e=this.__shady_firstChild;e;e=e.__shady_nextSibling)t.childNodes.push(e)}var r=t.childNodes}else r=this.__shady_native_childNodes;return r.item=function(t){return r[t]},r},get parentElement(){var t=X(this);return(t=t&&t.parentNode)&&t.nodeType!==Node.ELEMENT_NODE&&(t=null),void 0!==t?t:this.__shady_native_parentElement},get isConnected(){if(Ie&&Ie.call(this))return!0;if(this.nodeType==Node.DOCUMENT_FRAGMENT_NODE)return!1;var t=this.ownerDocument;if(st){if(t.__shady_native_contains(this))return!0}else if(t.documentElement&&t.documentElement.__shady_native_contains(this))return!0;for(t=this;t&&!(t instanceof Document);)t=t.__shady_parentNode||(Q(t)?t.host:void 0);return!!(t&&t instanceof Document)},get textContent(){if(Z(this)){for(var t=[],e=this.__shady_firstChild;e;e=e.__shady_nextSibling)e.nodeType!==Node.COMMENT_NODE&&t.push(e.__shady_textContent);return t.join("")}return this.__shady_native_textContent},set textContent(t){switch(null==t&&(t=""),this.nodeType){case Node.ELEMENT_NODE:case Node.DOCUMENT_FRAGMENT_NODE:if(!Z(this)&&$.B){var e=this.__shady_firstChild;(e!=this.__shady_lastChild||e&&e.nodeType!=Node.TEXT_NODE)&&Pe(this),this.__shady_native_textContent=t}else Pe(this),(0<t.length||this.nodeType===Node.ELEMENT_NODE)&&this.__shady_insertBefore(document.createTextNode(t));break;default:this.nodeValue=t}},insertBefore:function(t,e){if(this.ownerDocument!==Oe&&t.ownerDocument!==Oe)return this.__shady_native_insertBefore(t,e),t;if(t===this)throw Error("Failed to execute 'appendChild' on 'Node': The new child element contains the parent.");if(e){var i=X(e);if(void 0!==(i=i&&i.parentNode)&&i!==this||void 0===i&&e.__shady_native_parentNode!==this)throw Error("Failed to execute 'insertBefore' on 'Node': The node before which the new node is to be inserted is not a child of this node.")}if(e===t)return t;Me(this,t);var a=[],o=(i=Ir(this))?i.host.localName:De(this),s=t.__shady_parentNode;if(s){var l=De(t),u=!!i||!Ir(t)||Ne&&void 0!==this.__noInsertionPoint;s.__shady_removeChild(t,u)}s=!0;var d=(!Ne||void 0===t.__noInsertionPoint&&void 0===this.__noInsertionPoint)&&!function t(e,r){var n=Ce();if(!n)return!0;if(e.nodeType===Node.DOCUMENT_FRAGMENT_NODE){for(n=!0,e=e.__shady_firstChild;e;e=e.__shady_nextSibling)n=n&&t(e,r);return n}return e.nodeType!==Node.ELEMENT_NODE||n.currentScopeForNode(e)===r}(t,o),c=i&&!t.__noInsertionPoint&&(!Ne||t.nodeType===Node.DOCUMENT_FRAGMENT_NODE);return(c||d)&&(d&&(l=l||De(t)),ke(t,(function(t){if(c&&"slot"===t.localName&&a.push(t),d){var e=l;Ce()&&(e&&Le(t,e),(e=Ce())&&e.scopeNode(t,o))}}))),a.length&&(Cr(i),i.c.push.apply(i.c,a instanceof Array?a:n(r(a))),Er(i)),Z(this)&&(function(t,e,r){dr(e,2);var n=z(e);if(void 0!==n.firstChild&&(n.childNodes=null),t.nodeType===Node.DOCUMENT_FRAGMENT_NODE)for(t=t.__shady_native_firstChild;t;t=t.__shady_native_nextSibling)cr(t,e,n,r);else cr(t,e,n,r)}(t,this,e),(u=X(this)).root?(s=!1,tt(this)&&Er(u.root)):i&&"slot"===this.localName&&(s=!1,Er(i))),s?(i=Q(this)?this.host:this,e?(e=function t(e){var r=e;if(e&&"slot"===e.localName){var n=X(e);(n=n&&n.V)&&(r=n.length?n[0]:t(e.__shady_nextSibling))}return r}(e),i.__shady_native_insertBefore(t,e)):i.__shady_native_appendChild(t)):t.ownerDocument!==this.ownerDocument&&this.ownerDocument.adoptNode(t),t},appendChild:function(t){if(this!=t||!Q(t))return this.__shady_insertBefore(t)},removeChild:function(t,e){if(e=void 0!==e&&e,this.ownerDocument!==Oe)return this.__shady_native_removeChild(t);if(t.__shady_parentNode!==this)throw Error("The node to be removed is not a child of this node: "+t);Me(this,null,t);var r=Ir(t),n=r&&function(t,e){if(t.a){Rr(t);var r,n=t.b;for(r in n)for(var i=n[r],a=0;a<i.length;a++){var o=i[a];if(lt(e,o)){i.splice(a,1);var s=t.a.indexOf(o);if(0<=s&&(t.a.splice(s,1),(s=X(o.__shady_parentNode))&&s.ca&&s.ca--),a--,s=(o=X(o)).V)for(var l=0;l<s.length;l++){var u=s[l],d=u.__shady_native_parentNode;d&&d.__shady_native_removeChild(u)}o.V=[],o.assignedNodes=[],s=!0}}return s}}(r,t),i=X(this);if(Z(this)&&(function(t,e){var r=z(t);t===(e=z(e)).firstChild&&(e.firstChild=r.nextSibling),t===e.lastChild&&(e.lastChild=r.previousSibling);var n=r.nextSibling;(t=r.previousSibling)&&(z(t).nextSibling=n),n&&(z(n).previousSibling=t),r.parentNode=r.previousSibling=r.nextSibling=void 0,void 0!==e.childNodes&&(e.childNodes=null)}(t,this),tt(this))){Er(i.root);var a=!0}if(Ce()&&!e&&r&&t.nodeType!==Node.TEXT_NODE){var o=De(t);ke(t,(function(t){Le(t,o)}))}return function t(e){var r=X(e);if(r&&void 0!==r.ka)for(r=e.__shady_firstChild;r;r=r.__shady_nextSibling)t(r);(e=X(e))&&(e.ka=void 0)}(t),r&&((e="slot"===this.localName)&&(a=!0),(n||e)&&Er(r)),a||(a=Q(this)?this.host:this,(!i.root&&"slot"!==t.localName||a===t.__shady_native_parentNode)&&a.__shady_native_removeChild(t)),t},replaceChild:function(t,e){return this.__shady_insertBefore(t,e),this.__shady_removeChild(e),t},cloneNode:function(t){if("template"==this.localName)return this.__shady_native_cloneNode(t);var e=this.__shady_native_cloneNode(!1);if(t&&e.nodeType!==Node.ATTRIBUTE_NODE){t=this.__shady_firstChild;for(var r;t;t=t.__shady_nextSibling)r=t.__shady_cloneNode(!0),e.__shady_appendChild(r)}return e},getRootNode:function(t){if(this&&this.nodeType){var e=z(this),r=e.ka;return void 0===r&&(Q(this)?e.ka=r=this:(r=(r=this.__shady_parentNode)?r.__shady_getRootNode(t):this,document.documentElement.__shady_native_contains(this)&&(e.ka=r))),r}},contains:function(t){return lt(this,t)}}),Ue=vt({get assignedSlot(){var t=this.__shady_parentNode;return(t=t&&t.__shady_shadowRoot)&&Tr(t),(t=X(this))&&t.assignedSlot||null}});function Be(t,e,r){var n=[];return function t(e,r,n,i){for(e=e.__shady_firstChild;e;e=e.__shady_nextSibling){var a;if(a=e.nodeType===Node.ELEMENT_NODE){var o=r,s=n,l=i,u=o(a=e);u&&l.push(a),s&&s(u)?a=u:(t(a,o,s,l),a=void 0)}if(a)break}}(t,e,r,n),n}var je=vt({get firstElementChild(){var t=X(this);if(t&&void 0!==t.firstChild){for(t=this.__shady_firstChild;t&&t.nodeType!==Node.ELEMENT_NODE;)t=t.__shady_nextSibling;return t}return this.__shady_native_firstElementChild},get lastElementChild(){var t=X(this);if(t&&void 0!==t.lastChild){for(t=this.__shady_lastChild;t&&t.nodeType!==Node.ELEMENT_NODE;)t=t.__shady_previousSibling;return t}return this.__shady_native_lastElementChild},get children(){return Z(this)?ut(Array.prototype.filter.call(ct(this),(function(t){return t.nodeType===Node.ELEMENT_NODE}))):this.__shady_native_children},get childElementCount(){var t=this.__shady_children;return t?t.length:0}}),Ge=vt({querySelector:function(t){return Be(this,(function(e){return rt.call(e,t)}),(function(t){return!!t}))[0]||null},querySelectorAll:function(t,e){if(e){e=Array.prototype.slice.call(this.__shady_native_querySelectorAll(t));var r=this.__shady_getRootNode();return ut(e.filter((function(t){return t.__shady_getRootNode()==r})))}return ut(Be(this,(function(e){return rt.call(e,t)})))}}),He=$.la&&!$.D?gt({},je):je;gt(je,Ge);var Ke=window.document;function Ve(t,e){if("slot"===e)tt(t=t.__shady_parentNode)&&Er(X(t).root);else if("slot"===t.localName&&"name"===e&&(e=Ir(t))){if(e.a){Rr(e);var r=t.La,n=Lr(t);if(n!==r){var i=(r=e.b[r]).indexOf(t);0<=i&&r.splice(i,1),(r=e.b[n]||(e.b[n]=[])).push(t),1<r.length&&(e.b[n]=Dr(r))}}Er(e)}}var We=vt({get previousElementSibling(){var t=X(this);if(t&&void 0!==t.previousSibling){for(t=this.__shady_previousSibling;t&&t.nodeType!==Node.ELEMENT_NODE;)t=t.__shady_previousSibling;return t}return this.__shady_native_previousElementSibling},get nextElementSibling(){var t=X(this);if(t&&void 0!==t.nextSibling){for(t=this.__shady_nextSibling;t&&t.nodeType!==Node.ELEMENT_NODE;)t=t.__shady_nextSibling;return t}return this.__shady_native_nextElementSibling},get slot(){return this.getAttribute("slot")},set slot(t){this.__shady_setAttribute("slot",t)},get className(){return this.getAttribute("class")||""},set className(t){this.__shady_setAttribute("class",t)},setAttribute:function(t,e){this.ownerDocument!==Ke?this.__shady_native_setAttribute(t,e):Re(this,t,e)||(this.__shady_native_setAttribute(t,e),Ve(this,t))},removeAttribute:function(t){this.ownerDocument!==Ke?this.__shady_native_removeAttribute(t):Re(this,t,"")?""===this.getAttribute(t)&&this.__shady_native_removeAttribute(t):(this.__shady_native_removeAttribute(t),Ve(this,t))}});$.la||ye.forEach((function(t){We[t]=be(t)}));var qe=vt({attachShadow:function(t){if(!this)throw Error("Must provide a host.");if(!t)throw Error("Not enough arguments.");if(t.shadyUpgradeFragment&&!$.Ia){var e=t.shadyUpgradeFragment;if(e.__proto__=ShadowRoot.prototype,br(e,this,t),hr(e,e),t=e.__noInsertionPoint?null:e.querySelectorAll("slot"),e.__noInsertionPoint=void 0,t&&t.length){var i=e;Cr(i),i.c.push.apply(i.c,t instanceof Array?t:n(r(t))),Er(e)}e.host.__shady_native_appendChild(e)}else e=new _r(gr,this,t);return this.__CE_shadowRoot=e},get shadowRoot(){var t=X(this);return t&&t.bb||null}});gt(We,qe);var Ye=document.implementation.createHTMLDocument("inert"),ze=vt({get innerHTML(){return Z(this)?Lt("template"===this.localName?this.content:this,ct):this.__shady_native_innerHTML},set innerHTML(t){if("template"===this.localName)this.__shady_native_innerHTML=t;else{Pe(this);var e=this.localName||"div";for(e=this.namespaceURI&&this.namespaceURI!==Ye.namespaceURI?Ye.createElementNS(this.namespaceURI,e):Ye.createElement(e),$.B?e.__shady_native_innerHTML=t:e.innerHTML=t;t=e.__shady_firstChild;)this.__shady_insertBefore(t)}}}),Xe=vt({blur:function(){var t=X(this);(t=(t=t&&t.root)&&t.activeElement)?t.__shady_blur():this.__shady_native_blur()}});$.la||_e.forEach((function(t){Xe[t]=be(t)}));var $e=vt({assignedNodes:function(t){if("slot"===this.localName){var e=this.__shady_getRootNode();return e&&Q(e)&&Tr(e),(e=X(this))&&(t&&t.flatten?e.V:e.assignedNodes)||[]}},addEventListener:function(t,e,r){if("slot"!==this.localName||"slotchange"===t)ce.call(this,t,e,r);else{"object"!=typeof r&&(r={capture:!!r});var n=this.__shady_parentNode;if(!n)throw Error("ShadyDOM cannot attach event to slot unless it has a `parentNode`");r.O=this,n.__shady_addEventListener(t,e,r)}},removeEventListener:function(t,e,r){if("slot"!==this.localName||"slotchange"===t)he.call(this,t,e,r);else{"object"!=typeof r&&(r={capture:!!r});var n=this.__shady_parentNode;if(!n)throw Error("ShadyDOM cannot attach event to slot unless it has a `parentNode`");r.O=this,n.__shady_removeEventListener(t,e,r)}}}),Je=vt({getElementById:function(t){return""===t?null:Be(this,(function(e){return e.id==t}),(function(t){return!!t}))[0]||null}}),Ze=vt({get activeElement(){var t=$.B?document.__shady_native_activeElement:document.activeElement;if(!t||!t.nodeType)return null;var e=!!Q(this);if(!(this===document||e&&this.host!==t&&this.host.__shady_native_contains(t)))return null;for(e=Ir(t);e&&e!==this;)e=Ir(t=e.host);return this===document?e?null:t:e===this?t:null}}),Qe=window.document,tr=vt({importNode:function(t,e){if(t.ownerDocument!==Qe||"template"===t.localName)return this.__shady_native_importNode(t,e);var r=this.__shady_native_importNode(t,!1);if(e)for(t=t.__shady_firstChild;t;t=t.__shady_nextSibling)e=this.__shady_importNode(t,!0),r.__shady_appendChild(e);return r}}),er=vt({dispatchEvent:de,addEventListener:ce.bind(window),removeEventListener:he.bind(window)}),rr={};Object.getOwnPropertyDescriptor(HTMLElement.prototype,"parentElement")&&(rr.parentElement=Fe.parentElement),Object.getOwnPropertyDescriptor(HTMLElement.prototype,"contains")&&(rr.contains=Fe.contains),Object.getOwnPropertyDescriptor(HTMLElement.prototype,"children")&&(rr.children=je.children),Object.getOwnPropertyDescriptor(HTMLElement.prototype,"innerHTML")&&(rr.innerHTML=ze.innerHTML),Object.getOwnPropertyDescriptor(HTMLElement.prototype,"className")&&(rr.className=We.className);var nr={EventTarget:[we],Node:[Fe,window.EventTarget?null:we],Text:[Ue],Comment:[Ue],CDATASection:[Ue],ProcessingInstruction:[Ue],Element:[We,je,Ue,!$.B||"innerHTML"in Element.prototype?ze:null,window.HTMLSlotElement?null:$e],HTMLElement:[Xe,rr],HTMLSlotElement:[$e],DocumentFragment:[He,Je],Document:[tr,He,Je,Ze],Window:[er]},ir=$.B?null:["innerHTML","textContent"];function ar(t,e,r,n){e.forEach((function(e){return t&&e&&ft(t,e,r,n)}))}function or(t){var e,r=t?null:ir;for(e in nr)ar(window[e]&&window[e].prototype,nr[e],t,r)}function sr(t){return t.__shady_protoIsPatched=!0,ar(t,nr.EventTarget),ar(t,nr.Node),ar(t,nr.Element),ar(t,nr.HTMLElement),ar(t,nr.HTMLSlotElement),t}["Text","Comment","CDATASection","ProcessingInstruction"].forEach((function(t){var e=window[t],r=Object.create(e.prototype);r.__shady_protoIsPatched=!0,ar(r,nr.EventTarget),ar(r,nr.Node),nr[t]&&ar(r,nr[t]),e.prototype.__shady_patchedProto=r}));var lr=$.ua,ur=$.B;function dr(t,e){if(lr&&!t.__shady_protoIsPatched&&!Q(t)){var r=Object.getPrototypeOf(t),n=r.hasOwnProperty("__shady_patchedProto")&&r.__shady_patchedProto;n||(sr(n=Object.create(r)),r.__shady_patchedProto=n),Object.setPrototypeOf(t,n)}ur||(1===e?Yt(t):2===e&&zt(t))}function cr(t,e,r,n){dr(t,1),n=n||null;var i=z(t),a=n?z(n):null;i.previousSibling=n?a.previousSibling:e.__shady_lastChild,(a=X(i.previousSibling))&&(a.nextSibling=t),(a=X(i.nextSibling=n))&&(a.previousSibling=t),i.parentNode=e,n?n===r.firstChild&&(r.firstChild=t):(r.lastChild=t,r.firstChild||(r.firstChild=t)),r.childNodes=null}function hr(t,e){var r=z(t);if(e||void 0===r.firstChild){r.childNodes=null;var n=r.firstChild=t.__shady_native_firstChild;for(r.lastChild=t.__shady_native_lastChild,dr(t,2),r=n,n=void 0;r;r=r.__shady_native_nextSibling){var i=z(r);i.parentNode=e||t,i.nextSibling=r.__shady_native_nextSibling,i.previousSibling=n||null,n=r,dr(r,1)}}}var fr=vt({addEventListener:function(t,e,r){"object"!=typeof r&&(r={capture:!!r}),r.O=r.O||this,this.host.__shady_addEventListener(t,e,r)},removeEventListener:function(t,e,r){"object"!=typeof r&&(r={capture:!!r}),r.O=r.O||this,this.host.__shady_removeEventListener(t,e,r)}});function pr(t,e){ft(t,fr,e),ft(t,Ze,e),ft(t,ze,e),ft(t,je,e),$.D&&!e?(ft(t,Fe,e),ft(t,Je,e)):$.B||(ft(t,Kt),ft(t,Gt),ft(t,Ht))}var vr,gr={},mr=$.deferConnectionCallbacks&&"loading"===document.readyState;function yr(t){var e=[];do{e.unshift(t)}while(t=t.__shady_parentNode);return e}function _r(t,e,r){if(t!==gr)throw new TypeError("Illegal constructor");this.a=null,br(this,e,r)}function br(t,e,r){if(t.host=e,t.mode=r&&r.mode,hr(t.host),(e=z(t.host)).root=t,e.bb="closed"!==t.mode?t:null,(e=z(t)).firstChild=e.lastChild=e.parentNode=e.nextSibling=e.previousSibling=null,$.preferPerformance)for(;e=t.host.__shady_native_firstChild;)t.host.__shady_native_removeChild(e);else Er(t)}function Er(t){t.T||(t.T=!0,_t((function(){return Tr(t)})))}function Tr(t){var e;if(e=t.T){for(var r;t;)t.T&&(r=t),Q(t=(e=t).host.__shady_getRootNode())&&(e=X(e.host))&&0<e.ca||(t=void 0);e=r}(r=e)&&r._renderSelf()}function Sr(t,e,r){var n=z(e),i=n.oa;n.oa=null,r||(r=(t=t.b[e.__shady_slot||"__catchall"])&&t[0]),r?(z(r).assignedNodes.push(e),n.assignedSlot=r):n.assignedSlot=void 0,i!==n.assignedSlot&&n.assignedSlot&&(z(n.assignedSlot).ra=!0)}function wr(t,e,r){for(var n=0,i=void 0;n<r.length&&(i=r[n]);n++)if("slot"==i.localName){var a=X(i).assignedNodes;a&&a.length&&wr(t,e,a)}else e.push(r[n])}function Ar(t,e){e.__shady_native_dispatchEvent(new Event("slotchange")),(e=X(e)).assignedSlot&&Ar(t,e.assignedSlot)}function Cr(t){t.c=t.c||[],t.a=t.a||[],t.b=t.b||{}}function Rr(t){if(t.c&&t.c.length){for(var e,r=t.c,n=0;n<r.length;n++){var i=r[n];hr(i);var a=i.__shady_parentNode;hr(a),(a=X(a)).ca=(a.ca||0)+1,a=Lr(i),t.b[a]?((e=e||{})[a]=!0,t.b[a].push(i)):t.b[a]=[i],t.a.push(i)}if(e)for(var o in e)t.b[o]=Dr(t.b[o]);t.c=[]}}function Lr(t){var e=t.name||t.getAttribute("name")||"__catchall";return t.La=e}function Dr(t){return t.sort((function(t,e){t=yr(t);for(var r=yr(e),n=0;n<t.length;n++){var i=r[n];if((e=t[n])!==i)return(t=ct(e.__shady_parentNode)).indexOf(e)-t.indexOf(i)}}))}function kr(t){return Rr(t),!(!t.a||!t.a.length)}if(_r.prototype._renderSelf=function(){var t=mr;if(mr=!0,this.T=!1,this.a){Rr(this);for(var e,r=0;r<this.a.length;r++){var n=X(e=this.a[r]),i=n.assignedNodes;if(n.assignedNodes=[],n.V=[],n.Ba=i)for(n=0;n<i.length;n++){var a=X(i[n]);a.oa=a.assignedSlot,a.assignedSlot===e&&(a.assignedSlot=null)}}for(r=this.host.__shady_firstChild;r;r=r.__shady_nextSibling)Sr(this,r);for(r=0;r<this.a.length;r++){if(!(i=X(e=this.a[r])).assignedNodes.length)for(n=e.__shady_firstChild;n;n=n.__shady_nextSibling)Sr(this,n,e);if((n=(n=X(e.__shady_parentNode))&&n.root)&&(kr(n)||n.T)&&n._renderSelf(),wr(this,i.V,i.assignedNodes),n=i.Ba){for(a=0;a<n.length;a++)X(n[a]).oa=null;i.Ba=null,n.length>i.assignedNodes.length&&(i.ra=!0)}i.ra&&(i.ra=!1,Ar(this,e))}for(e=this.a,r=[],i=0;i<e.length;i++)(a=X(n=e[i].__shady_parentNode))&&a.root||!(0>r.indexOf(n))||r.push(n);for(e=0;e<r.length;e++){for(i=(a=r[e])===this?this.host:a,n=[],a=a.__shady_firstChild;a;a=a.__shady_nextSibling)if("slot"==a.localName)for(var o=X(a).V,s=0;s<o.length;s++)n.push(o[s]);else n.push(a);a=dt(i),o=Te(n,n.length,a,a.length);for(var l=s=0,u=void 0;s<o.length&&(u=o[s]);s++){for(var d=0,c=void 0;d<u.aa.length&&(c=u.aa[d]);d++)c.__shady_native_parentNode===i&&i.__shady_native_removeChild(c),a.splice(u.index+l,1);l-=u.ha}for(l=0,u=void 0;l<o.length&&(u=o[l]);l++)for(s=a[u.index],d=u.index;d<u.index+u.ha;d++)i.__shady_native_insertBefore(c=n[d],s),a.splice(d,0,c)}}if(!$.preferPerformance&&!this.Aa)for(r=this.host.__shady_firstChild;r;r=r.__shady_nextSibling)e=X(r),r.__shady_native_parentNode!==this.host||"slot"!==r.localName&&e.assignedSlot||this.host.__shady_native_removeChild(r);this.Aa=!0,mr=t,vr&&vr()},function(t){t.__proto__=DocumentFragment.prototype,pr(t,"__shady_"),pr(t),Object.defineProperties(t,{nodeType:{value:Node.DOCUMENT_FRAGMENT_NODE,configurable:!0},nodeName:{value:"#document-fragment",configurable:!0},nodeValue:{value:null,configurable:!0}}),["localName","namespaceURI","prefix"].forEach((function(e){Object.defineProperty(t,e,{value:void 0,configurable:!0})})),["ownerDocument","baseURI","isConnected"].forEach((function(e){Object.defineProperty(t,e,{get:function(){return this.host[e]},configurable:!0})}))}(_r.prototype),window.customElements&&window.customElements.define&&$.sa&&!$.preferPerformance){var Or=new Map;vr=function(){var t=[];Or.forEach((function(e,r){t.push([r,e])})),Or.clear();for(var e=0;e<t.length;e++){var r=t[e][0];t[e][1]?r.__shadydom_connectedCallback():r.__shadydom_disconnectedCallback()}},mr&&document.addEventListener("readystatechange",(function(){mr=!1,vr()}),{once:!0});var Nr=window.customElements.define,xr=function(t,e){var r=e.prototype.connectedCallback,n=e.prototype.disconnectedCallback;Nr.call(window.customElements,t,function(t,e,r){var n=0,i="__isConnected"+n++;return(e||r)&&(t.prototype.connectedCallback=t.prototype.__shadydom_connectedCallback=function(){mr?Or.set(this,!0):this[i]||(this[i]=!0,e&&e.call(this))},t.prototype.disconnectedCallback=t.prototype.__shadydom_disconnectedCallback=function(){mr?this.isConnected||Or.set(this,!1):this[i]&&(this[i]=!1,r&&r.call(this))}),t}(e,r,n)),e.prototype.connectedCallback=r,e.prototype.disconnectedCallback=n};window.customElements.define=xr,Object.defineProperty(window.CustomElementRegistry.prototype,"define",{value:xr,configurable:!0})}function Ir(t){if(Q(t=t.__shady_getRootNode()))return t}function Pr(t){this.node=t}function Mr(t){Object.defineProperty(Pr.prototype,t,{get:function(){return this.node["__shady_"+t]},set:function(e){this.node["__shady_"+t]=e},configurable:!0})}(t=Pr.prototype).addEventListener=function(t,e,r){return this.node.__shady_addEventListener(t,e,r)},t.removeEventListener=function(t,e,r){return this.node.__shady_removeEventListener(t,e,r)},t.appendChild=function(t){return this.node.__shady_appendChild(t)},t.insertBefore=function(t,e){return this.node.__shady_insertBefore(t,e)},t.removeChild=function(t){return this.node.__shady_removeChild(t)},t.replaceChild=function(t,e){return this.node.__shady_replaceChild(t,e)},t.cloneNode=function(t){return this.node.__shady_cloneNode(t)},t.getRootNode=function(t){return this.node.__shady_getRootNode(t)},t.contains=function(t){return this.node.__shady_contains(t)},t.dispatchEvent=function(t){return this.node.__shady_dispatchEvent(t)},t.setAttribute=function(t,e){this.node.__shady_setAttribute(t,e)},t.getAttribute=function(t){return this.node.__shady_native_getAttribute(t)},t.hasAttribute=function(t){return this.node.__shady_native_hasAttribute(t)},t.removeAttribute=function(t){this.node.__shady_removeAttribute(t)},t.attachShadow=function(t){return this.node.__shady_attachShadow(t)},t.focus=function(){this.node.__shady_native_focus()},t.blur=function(){this.node.__shady_blur()},t.importNode=function(t,e){if(this.node.nodeType===Node.DOCUMENT_NODE)return this.node.__shady_importNode(t,e)},t.getElementById=function(t){if(this.node.nodeType===Node.DOCUMENT_NODE)return this.node.__shady_getElementById(t)},t.querySelector=function(t){return this.node.__shady_querySelector(t)},t.querySelectorAll=function(t,e){return this.node.__shady_querySelectorAll(t,e)},t.assignedNodes=function(t){if("slot"===this.node.localName)return this.node.__shady_assignedNodes(t)},i.Object.defineProperties(Pr.prototype,{activeElement:{configurable:!0,enumerable:!0,get:function(){if(Q(this.node)||this.node.nodeType===Node.DOCUMENT_NODE)return this.node.__shady_activeElement}},_activeElement:{configurable:!0,enumerable:!0,get:function(){return this.activeElement}},host:{configurable:!0,enumerable:!0,get:function(){if(Q(this.node))return this.node.host}},parentNode:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_parentNode}},firstChild:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_firstChild}},lastChild:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_lastChild}},nextSibling:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_nextSibling}},previousSibling:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_previousSibling}},childNodes:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_childNodes}},parentElement:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_parentElement}},firstElementChild:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_firstElementChild}},lastElementChild:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_lastElementChild}},nextElementSibling:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_nextElementSibling}},previousElementSibling:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_previousElementSibling}},children:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_children}},childElementCount:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_childElementCount}},shadowRoot:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_shadowRoot}},assignedSlot:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_assignedSlot}},isConnected:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_isConnected}},innerHTML:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_innerHTML},set:function(t){this.node.__shady_innerHTML=t}},textContent:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_textContent},set:function(t){this.node.__shady_textContent=t}},slot:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_slot},set:function(t){this.node.__shady_slot=t}},className:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_className},set:function(t){return this.node.__shady_className=t}}}),ye.forEach((function(t){return Mr(t)})),_e.forEach((function(t){return Mr(t)}));var Fr=new WeakMap;function Ur(t){if(Q(t)||t instanceof Pr)return t;var e=Fr.get(t);return e||(e=new Pr(t),Fr.set(t,e)),e}if($.sa){var Br=$.B?function(t){return t}:function(t){return zt(t),Yt(t),t};window.ShadyDOM={inUse:$.sa,patch:Br,isShadyRoot:Q,enqueue:_t,flush:bt,flushInitial:function(t){!t.Aa&&t.T&&Tr(t)},settings:$,filterMutations:function(t,e){var r=e.getRootNode();return t.map((function(t){var e=r===t.target.getRootNode();if(e&&t.addedNodes){if((e=[].slice.call(t.addedNodes).filter((function(t){return r===t.getRootNode()}))).length)return t=Object.create(t),Object.defineProperty(t,"addedNodes",{value:e,configurable:!0}),t}else if(e)return t})).filter((function(t){return t}))},observeChildren:function(t,e){var r=z(t);r.Z||(r.Z=new Et),r.Z.ia.add(e);var n=r.Z;return{Ma:e,S:n,Na:t,takeRecords:function(){return n.takeRecords()}}},unobserveChildren:function(t){var e=t&&t.S;e&&(e.ia.delete(t.Ma),e.ia.size||(z(t.Na).Z=null))},deferConnectionCallbacks:$.deferConnectionCallbacks,preferPerformance:$.preferPerformance,handlesDynamicScoping:!0,wrap:$.D?Ur:Br,wrapIfNeeded:!0===$.D?Ur:function(t){return t},Wrapper:Pr,composedPath:function(t){return t.__composedPath||(t.__composedPath=re(t.target,!0)),t.__composedPath},noPatch:$.D,patchOnDemand:$.ua,nativeMethods:kt,nativeTree:Ot,patchElementProto:sr},function(){var t=["dispatchEvent","addEventListener","removeEventListener"];window.EventTarget?It(window.EventTarget.prototype,t):(It(Node.prototype,t),It(Window.prototype,t)),Dt?It(Node.prototype,"parentNode firstChild lastChild previousSibling nextSibling childNodes parentElement textContent".split(" ")):xt(Node.prototype,{parentNode:{get:function(){return Pt.currentNode=this,Pt.parentNode()}},firstChild:{get:function(){return Pt.currentNode=this,Pt.firstChild()}},lastChild:{get:function(){return Pt.currentNode=this,Pt.lastChild()}},previousSibling:{get:function(){return Pt.currentNode=this,Pt.previousSibling()}},nextSibling:{get:function(){return Pt.currentNode=this,Pt.nextSibling()}},childNodes:{get:function(){var t=[];Pt.currentNode=this;for(var e=Pt.firstChild();e;)t.push(e),e=Pt.nextSibling();return t}},parentElement:{get:function(){return Mt.currentNode=this,Mt.parentNode()}},textContent:{get:function(){switch(this.nodeType){case Node.ELEMENT_NODE:case Node.DOCUMENT_FRAGMENT_NODE:for(var t,e=document.createTreeWalker(this,NodeFilter.SHOW_TEXT,null,!1),r="";t=e.nextNode();)r+=t.nodeValue;return r;default:return this.nodeValue}},set:function(t){switch(null==t&&(t=""),this.nodeType){case Node.ELEMENT_NODE:case Node.DOCUMENT_FRAGMENT_NODE:Ut(this),(0<t.length||this.nodeType===Node.ELEMENT_NODE)&&this.__shady_native_insertBefore(document.createTextNode(t),void 0);break;default:this.nodeValue=t}}}}),It(Node.prototype,"appendChild insertBefore removeChild replaceChild cloneNode contains".split(" ")),It(HTMLElement.prototype,["parentElement","contains"]),t={firstElementChild:{get:function(){return Mt.currentNode=this,Mt.firstChild()}},lastElementChild:{get:function(){return Mt.currentNode=this,Mt.lastChild()}},children:{get:function(){var t=[];Mt.currentNode=this;for(var e=Mt.firstChild();e;)t.push(e),e=Mt.nextSibling();return ut(t)}},childElementCount:{get:function(){return this.children?this.children.length:0}}},Dt?(It(Element.prototype,Bt),It(Element.prototype,["previousElementSibling","nextElementSibling","innerHTML","className"]),It(HTMLElement.prototype,["children","innerHTML","className"])):(xt(Element.prototype,t),xt(Element.prototype,{previousElementSibling:{get:function(){return Mt.currentNode=this,Mt.previousSibling()}},nextElementSibling:{get:function(){return Mt.currentNode=this,Mt.nextSibling()}},innerHTML:{get:function(){return Lt(this,dt)},set:function(t){var e="template"===this.localName?this.content:this;Ut(e);var r=this.localName||"div";for((r=this.namespaceURI&&this.namespaceURI!==Ft.namespaceURI?Ft.createElementNS(this.namespaceURI,r):Ft.createElement(r)).innerHTML=t,t="template"===this.localName?r.content:r;r=t.__shady_native_firstChild;)e.__shady_native_insertBefore(r,void 0)}},className:{get:function(){return this.getAttribute("class")||""},set:function(t){this.setAttribute("class",t)}}})),It(Element.prototype,"setAttribute getAttribute hasAttribute removeAttribute focus blur".split(" ")),It(Element.prototype,jt),It(HTMLElement.prototype,["focus","blur"]),window.HTMLTemplateElement&&It(window.HTMLTemplateElement.prototype,["innerHTML"]),Dt?It(DocumentFragment.prototype,Bt):xt(DocumentFragment.prototype,t),It(DocumentFragment.prototype,jt),Dt?(It(Document.prototype,Bt),It(Document.prototype,["activeElement"])):xt(Document.prototype,t),It(Document.prototype,["importNode","getElementById"]),It(Document.prototype,jt)}(),or("__shady_"),Object.defineProperty(document,"_activeElement",Ze.activeElement),ft(Window.prototype,er,"__shady_"),$.D?$.ua&&ft(Element.prototype,qe):(or(),function(){if(!$t&&Object.getOwnPropertyDescriptor(Event.prototype,"isTrusted")){var t=function(){var t=new MouseEvent("click",{bubbles:!0,cancelable:!0,composed:!0});this.__shady_dispatchEvent(t)};Element.prototype.click?Element.prototype.click=t:HTMLElement.prototype.click&&(HTMLElement.prototype.click=t)}}()),function(){for(var t in ae)window.__shady_native_addEventListener(t,(function(t){t.__target||(pe(t),le(t))}),!0)}(),window.Event=ve,window.CustomEvent=ge,window.MouseEvent=me,window.ShadowRoot=_r}var jr=window.Document.prototype.createElement,Gr=window.Document.prototype.createElementNS,Hr=window.Document.prototype.importNode,Kr=window.Document.prototype.prepend,Vr=window.Document.prototype.append,Wr=window.DocumentFragment.prototype.prepend,qr=window.DocumentFragment.prototype.append,Yr=window.Node.prototype.cloneNode,zr=window.Node.prototype.appendChild,Xr=window.Node.prototype.insertBefore,$r=window.Node.prototype.removeChild,Jr=window.Node.prototype.replaceChild,Zr=Object.getOwnPropertyDescriptor(window.Node.prototype,"textContent"),Qr=window.Element.prototype.attachShadow,tn=Object.getOwnPropertyDescriptor(window.Element.prototype,"innerHTML"),en=window.Element.prototype.getAttribute,rn=window.Element.prototype.setAttribute,nn=window.Element.prototype.removeAttribute,an=window.Element.prototype.getAttributeNS,on=window.Element.prototype.setAttributeNS,sn=window.Element.prototype.removeAttributeNS,ln=window.Element.prototype.insertAdjacentElement,un=window.Element.prototype.insertAdjacentHTML,dn=window.Element.prototype.prepend,cn=window.Element.prototype.append,hn=window.Element.prototype.before,fn=window.Element.prototype.after,pn=window.Element.prototype.replaceWith,vn=window.Element.prototype.remove,gn=window.HTMLElement,mn=Object.getOwnPropertyDescriptor(window.HTMLElement.prototype,"innerHTML"),yn=window.HTMLElement.prototype.insertAdjacentElement,_n=window.HTMLElement.prototype.insertAdjacentHTML,bn=new Set;function En(t){var e=bn.has(t);return t=/^[a-z][.0-9_a-z]*-[-.0-9_a-z]*$/.test(t),!e&&t}"annotation-xml color-profile font-face font-face-src font-face-uri font-face-format font-face-name missing-glyph".split(" ").forEach((function(t){return bn.add(t)}));var Tn=document.contains?document.contains.bind(document):document.documentElement.contains.bind(document.documentElement);function Sn(t){var e=t.isConnected;if(void 0!==e)return e;if(Tn(t))return!0;for(;t&&!(t.__CE_isImportDocument||t instanceof Document);)t=t.parentNode||(window.ShadowRoot&&t instanceof ShadowRoot?t.host:void 0);return!(!t||!(t.__CE_isImportDocument||t instanceof Document))}function wn(t){var e=t.children;if(e)return Array.prototype.slice.call(e);for(e=[],t=t.firstChild;t;t=t.nextSibling)t.nodeType===Node.ELEMENT_NODE&&e.push(t);return e}function An(t,e){for(;e&&e!==t&&!e.nextSibling;)e=e.parentNode;return e&&e!==t?e.nextSibling:null}function Cn(){var t=!(null==qn||!qn.noDocumentConstructionObserver),e=!(null==qn||!qn.shadyDomFastWalk);this.X=[],this.a=[],this.R=!1,this.shadyDomFastWalk=e,this.jb=!t}function Rn(t,e,r,n){var i=window.ShadyDom;if(t.shadyDomFastWalk&&i&&i.inUse){if(e.nodeType===Node.ELEMENT_NODE&&r(e),e.querySelectorAll)for(t=i.nativeMethods.querySelectorAll.call(e,"*"),e=0;e<t.length;e++)r(t[e])}else!function t(e,r,n){for(var i=e;i;){if(i.nodeType===Node.ELEMENT_NODE){var a=i;r(a);var o=a.localName;if("link"===o&&"import"===a.getAttribute("rel")){if(i=a.import,void 0===n&&(n=new Set),i instanceof Node&&!n.has(i))for(n.add(i),i=i.firstChild;i;i=i.nextSibling)t(i,r,n);i=An(e,a);continue}if("template"===o){i=An(e,a);continue}if(a=a.__CE_shadowRoot)for(a=a.firstChild;a;a=a.nextSibling)t(a,r,n)}i=i.firstChild?i.firstChild:An(e,i)}}(e,r,n)}function Ln(t,e){t.R&&Rn(t,e,(function(e){return Dn(t,e)}))}function Dn(t,e){if(t.R&&!e.__CE_patched){e.__CE_patched=!0;for(var r=0;r<t.X.length;r++)t.X[r](e);for(r=0;r<t.a.length;r++)t.a[r](e)}}function kn(t,e){var r=[];for(Rn(t,e,(function(t){return r.push(t)})),e=0;e<r.length;e++){var n=r[e];1===n.__CE_state?t.connectedCallback(n):xn(t,n)}}function On(t,e){var r=[];for(Rn(t,e,(function(t){return r.push(t)})),e=0;e<r.length;e++){var n=r[e];1===n.__CE_state&&t.disconnectedCallback(n)}}function Nn(t,e,r){var n=(r=void 0===r?{}:r).kb,i=r.upgrade||function(e){return xn(t,e)},a=[];for(Rn(t,e,(function(e){if(t.R&&Dn(t,e),"link"===e.localName&&"import"===e.getAttribute("rel")){var r=e.import;r instanceof Node&&(r.__CE_isImportDocument=!0,r.__CE_registry=document.__CE_registry),r&&"complete"===r.readyState?r.__CE_documentLoadHandled=!0:e.addEventListener("load",(function(){var r=e.import;if(!r.__CE_documentLoadHandled){r.__CE_documentLoadHandled=!0;var a=new Set;n&&(n.forEach((function(t){return a.add(t)})),a.delete(r)),Nn(t,r,{kb:a,upgrade:i})}}))}else a.push(e)}),n),e=0;e<a.length;e++)i(a[e])}function xn(t,e){try{var r=e.ownerDocument,n=r.__CE_registry,i=n&&(r.defaultView||r.__CE_isImportDocument)?Kn(n,e.localName):void 0;if(i&&void 0===e.__CE_state){i.constructionStack.push(e);try{try{if(new i.constructorFunction!==e)throw Error("The custom element constructor did not produce the element being upgraded.")}finally{i.constructionStack.pop()}}catch(l){throw e.__CE_state=2,l}if(e.__CE_state=1,e.__CE_definition=i,i.attributeChangedCallback&&e.hasAttributes()){var a=i.observedAttributes;for(i=0;i<a.length;i++){var o=a[i],s=e.getAttribute(o);null!==s&&t.attributeChangedCallback(e,o,null,s,null)}}Sn(e)&&t.connectedCallback(e)}}catch(l){Pn(l)}}function In(t,e,r,n){var i=e.__CE_registry;if(i&&(null===n||"http://www.w3.org/1999/xhtml"===n)&&(i=Kn(i,r)))try{var a=new i.constructorFunction;if(void 0===a.__CE_state||void 0===a.__CE_definition)throw Error("Failed to construct '"+r+"': The returned value was not constructed with the HTMLElement constructor.");if("http://www.w3.org/1999/xhtml"!==a.namespaceURI)throw Error("Failed to construct '"+r+"': The constructed element's namespace must be the HTML namespace.");if(a.hasAttributes())throw Error("Failed to construct '"+r+"': The constructed element must not have any attributes.");if(null!==a.firstChild)throw Error("Failed to construct '"+r+"': The constructed element must not have any children.");if(null!==a.parentNode)throw Error("Failed to construct '"+r+"': The constructed element must not have a parent node.");if(a.ownerDocument!==e)throw Error("Failed to construct '"+r+"': The constructed element's owner document is incorrect.");if(a.localName!==r)throw Error("Failed to construct '"+r+"': The constructed element's local name is incorrect.");return a}catch(o){return Pn(o),e=null===n?jr.call(e,r):Gr.call(e,n,r),Object.setPrototypeOf(e,HTMLUnknownElement.prototype),e.__CE_state=2,e.__CE_definition=void 0,Dn(t,e),e}return Dn(t,e=null===n?jr.call(e,r):Gr.call(e,n,r)),e}function Pn(t){var e=t.message,r=t.sourceURL||t.fileName||"",n=t.line||t.lineNumber||0,i=void 0;void 0===ErrorEvent.prototype.initErrorEvent?i=new ErrorEvent("error",{cancelable:!0,message:e,filename:r,lineno:n,colno:t.column||t.columnNumber||0,error:t}):((i=document.createEvent("ErrorEvent")).initErrorEvent("error",!1,!0,e,r,n),i.preventDefault=function(){Object.defineProperty(this,"defaultPrevented",{configurable:!0,get:function(){return!0}})}),void 0===i.error&&Object.defineProperty(i,"error",{configurable:!0,enumerable:!0,get:function(){return t}}),window.dispatchEvent(i),i.defaultPrevented||console.error(t)}function Mn(){var t=this;this.C=void 0,this.Ca=new Promise((function(e){t.a=e}))}function Fn(t){var e=document;this.S=void 0,this.M=t,this.a=e,Nn(this.M,this.a),"loading"===this.a.readyState&&(this.S=new MutationObserver(this.b.bind(this)),this.S.observe(this.a,{childList:!0,subtree:!0}))}function Un(t){t.S&&t.S.disconnect()}function Bn(t){this.ea=new Map,this.fa=new Map,this.xa=new Map,this.na=!1,this.qa=new Map,this.da=function(t){return t()},this.P=!1,this.ga=[],this.M=t,this.ya=t.jb?new Fn(t):void 0}function jn(t,e){if(!En(e))throw new SyntaxError("The element name '"+e+"' is not valid.");if(Kn(t,e))throw Error("A custom element with name '"+e+"' has already been defined.");if(t.na)throw Error("A custom element is already being defined.")}function Gn(t,e,r){var n;t.na=!0;try{var i=r.prototype;if(!(i instanceof Object))throw new TypeError("The custom element constructor's prototype is not an object.");var a=function(t){var e=i[t];if(void 0!==e&&!(e instanceof Function))throw Error("The '"+t+"' callback must be a function.");return e},o=a("connectedCallback"),s=a("disconnectedCallback"),l=a("adoptedCallback"),u=(n=a("attributeChangedCallback"))&&r.observedAttributes||[]}catch(d){throw d}finally{t.na=!1}return t.fa.set(e,r={localName:e,constructorFunction:r,connectedCallback:o,disconnectedCallback:s,adoptedCallback:l,attributeChangedCallback:n,observedAttributes:u,constructionStack:[]}),t.xa.set(r.constructorFunction,r),r}function Hn(t){if(!1!==t.P){t.P=!1;for(var e=[],r=t.ga,n=new Map,i=0;i<r.length;i++)n.set(r[i],[]);for(Nn(t.M,document,{upgrade:function(r){if(void 0===r.__CE_state){var i=r.localName,a=n.get(i);a?a.push(r):t.fa.has(i)&&e.push(r)}}}),i=0;i<e.length;i++)xn(t.M,e[i]);for(i=0;i<r.length;i++){for(var a=r[i],o=n.get(a),s=0;s<o.length;s++)xn(t.M,o[s]);(a=t.qa.get(a))&&a.resolve(void 0)}r.length=0}}function Kn(t,e){var r=t.fa.get(e);if(r)return r;if(r=t.ea.get(e)){t.ea.delete(e);try{return Gn(t,e,r())}catch(n){Pn(n)}}}function Vn(t,e,r){function n(e){return function(r){for(var n=[],i=0;i<arguments.length;++i)n[i]=arguments[i];i=[];for(var a=[],o=0;o<n.length;o++){var s=n[o];if(s instanceof Element&&Sn(s)&&a.push(s),s instanceof DocumentFragment)for(s=s.firstChild;s;s=s.nextSibling)i.push(s);else i.push(s)}for(e.apply(this,n),n=0;n<a.length;n++)On(t,a[n]);if(Sn(this))for(n=0;n<i.length;n++)(a=i[n])instanceof Element&&kn(t,a)}}void 0!==r.prepend&&(e.prepend=n(r.prepend)),void 0!==r.append&&(e.append=n(r.append))}Cn.prototype.connectedCallback=function(t){var e=t.__CE_definition;if(e.connectedCallback)try{e.connectedCallback.call(t)}catch(r){Pn(r)}},Cn.prototype.disconnectedCallback=function(t){var e=t.__CE_definition;if(e.disconnectedCallback)try{e.disconnectedCallback.call(t)}catch(r){Pn(r)}},Cn.prototype.attributeChangedCallback=function(t,e,r,n,i){var a=t.__CE_definition;if(a.attributeChangedCallback&&-1<a.observedAttributes.indexOf(e))try{a.attributeChangedCallback.call(t,e,r,n,i)}catch(o){Pn(o)}},Mn.prototype.resolve=function(t){if(this.C)throw Error("Already resolved.");this.C=t,this.a(t)},Fn.prototype.b=function(t){var e=this.a.readyState;for("interactive"!==e&&"complete"!==e||Un(this),e=0;e<t.length;e++)for(var r=t[e].addedNodes,n=0;n<r.length;n++)Nn(this.M,r[n])},(t=Bn.prototype).$a=function(t,e){var r=this;if(!(e instanceof Function))throw new TypeError("Custom element constructor getters must be functions.");jn(this,t),this.ea.set(t,e),this.ga.push(t),this.P||(this.P=!0,this.da((function(){return Hn(r)})))},t.define=function(t,e){var r=this;if(!(e instanceof Function))throw new TypeError("Custom element constructors must be functions.");jn(this,t),Gn(this,t,e),this.ga.push(t),this.P||(this.P=!0,this.da((function(){return Hn(r)})))},t.upgrade=function(t){Nn(this.M,t)},t.get=function(t){if(t=Kn(this,t))return t.constructorFunction},t.whenDefined=function(t){if(!En(t))return Promise.reject(new SyntaxError("'"+t+"' is not a valid custom element name."));var e=this.qa.get(t);if(e)return e.Ca;e=new Mn,this.qa.set(t,e);var r=this.fa.has(t)||this.ea.has(t);return t=-1===this.ga.indexOf(t),r&&t&&e.resolve(void 0),e.Ca},t.polyfillWrapFlushCallback=function(t){this.ya&&Un(this.ya);var e=this.da;this.da=function(r){return t((function(){return e(r)}))}},window.CustomElementRegistry=Bn,Bn.prototype.define=Bn.prototype.define,Bn.prototype.upgrade=Bn.prototype.upgrade,Bn.prototype.get=Bn.prototype.get,Bn.prototype.whenDefined=Bn.prototype.whenDefined,Bn.prototype.polyfillDefineLazy=Bn.prototype.$a,Bn.prototype.polyfillWrapFlushCallback=Bn.prototype.polyfillWrapFlushCallback;var Wn={},qn=window.customElements;function Yn(){var t=new Cn;!function(t){function e(){var e=this.constructor,r=document.__CE_registry.xa.get(e);if(!r)throw Error("Failed to construct a custom element: The constructor was not registered with `customElements`.");var n=r.constructionStack;if(0===n.length)return n=jr.call(document,r.localName),Object.setPrototypeOf(n,e.prototype),n.__CE_state=1,n.__CE_definition=r,Dn(t,n),n;var i=n.length-1,a=n[i];if(a===Wn)throw Error("Failed to construct '"+r.localName+"': This element was already constructed.");return n[i]=Wn,Object.setPrototypeOf(a,e.prototype),Dn(t,a),a}e.prototype=gn.prototype,Object.defineProperty(HTMLElement.prototype,"constructor",{writable:!0,configurable:!0,enumerable:!1,value:e}),window.HTMLElement=e}(t),function(t){Document.prototype.createElement=function(e){return In(t,this,e,null)},Document.prototype.importNode=function(e,r){return e=Hr.call(this,e,!!r),this.__CE_registry?Nn(t,e):Ln(t,e),e},Document.prototype.createElementNS=function(e,r){return In(t,this,r,e)},Vn(t,Document.prototype,{prepend:Kr,append:Vr})}(t),Vn(t,DocumentFragment.prototype,{prepend:Wr,append:qr}),function(t){function e(e,r){Object.defineProperty(e,"textContent",{enumerable:r.enumerable,configurable:!0,get:r.get,set:function(e){if(this.nodeType===Node.TEXT_NODE)r.set.call(this,e);else{var n=void 0;if(this.firstChild){var i=this.childNodes,a=i.length;if(0<a&&Sn(this)){n=Array(a);for(var o=0;o<a;o++)n[o]=i[o]}}if(r.set.call(this,e),n)for(e=0;e<n.length;e++)On(t,n[e])}}})}Node.prototype.insertBefore=function(e,r){if(e instanceof DocumentFragment){var n=wn(e);if(e=Xr.call(this,e,r),Sn(this))for(r=0;r<n.length;r++)kn(t,n[r]);return e}return n=e instanceof Element&&Sn(e),r=Xr.call(this,e,r),n&&On(t,e),Sn(this)&&kn(t,e),r},Node.prototype.appendChild=function(e){if(e instanceof DocumentFragment){var r=wn(e);if(e=zr.call(this,e),Sn(this))for(var n=0;n<r.length;n++)kn(t,r[n]);return e}return r=e instanceof Element&&Sn(e),n=zr.call(this,e),r&&On(t,e),Sn(this)&&kn(t,e),n},Node.prototype.cloneNode=function(e){return e=Yr.call(this,!!e),this.ownerDocument.__CE_registry?Nn(t,e):Ln(t,e),e},Node.prototype.removeChild=function(e){var r=e instanceof Element&&Sn(e),n=$r.call(this,e);return r&&On(t,e),n},Node.prototype.replaceChild=function(e,r){if(e instanceof DocumentFragment){var n=wn(e);if(e=Jr.call(this,e,r),Sn(this))for(On(t,r),r=0;r<n.length;r++)kn(t,n[r]);return e}n=e instanceof Element&&Sn(e);var i=Jr.call(this,e,r),a=Sn(this);return a&&On(t,r),n&&On(t,e),a&&kn(t,e),i},Zr&&Zr.get?e(Node.prototype,Zr):function(t,e){t.R=!0,t.X.push(e)}(t,(function(t){e(t,{enumerable:!0,configurable:!0,get:function(){for(var t=[],e=this.firstChild;e;e=e.nextSibling)e.nodeType!==Node.COMMENT_NODE&&t.push(e.textContent);return t.join("")},set:function(t){for(;this.firstChild;)$r.call(this,this.firstChild);null!=t&&""!==t&&zr.call(this,document.createTextNode(t))}})}))}(t),function(t){function e(e,r){Object.defineProperty(e,"innerHTML",{enumerable:r.enumerable,configurable:!0,get:r.get,set:function(e){var n=this,i=void 0;if(Sn(this)&&(i=[],Rn(t,this,(function(t){t!==n&&i.push(t)}))),r.set.call(this,e),i)for(var a=0;a<i.length;a++){var o=i[a];1===o.__CE_state&&t.disconnectedCallback(o)}return this.ownerDocument.__CE_registry?Nn(t,this):Ln(t,this),e}})}function r(e,r){e.insertAdjacentElement=function(e,n){var i=Sn(n);return e=r.call(this,e,n),i&&On(t,n),Sn(e)&&kn(t,n),e}}function n(e,r){function n(e,r){for(var n=[];e!==r;e=e.nextSibling)n.push(e);for(r=0;r<n.length;r++)Nn(t,n[r])}e.insertAdjacentHTML=function(t,e){if("beforebegin"===(t=t.toLowerCase())){var i=this.previousSibling;r.call(this,t,e),n(i||this.parentNode.firstChild,this)}else if("afterbegin"===t)i=this.firstChild,r.call(this,t,e),n(this.firstChild,i);else if("beforeend"===t)i=this.lastChild,r.call(this,t,e),n(i||this.firstChild,null);else{if("afterend"!==t)throw new SyntaxError("The value provided ("+String(t)+") is not one of 'beforebegin', 'afterbegin', 'beforeend', or 'afterend'.");i=this.nextSibling,r.call(this,t,e),n(this.nextSibling,i)}}}Qr&&(Element.prototype.attachShadow=function(e){if(e=Qr.call(this,e),t.R&&!e.__CE_patched){e.__CE_patched=!0;for(var r=0;r<t.X.length;r++)t.X[r](e)}return this.__CE_shadowRoot=e}),tn&&tn.get?e(Element.prototype,tn):mn&&mn.get?e(HTMLElement.prototype,mn):function(t,e){t.R=!0,t.a.push(e)}(t,(function(t){e(t,{enumerable:!0,configurable:!0,get:function(){return Yr.call(this,!0).innerHTML},set:function(t){var e="template"===this.localName,r=e?this.content:this,n=Gr.call(document,this.namespaceURI,this.localName);for(n.innerHTML=t;0<r.childNodes.length;)$r.call(r,r.childNodes[0]);for(t=e?n.content:n;0<t.childNodes.length;)zr.call(r,t.childNodes[0])}})})),Element.prototype.setAttribute=function(e,r){if(1!==this.__CE_state)return rn.call(this,e,r);var n=en.call(this,e);rn.call(this,e,r),r=en.call(this,e),t.attributeChangedCallback(this,e,n,r,null)},Element.prototype.setAttributeNS=function(e,r,n){if(1!==this.__CE_state)return on.call(this,e,r,n);var i=an.call(this,e,r);on.call(this,e,r,n),n=an.call(this,e,r),t.attributeChangedCallback(this,r,i,n,e)},Element.prototype.removeAttribute=function(e){if(1!==this.__CE_state)return nn.call(this,e);var r=en.call(this,e);nn.call(this,e),null!==r&&t.attributeChangedCallback(this,e,r,null,null)},Element.prototype.removeAttributeNS=function(e,r){if(1!==this.__CE_state)return sn.call(this,e,r);var n=an.call(this,e,r);sn.call(this,e,r);var i=an.call(this,e,r);n!==i&&t.attributeChangedCallback(this,r,n,i,e)},yn?r(HTMLElement.prototype,yn):ln&&r(Element.prototype,ln),_n?n(HTMLElement.prototype,_n):un&&n(Element.prototype,un),Vn(t,Element.prototype,{prepend:dn,append:cn}),function(t){function e(e){return function(r){for(var n=[],i=0;i<arguments.length;++i)n[i]=arguments[i];i=[];for(var a=[],o=0;o<n.length;o++){var s=n[o];if(s instanceof Element&&Sn(s)&&a.push(s),s instanceof DocumentFragment)for(s=s.firstChild;s;s=s.nextSibling)i.push(s);else i.push(s)}for(e.apply(this,n),n=0;n<a.length;n++)On(t,a[n]);if(Sn(this))for(n=0;n<i.length;n++)(a=i[n])instanceof Element&&kn(t,a)}}var r=Element.prototype;void 0!==hn&&(r.before=e(hn)),void 0!==fn&&(r.after=e(fn)),void 0!==pn&&(r.replaceWith=function(e){for(var r=[],n=0;n<arguments.length;++n)r[n]=arguments[n];n=[];for(var i=[],a=0;a<r.length;a++){var o=r[a];if(o instanceof Element&&Sn(o)&&i.push(o),o instanceof DocumentFragment)for(o=o.firstChild;o;o=o.nextSibling)n.push(o);else n.push(o)}for(a=Sn(this),pn.apply(this,r),r=0;r<i.length;r++)On(t,i[r]);if(a)for(On(t,this),r=0;r<n.length;r++)(i=n[r])instanceof Element&&kn(t,i)}),void 0!==vn&&(r.remove=function(){var e=Sn(this);vn.call(this),e&&On(t,this)})}(t)}(t),t=new Bn(t),document.__CE_registry=t,Object.defineProperty(window,"customElements",{configurable:!0,enumerable:!0,value:t})}function zn(){this.end=this.start=0,this.rules=this.parent=this.previous=null,this.cssText=this.parsedCssText="",this.atRule=!1,this.type=0,this.parsedSelector=this.selector=this.keyframesName=""}function Xn(t){var e=t=t.replace(ri,"").replace(ni,""),r=new zn;r.start=0,r.end=e.length;for(var n=r,i=0,a=e.length;i<a;i++)if("{"===e[i]){n.rules||(n.rules=[]);var o=n,s=o.rules[o.rules.length-1]||null;(n=new zn).start=i+1,n.parent=o,n.previous=s,o.rules.push(n)}else"}"===e[i]&&(n.end=i+1,n=n.parent||r);return function t(e,r){var n=r.substring(e.start,e.end-1);if(e.parsedCssText=e.cssText=n.trim(),e.parent&&(n=(n=(n=function(t){return t.replace(/\\([0-9a-f]{1,6})\s/gi,(function(t,e){for(e=6-(t=e).length;e--;)t="0"+t;return"\\"+t}))}(n=r.substring(e.previous?e.previous.end:e.parent.start,e.start-1))).replace(ui," ")).substring(n.lastIndexOf(";")+1),n=e.parsedSelector=e.selector=n.trim(),e.atRule=0===n.indexOf("@"),e.atRule?0===n.indexOf("@media")?e.type=ti:n.match(li)&&(e.type=Qn,e.keyframesName=e.selector.split(ui).pop()):e.type=0===n.indexOf("--")?ei:Zn),n=e.rules)for(var i=0,a=n.length,o=void 0;i<a&&(o=n[i]);i++)t(o,r);return e}(r,t)}qn&&!qn.forcePolyfill&&"function"==typeof qn.define&&"function"==typeof qn.get||Yn(),window.__CE_installPolyfill=Yn;var $n,Jn,Zn=1,Qn=7,ti=4,ei=1e3,ri=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//gim,ni=/@import[^;]*;/gim,ii=/(?:^[^;\-\s}]+)?--[^;{}]*?:[^{};]*?(?:[;\n]|$)/gim,ai=/(?:^[^;\-\s}]+)?--[^;{}]*?:[^{};]*?{[^}]*?}(?:[;\n]|$)?/gim,oi=/@apply\s*\(?[^);]*\)?\s*(?:[;\n]|$)?/gim,si=/[^;:]*?:[^;]*?var\([^;]*\)(?:[;\n]|$)?/gim,li=/^@[^\s]*keyframes/,ui=/\s+/g,di=!(window.ShadyDOM&&window.ShadyDOM.inUse);function ci(t){$n=(!t||!t.shimcssproperties)&&(di||!(navigator.userAgent.match(/AppleWebKit\/601|Edge\/15/)||!window.CSS||!CSS.supports||!CSS.supports("box-shadow","0 0 0 var(--foo)")))}window.ShadyCSS&&void 0!==window.ShadyCSS.cssBuild&&(Jn=window.ShadyCSS.cssBuild);var hi=!(!window.ShadyCSS||!window.ShadyCSS.disableRuntime);window.ShadyCSS&&void 0!==window.ShadyCSS.nativeCss?$n=window.ShadyCSS.nativeCss:window.ShadyCSS?(ci(window.ShadyCSS),window.ShadyCSS=void 0):ci(window.WebComponents&&window.WebComponents.flags);var fi=$n,pi=/(?:^|[;\s{]\s*)(--[\w-]*?)\s*:\s*(?:((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};{])+)|\{([^}]*)\}(?:(?=[;\s}])|$))/gi,vi=/(?:^|\W+)@apply\s*\(?([^);\n]*)\)?/gi,gi=/(--[\w-]+)\s*([:,;)]|$)/gi,mi=/(animation\s*:)|(animation-name\s*:)/,yi=/@media\s(.*)/,_i=/\{[^}]*\}/g,bi=new Set;function Ei(t,e){return t?("string"==typeof t&&(t=Xn(t)),e&&wi(t,e),function t(e,r,n){n=void 0===n?"":n;var i="";if(e.cssText||e.rules){var a,o=e.rules;if((a=o)&&(a=!((a=o[0])&&a.selector&&0===a.selector.indexOf("--"))),a){a=0;for(var s=o.length,l=void 0;a<s&&(l=o[a]);a++)i=t(l,r,i)}else(i=(r=r?e.cssText:(r=(r=e.cssText).replace(ii,"").replace(ai,"")).replace(oi,"").replace(si,"")).trim())&&(i="  "+i+"\n")}return i&&(e.selector&&(n+=e.selector+" {\n"),n+=i,e.selector&&(n+="}\n\n")),n}(t,fi)):""}function Ti(t){return!t.__cssRules&&t.textContent&&(t.__cssRules=Xn(t.textContent)),t.__cssRules||null}function Si(t){return!!t.parent&&t.parent.type===Qn}function wi(t,e,r,n){if(t){var i=!1,a=t.type;if(n&&a===ti){var o=t.selector.match(yi);o&&(window.matchMedia(o[1]).matches||(i=!0))}if(a===Zn?e(t):r&&a===Qn?r(t):a===ei&&(i=!0),(t=t.rules)&&!i)for(i=0,a=t.length,o=void 0;i<a&&(o=t[i]);i++)wi(o,e,r,n)}}function Ai(t,e,r,n){var i=document.createElement("style");return e&&i.setAttribute("scope",e),i.textContent=t,Li(i,r,n),i}var Ci=null;function Ri(t){t=document.createComment(" Shady DOM styles for "+t+" ");var e=document.head;return e.insertBefore(t,(Ci?Ci.nextSibling:null)||e.firstChild),Ci=t}function Li(t,e,r){(e=e||document.head).insertBefore(t,r&&r.nextSibling||e.firstChild),Ci?t.compareDocumentPosition(Ci)===Node.DOCUMENT_POSITION_PRECEDING&&(Ci=t):Ci=t}function Di(t,e){for(var r=0,n=t.length;e<n;e++)if("("===t[e])r++;else if(")"===t[e]&&0==--r)return e;return-1}function ki(t,e){di?t.setAttribute("class",e):window.ShadyDOM.nativeMethods.setAttribute.call(t,"class",e)}var Oi=window.ShadyDOM&&window.ShadyDOM.wrap||function(t){return t};function Ni(t){var e=t.localName,r="";return e?-1<e.indexOf("-")||(r=e,e=t.getAttribute&&t.getAttribute("is")||""):(e=t.is,r=t.extends),{is:e,ba:r}}function xi(t){for(var e=[],r="",n=0;0<=n&&n<t.length;n++)if("("===t[n]){var i=Di(t,n);r+=t.slice(n,i+1),n=i}else","===t[n]?(e.push(r),r=""):r+=t[n];return r&&e.push(r),e}function Ii(t){if(void 0!==Jn)return Jn;if(void 0===t.__cssBuild){var e=t.getAttribute("css-build");if(e)t.__cssBuild=e;else{if(""!==(e=(e="template"===t.localName?t.content.firstChild:t.firstChild)instanceof Comment&&"css-build"===(e=e.textContent.trim().split(":"))[0]?e[1]:"")){var r="template"===t.localName?t.content.firstChild:t.firstChild;r.parentNode.removeChild(r)}t.__cssBuild=e}}return t.__cssBuild||""}function Pi(t){return!(""===(t=void 0===t?"":t)||!fi)&&(di?"shadow"===t:"shady"===t)}function Mi(){}function Fi(t,e,r){var n;if(e.nodeType===Node.ELEMENT_NODE&&r(e),n="template"===e.localName?(e.content||e._content||e).childNodes:e.children||e.childNodes)for(e=0;e<n.length;e++)Fi(t,n[e],r)}function Ui(t,e,r){if(e)if(t.classList)r?(t.classList.remove("style-scope"),t.classList.remove(e)):(t.classList.add("style-scope"),t.classList.add(e));else if(t.getAttribute){var n=t.getAttribute("class");r?n&&ki(t,e=n.replace("style-scope","").replace(e,"")):ki(t,(n?n+" ":"")+"style-scope "+e)}}function Bi(t,e,r){Fi(ea,t,(function(t){Ui(t,e,!0),Ui(t,r)}))}function ji(t,e){Fi(ea,t,(function(t){Ui(t,e||"",!0)}))}function Gi(t,e,r,n,i){var a=ea;return""===(i=void 0===i?"":i)&&(i=di||"shady"===(void 0===n?"":n)?Ei(e,r):function(t,e,r,n,i){var a=Hi(r,n);return r=r?"."+r:"",Ei(e,(function(e){e.c||(e.selector=e.w=Ki(t,e,t.b,r,a),e.c=!0),i&&i(e,r,a)}))}(a,e,(t=Ni(t)).is,t.ba,r)+"\n\n"),i.trim()}function Hi(t,e){return e?"[is="+t+"]":t}function Ki(t,e,r,n,i){var a=xi(e.selector);if(!Si(e)){e=0;for(var o=a.length,s=void 0;e<o&&(s=a[e]);e++)a[e]=r.call(t,s,n,i)}return a.filter((function(t){return!!t})).join(",")}function Vi(t){return t.replace(Yi,(function(t,e,r){return-1<r.indexOf("+")?r=r.replace(/\+/g,"___"):-1<r.indexOf("___")&&(r=r.replace(/___/g,"+")),":"+e+"("+r+")"}))}function Wi(t,e){t=t.split(/(\[.+?\])/);for(var r=[],n=0;n<t.length;n++)if(1==n%2)r.push(t[n]);else{var i=t[n];""===i&&n===t.length-1||((i=i.split(":"))[0]+=e,r.push(i.join(":")))}return r.join("")}function qi(t){":root"===t.selector&&(t.selector="html")}Mi.prototype.b=function(t,e,r){var n=!1;t=t.trim();var i=Yi.test(t);i&&(t=Vi(t=t.replace(Yi,(function(t,e,r){return":"+e+"("+r.replace(/\s/g,"")+")"}))));var a=ta.test(t);if(a){var o=function(t){for(var e,r=[];e=t.match(ta);){var n=e.index,i=Di(t,n);if(-1===i)throw Error(e.input+" selector missing ')'");e=t.slice(n,i+1),t=t.replace(e,""),r.push(e)}return{wa:t,matches:r}}(t);t=o.wa,o=o.matches}return t=(t=t.replace($i,":host $1")).replace(zi,(function(t,i,a){return n||(t=function(t,e,r,n){var i=t.indexOf("::slotted");if(0<=t.indexOf(":host")?t=function(t,e){var r=t.match(Ji);return(r=r&&r[2].trim()||"")?r[0].match(Xi)?t.replace(Ji,(function(t,r,n){return e+n})):r.split(Xi)[0]===e?r:"should_not_match":t.replace(":host",e)}(t,n):0!==i&&(t=r?Wi(t,r):t),r=!1,0<=i&&(e="",r=!0),r){var a=!0;r&&(t=t.replace(Zi,(function(t,e){return" > "+e})))}return{value:t,Qa:e,stop:a}}(a,i,e,r),n=n||t.stop,i=t.Qa,a=t.value),i+a})),a&&(t=function(t,e){var r=t.split("");return e.reduce((function(t,e,n){return t+e+r[n+1]}),r[0])}(t,o)),i&&(t=Vi(t)),t.replace(Qi,(function(t,e,r,n){return'[dir="'+r+'"] '+e+n+", "+e+'[dir="'+r+'"]'+n}))},Mi.prototype.c=function(t){return t.match(":host")?"":t.match("::slotted")?this.b(t,":not(.style-scope)"):Wi(t.trim(),":not(.style-scope)")},i.Object.defineProperties(Mi.prototype,{a:{configurable:!0,enumerable:!0,get:function(){return"style-scope"}}});var Yi=/:(nth[-\w]+)\(([^)]+)\)/,zi=/(^|[\s>+~]+)((?:\[.+?\]|[^\s>+~=[])+)/g,Xi=/[[.:#*]/,$i=/^(::slotted)/,Ji=/(:host)(?:\(((?:\([^)(]*\)|[^)(]*)+?)\))/,Zi=/(?:::slotted)(?:\(((?:\([^)(]*\)|[^)(]*)+?)\))/,Qi=/(.*):dir\((?:(ltr|rtl))\)(.*)/,ta=/:(?:matches|any|-(?:webkit|moz)-any)/,ea=new Mi;function ra(t,e,r,n,i){this.H=t||null,this.b=e||null,this.ta=r||[],this.F=null,this.cssBuild=i||"",this.ba=n||"",this.a=this.G=this.L=null}function na(t){return t?t.__styleInfo:null}function ia(t,e){return t.__styleInfo=e}function aa(t){var e=this.matches||this.matchesSelector||this.mozMatchesSelector||this.msMatchesSelector||this.oMatchesSelector||this.webkitMatchesSelector;return e&&e.call(this,t)}ra.prototype._getStyleRules=ra.prototype.c=function(){return this.H};var oa=/:host\s*>\s*/,sa=navigator.userAgent.match("Trident");function la(){}function ua(t){if(!t.v){var e={},r={};da(t,r)&&(e.K=r,t.rules=null),e.cssText=t.parsedCssText.replace(_i,"").replace(pi,""),t.v=e}}function da(t,e){var r=t.v;if(!r){r=t.parsedCssText;for(var n;t=pi.exec(r);)"inherit"===(n=(t[2]||t[3]).trim())&&"unset"===n||(e[t[1].trim()]=n),n=!0;return n}if(r.K)return Object.assign(e,r.K),!0}function ca(t,e,r){return e&&(e=0<=e.indexOf(";")?ha(t,e,r):function t(e,r){var n=e.indexOf("var(");if(-1===n)return r(e,"","","");var i=Di(e,n+3),a=e.substring(n+4,i);return n=e.substring(0,n),e=t(e.substring(i+1),r),-1===(i=a.indexOf(","))?r(n,a.trim(),"",e):r(n,a.substring(0,i).trim(),a.substring(i+1).trim(),e)}(e,(function(e,n,i,a){return n?((n=ca(t,r[n],r))&&"initial"!==n?"apply-shim-inherit"===n&&(n="inherit"):n=ca(t,r[i]||i,r)||i,e+(n||"")+a):e+a}))),e&&e.trim()||""}function ha(t,e,r){e=e.split(";");for(var n,i,a=0;a<e.length;a++)if(n=e[a]){if(vi.lastIndex=0,i=vi.exec(n))n=ca(t,r[i[1]],r);else if(-1!==(i=n.indexOf(":"))){var o=n.substring(i);o=ca(t,o=o.trim(),r)||o,n=n.substring(0,i)+o}e[a]=n&&n.lastIndexOf(";")===n.length-1?n.slice(0,-1):n||""}return e.join(";")}function fa(t){return function(e){return e.replace(t.l,t.a)}}function pa(t,e){var r=va,n=Ti(t);t.textContent=Ei(n,(function(t){var n=t.cssText=t.parsedCssText;t.v&&t.v.cssText&&(n=n.replace(ii,"").replace(ai,""),t.cssText=ha(r,n,e))}))}i.Object.defineProperties(la.prototype,{a:{configurable:!0,enumerable:!0,get:function(){return"x-scope"}}});var va=new la,ga={},ma=window.customElements;if(ma&&!di&&!hi){var ya=ma.define;ma.define=function(t,e,r){ga[t]||(ga[t]=Ri(t)),ya.call(ma,t,e,r)}}function _a(){this.cache={}}function ba(){}_a.prototype.store=function(t,e,r,n){var i=this.cache[t]||[];i.push({K:e,styleElement:r,G:n}),100<i.length&&i.shift(),this.cache[t]=i};var Ea=new RegExp(ea.a+"\\s*([^\\s]*)");function Ta(t){return(t=(t.classList&&t.classList.value?t.classList.value:t.getAttribute("class")||"").match(Ea))?t[1]:""}function Sa(t){var e=Oi(t).getRootNode();return e===t||e===t.ownerDocument?"":(t=e.host)?Ni(t).is:""}function wa(t){for(var e=0;e<t.length;e++){var r=t[e];if(r.target!==document.documentElement&&r.target!==document.head)for(var n=0;n<r.addedNodes.length;n++){var i=r.addedNodes[n];if(i.nodeType===Node.ELEMENT_NODE){var a=i.getRootNode(),o=Ta(i);if(o&&a===i.ownerDocument&&("style"!==i.localName&&"template"!==i.localName||""===Ii(i)))ji(i,o);else if(a instanceof ShadowRoot)for((a=Sa(i))!==o&&Bi(i,o,a),i=window.ShadyDOM.nativeMethods.querySelectorAll.call(i,":not(."+ea.a+")"),o=0;o<i.length;o++){var s=Sa(a=i[o]);s&&Ui(a,s)}}}}}if(!(di||window.ShadyDOM&&window.ShadyDOM.handlesDynamicScoping)){var Aa=new MutationObserver(wa),Ca=function(t){Aa.observe(t,{childList:!0,subtree:!0})};if(window.customElements&&!window.customElements.polyfillWrapFlushCallback)Ca(document);else{var Ra=function(){Ca(document.body)};window.HTMLImports?window.HTMLImports.whenReady(Ra):requestAnimationFrame((function(){if("loading"===document.readyState){var t=function(){Ra(),document.removeEventListener("readystatechange",t)};document.addEventListener("readystatechange",t)}else Ra()}))}ba=function(){wa(Aa.takeRecords())}}var La={},Da=Promise.resolve();function ka(t){(t=La[t])&&(t._applyShimCurrentVersion=t._applyShimCurrentVersion||0,t._applyShimValidatingVersion=t._applyShimValidatingVersion||0,t._applyShimNextVersion=(t._applyShimNextVersion||0)+1)}function Oa(t){return t._applyShimCurrentVersion===t._applyShimNextVersion}var Na={},xa=new _a;function Ia(){this.Y={},this.c=document.documentElement;var t=new zn;t.rules=[],this.l=ia(this.c,new ra(t)),this.J=!1,this.a=this.b=null}function Pa(t){var e=Ni(t),r=e.is;e=e.ba;var n=ga[r]||null,i=La[r];if(i)return ia(t,e=new ra(r=i._styleAst,n,i.a,e,i=Ii(i))),e}function Ma(t){if(!t.b&&window.ShadyCSS&&window.ShadyCSS.ApplyShim){t.b=window.ShadyCSS.ApplyShim,t.b.invalidCallback=ka;var e=!0}else e=!1;return function(t){!t.a&&window.ShadyCSS&&window.ShadyCSS.CustomStyleInterface&&(t.a=window.ShadyCSS.CustomStyleInterface,t.a.transformCallback=function(e){t.Ha(e)},t.a.validateCallback=function(){requestAnimationFrame((function(){(t.a.enqueued||t.J)&&t.flushCustomStyles()}))})}(t),e}function Fa(t,e,r){var n=Ni(e).is;if(r.F){var i,a=r.F;for(i in a)null===i?e.style.removeProperty(i):e.style.setProperty(i,a[i])}!(a=La[n])&&e!==t.c||a&&""!==Ii(a)||!a||!a._style||Oa(a)||((Oa(a)||a._applyShimValidatingVersion!==a._applyShimNextVersion)&&(Ma(t),t.b&&t.b.transformRules(a._styleAst,n),a._style.textContent=Gi(e,r.H),function(t){t._applyShimValidatingVersion=t._applyShimNextVersion,t._validating||(t._validating=!0,Da.then((function(){t._applyShimCurrentVersion=t._applyShimNextVersion,t._validating=!1})))}(a)),di&&(t=e.shadowRoot)&&(t=t.querySelector("style"))&&(t.textContent=Gi(e,r.H)),r.H=a._styleAst)}function Ua(t,e){return(e=Oi(e).getRootNode().host)?na(e)||Pa(e)?e:Ua(t,e):t.c}function Ba(t,e,r){var n=Ua(t,e),i=na(n),a=i.L;for(var o in n===t.c||a||(Ba(t,n,i),a=i.L),t=Object.create(a||null),n=function(t,e,r){var n={},i={};return wi(e,(function(e){!function(t,e,r,n){if(e.v||ua(e),e.v.K){var i=Ni(t);t=i.is,i=i.ba,i=t?Hi(t,i):"html";var a=e.parsedSelector,o=!!a.match(oa)||"html"===i&&-1<a.indexOf("html"),s=0===a.indexOf(":host")&&!o;"shady"===r&&(s=!(o=a===i+" > *."+i||-1!==a.indexOf("html"))&&0===a.indexOf(i)),(o||s)&&(r=i,s&&(e.w||(e.w=Ki(ea,e,ea.b,t?"."+t:"",i)),r=e.w||i),o&&"html"===i&&(r=e.w||e.J),n({wa:r,Xa:s,mb:o}))}}(t,e,r,(function(r){aa.call(t._element||t,r.wa)&&da(e,r.Xa?n:i)}))}),null,!0),{cb:i,Va:n}}(e,r.H,r.cssBuild),e=function(t,e){var r={},n=[];return wi(t,(function(t){t.v||ua(t);var i=t.w||t.parsedSelector;e&&t.v.K&&i&&aa.call(e,i)&&(da(t,r),t=t.index,i=parseInt(t/32,10),n[i]=(n[i]||0)|1<<t%32)}),null,!0),{K:r,key:n}}(i.H,e).K,Object.assign(t,n.Va,e,n.cb),e=r.F)((i=e[o])||0===i)&&(t[o]=i);for(o=va,e=Object.getOwnPropertyNames(t),i=0;i<e.length;i++)t[n=e[i]]=ca(o,t[n],t);r.L=t}(t=Ia.prototype).flush=function(){ba()},t.Ta=function(t){return Ti(t)},t.hb=function(t){return Ei(t)},t.prepareTemplate=function(t,e,r){this.prepareTemplateDom(t,e),this.prepareTemplateStyles(t,e,r)},t.prepareTemplateStyles=function(t,e,r){if(!t._prepared&&!hi){di||ga[e]||(ga[e]=Ri(e)),t._prepared=!0,t.name=e,t.extends=r,La[e]=t;var n=Ii(t),i=Pi(n);r={is:e,extends:r};for(var a=[],o=t.content.querySelectorAll("style"),s=0;s<o.length;s++){var l=o[s];if(l.hasAttribute("shady-unscoped")){if(!di){var u=l.textContent;if(!bi.has(u)){bi.add(u);var d=document.createElement("style");d.setAttribute("shady-unscoped",""),d.textContent=u,document.head.appendChild(d)}l.parentNode.removeChild(l)}}else a.push(l.textContent),l.parentNode.removeChild(l)}a=a.join("").trim()+(Na[e]||""),Ma(this),i||((o=!n)&&(o=vi.test(a)||pi.test(a),vi.lastIndex=0,pi.lastIndex=0),s=Xn(a),o&&fi&&this.b&&this.b.transformRules(s,e),t._styleAst=s),o=[],fi||(o=function(t){var e={},r=[],n=0;for(var i in wi(t,(function(t){ua(t),t.index=n++,t=t.v.cssText;for(var r;r=gi.exec(t);)":"!==r[2]&&(e[r[1]]=!0)}),(function(t){r.push(t)})),t.b=r,t=[],e)t.push(i);return t}(t._styleAst)),o.length&&!fi||(s=di?t.content:null,e=ga[e]||null,n=(n=Gi(r,t._styleAst,null,n,i?a:"")).length?Ai(n,r.is,s,e):null,t._style=n),t.a=o}},t.ab=function(t,e){Na[e]=t.join(" ")},t.prepareTemplateDom=function(t,e){if(!hi){var r=Ii(t);di||"shady"===r||t._domPrepared||(t._domPrepared=!0,function(t,e){Fi(ea,t,(function(t){Ui(t,e||"")}))}(t.content,e))}},t.flushCustomStyles=function(){if(!hi){var t=Ma(this);if(this.a){var e=this.a.processStyles();if((t||this.a.enqueued)&&!Pi(this.l.cssBuild)){if(fi){if(!this.l.cssBuild)for(t=0;t<e.length;t++){var r=this.a.getStyleForCustomStyle(e[t]);if(r&&fi&&this.b){var n=Ti(r);Ma(this),this.b.transformRules(n),r.textContent=Ei(n)}}}else{for(function(t,e){(e=e.map((function(e){return t.a.getStyleForCustomStyle(e)})).filter((function(t){return!!t}))).sort((function(t,e){return(t=e.compareDocumentPosition(t))&Node.DOCUMENT_POSITION_FOLLOWING?1:t&Node.DOCUMENT_POSITION_PRECEDING?-1:0})),t.l.H.rules=e.map((function(t){return Ti(t)}))}(this,e),Ba(this,this.c,this.l),t=0;t<e.length;t++)(r=this.a.getStyleForCustomStyle(e[t]))&&pa(r,this.l.L);this.J&&this.styleDocument()}this.a.enqueued=!1}}}},t.styleElement=function(t,e){if(hi){if(e){na(t)||ia(t,new ra(null));var r=na(t);r.F=r.F||{},Object.assign(r.F,e),Fa(this,t,r)}}else if(r=na(t)||Pa(t))if(t!==this.c&&(this.J=!0),e&&(r.F=r.F||{},Object.assign(r.F,e)),fi)Fa(this,t,r);else if(this.flush(),Ba(this,t,r),r.ta&&r.ta.length){var n;e=Ni(t).is;t:{if(n=xa.cache[e])for(var i=n.length-1;0<=i;i--){var a=n[i];e:{for(var o=r.ta,s=0;s<o.length;s++){var l=o[s];if(a.K[l]!==r.L[l]){o=!1;break e}}o=!0}if(o){n=a;break t}}n=void 0}o=n?n.styleElement:null,i=r.G,(a=n&&n.G)||(a=e+"-"+(a=this.Y[e]=(this.Y[e]||0)+1)),r.G=a,a=r.G,s=va,s=o?o.textContent||"":function(t,e,r,n){var i=Ni(e),a=Hi(i.is,i.ba),o=new RegExp("(?:^|[^.#[:])"+(e.extends?"\\"+a.slice(0,-1)+"\\]":a)+"($|[.:[\\s>+~])"),s=na(e);i=s.H,s=s.cssBuild;var l=function(t,e){t=t.b;var r={};if(!di&&t)for(var n=0,i=t[n];n<t.length;i=t[++n]){var a=i,o=e;a.l=new RegExp("\\b"+a.keyframesName+"(?!\\B|-)","g"),a.a=a.keyframesName+"-"+o,a.w=a.w||a.selector,a.selector=a.w.replace(a.keyframesName,a.a),r[i.keyframesName]=fa(i)}return r}(i,n);return Gi(e,i,(function(e){var i="";if(e.v||ua(e),e.v.cssText&&(i=ha(t,e.v.cssText,r)),e.cssText=i,!di&&!Si(e)&&e.cssText){var s=i=e.cssText;if(null==e.Da&&(e.Da=mi.test(i)),e.Da)if(null==e.ja)for(var u in e.ja=[],l)i!==(s=(s=l[u])(i))&&(i=s,e.ja.push(u));else{for(u=0;u<e.ja.length;++u)i=(s=l[e.ja[u]])(i);s=i}e.cssText=s,e.w=e.w||e.selector,i="."+n,s=0;for(var d=(u=xi(e.w)).length,c=void 0;s<d&&(c=u[s]);s++)u[s]=c.match(o)?c.replace(a,i):i+" "+c;e.selector=u.join(",")}}),s)}(s,t,r.L,a);var u=(l=na(t)).a;u&&!di&&u!==o&&(u._useCount--,0>=u._useCount&&u.parentNode&&u.parentNode.removeChild(u)),di?l.a?(l.a.textContent=s,o=l.a):s&&(o=Ai(s,a,t.shadowRoot,l.b)):o?o.parentNode||(sa&&-1<s.indexOf("@media")&&(o.textContent=s),Li(o,null,l.b)):s&&(o=Ai(s,a,null,l.b)),o&&(o._useCount=o._useCount||0,l.a!=o&&o._useCount++,l.a=o),a=o,di||(o=r.G,l=s=t.getAttribute("class")||"",i&&(l=s.replace(new RegExp("\\s*x-scope\\s*"+i+"\\s*","g")," ")),s!==(l+=(l?" ":"")+"x-scope "+o)&&ki(t,l)),n||xa.store(e,r.L,a,r.G)}},t.styleDocument=function(t){this.styleSubtree(this.c,t)},t.styleSubtree=function(t,e){var r=Oi(t),n=r.shadowRoot,i=t===this.c;if((n||i)&&this.styleElement(t,e),t=i?r:n)for(t=Array.from(t.querySelectorAll("*")).filter((function(t){return Oi(t).shadowRoot})),e=0;e<t.length;e++)this.styleSubtree(t[e])},t.Ha=function(t){var e=this,r=Ii(t);if(r!==this.l.cssBuild&&(this.l.cssBuild=r),!Pi(r)){var n=Ti(t);wi(n,(function(t){if(di)qi(t);else{var n=ea;t.selector=t.parsedSelector,qi(t),t.selector=t.w=Ki(n,t,n.c,void 0,void 0)}fi&&""===r&&(Ma(e),e.b&&e.b.transformRule(t))})),fi?t.textContent=Ei(n):this.l.H.rules.push(n)}},t.getComputedStyleValue=function(t,e){var r;return fi||(r=(na(t)||na(Ua(this,t))).L[e]),(r=r||window.getComputedStyle(t).getPropertyValue(e))?r.trim():""},t.gb=function(t,e){var r,n=Oi(t).getRootNode();if(r=e?("string"==typeof e?e:String(e)).split(/\s/):[],!(e=n.host&&n.host.localName)&&(n=t.getAttribute("class"))){n=n.split(/\s/);for(var i=0;i<n.length;i++)if(n[i]===ea.a){e=n[i+1];break}}e&&r.push(ea.a,e),fi||(e=na(t))&&e.G&&r.push(va.a,e.G),ki(t,r.join(" "))},t.Oa=function(t){return na(t)},t.fb=function(t,e){Ui(t,e)},t.ib=function(t,e){Ui(t,e,!0)},t.eb=function(t){return Sa(t)},t.Ra=function(t){return Ta(t)},Ia.prototype.flush=Ia.prototype.flush,Ia.prototype.prepareTemplate=Ia.prototype.prepareTemplate,Ia.prototype.styleElement=Ia.prototype.styleElement,Ia.prototype.styleDocument=Ia.prototype.styleDocument,Ia.prototype.styleSubtree=Ia.prototype.styleSubtree,Ia.prototype.getComputedStyleValue=Ia.prototype.getComputedStyleValue,Ia.prototype.setElementClass=Ia.prototype.gb,Ia.prototype._styleInfoForNode=Ia.prototype.Oa,Ia.prototype.transformCustomStyleForDocument=Ia.prototype.Ha,Ia.prototype.getStyleAst=Ia.prototype.Ta,Ia.prototype.styleAstToString=Ia.prototype.hb,Ia.prototype.flushCustomStyles=Ia.prototype.flushCustomStyles,Ia.prototype.scopeNode=Ia.prototype.fb,Ia.prototype.unscopeNode=Ia.prototype.ib,Ia.prototype.scopeForNode=Ia.prototype.eb,Ia.prototype.currentScopeForNode=Ia.prototype.Ra,Ia.prototype.prepareAdoptedCssText=Ia.prototype.ab,Object.defineProperties(Ia.prototype,{nativeShadow:{get:function(){return di}},nativeCss:{get:function(){return fi}}});var ja,Ga,Ha=new Ia;window.ShadyCSS&&(ja=window.ShadyCSS.ApplyShim,Ga=window.ShadyCSS.CustomStyleInterface),window.ShadyCSS={ScopingShim:Ha,prepareTemplate:function(t,e,r){Ha.flushCustomStyles(),Ha.prepareTemplate(t,e,r)},prepareTemplateDom:function(t,e){Ha.prepareTemplateDom(t,e)},prepareTemplateStyles:function(t,e,r){Ha.flushCustomStyles(),Ha.prepareTemplateStyles(t,e,r)},styleSubtree:function(t,e){Ha.flushCustomStyles(),Ha.styleSubtree(t,e)},styleElement:function(t){Ha.flushCustomStyles(),Ha.styleElement(t)},styleDocument:function(t){Ha.flushCustomStyles(),Ha.styleDocument(t)},flushCustomStyles:function(){Ha.flushCustomStyles()},getComputedStyleValue:function(t,e){return Ha.getComputedStyleValue(t,e)},nativeCss:fi,nativeShadow:di,cssBuild:Jn,disableRuntime:hi},ja&&(window.ShadyCSS.ApplyShim=ja),Ga&&(window.ShadyCSS.CustomStyleInterface=Ga),function(t){function e(t){return""==t&&(a.call(this),this.h=!0),t.toLowerCase()}function r(t){var e=t.charCodeAt(0);return 32<e&&127>e&&-1==[34,35,60,62,63,96].indexOf(e)?t:encodeURIComponent(t)}function n(t){var e=t.charCodeAt(0);return 32<e&&127>e&&-1==[34,35,60,62,96].indexOf(e)?t:encodeURIComponent(t)}function i(t,i,o){function s(t){m.push(t)}var l=i||"scheme start",f=0,p="",v=!1,g=!1,m=[];t:for(;(null!=t[f-1]||0==f)&&!this.h;){var y=t[f];switch(l){case"scheme start":if(!y||!c.test(y)){if(i){s("Invalid scheme.");break t}p="",l="no scheme";continue}p+=y.toLowerCase(),l="scheme";break;case"scheme":if(y&&h.test(y))p+=y.toLowerCase();else{if(":"!=y){if(i){null!=y&&s("Code point not allowed in scheme: "+y);break t}p="",f=0,l="no scheme";continue}if(this.g=p,p="",i)break t;void 0!==u[this.g]&&(this.A=!0),l="file"==this.g?"relative":this.A&&o&&o.g==this.g?"relative or authority":this.A?"authority first slash":"scheme data"}break;case"scheme data":"?"==y?(this.o="?",l="query"):"#"==y?(this.u="#",l="fragment"):null!=y&&"\t"!=y&&"\n"!=y&&"\r"!=y&&(this.pa+=r(y));break;case"no scheme":if(o&&void 0!==u[o.g]){l="relative";continue}s("Missing scheme."),a.call(this),this.h=!0;break;case"relative or authority":if("/"!=y||"/"!=t[f+1]){s("Expected /, got: "+y),l="relative";continue}l="authority ignore slashes";break;case"relative":if(this.A=!0,"file"!=this.g&&(this.g=o.g),null==y){this.i=o.i,this.m=o.m,this.j=o.j.slice(),this.o=o.o,this.s=o.s,this.f=o.f;break t}if("/"==y||"\\"==y)"\\"==y&&s("\\ is an invalid code point."),l="relative slash";else if("?"==y)this.i=o.i,this.m=o.m,this.j=o.j.slice(),this.o="?",this.s=o.s,this.f=o.f,l="query";else{if("#"!=y){l=t[f+1];var _=t[f+2];("file"!=this.g||!c.test(y)||":"!=l&&"|"!=l||null!=_&&"/"!=_&&"\\"!=_&&"?"!=_&&"#"!=_)&&(this.i=o.i,this.m=o.m,this.s=o.s,this.f=o.f,this.j=o.j.slice(),this.j.pop()),l="relative path";continue}this.i=o.i,this.m=o.m,this.j=o.j.slice(),this.o=o.o,this.u="#",this.s=o.s,this.f=o.f,l="fragment"}break;case"relative slash":if("/"!=y&&"\\"!=y){"file"!=this.g&&(this.i=o.i,this.m=o.m,this.s=o.s,this.f=o.f),l="relative path";continue}"\\"==y&&s("\\ is an invalid code point."),l="file"==this.g?"file host":"authority ignore slashes";break;case"authority first slash":if("/"!=y){s("Expected '/', got: "+y),l="authority ignore slashes";continue}l="authority second slash";break;case"authority second slash":if(l="authority ignore slashes","/"!=y){s("Expected '/', got: "+y);continue}break;case"authority ignore slashes":if("/"!=y&&"\\"!=y){l="authority";continue}s("Expected authority, got: "+y);break;case"authority":if("@"==y){for(v&&(s("@ already seen."),p+="%40"),v=!0,y=0;y<p.length;y++)"\t"==(_=p[y])||"\n"==_||"\r"==_?s("Invalid whitespace in authority."):":"==_&&null===this.f?this.f="":(_=r(_),null!==this.f?this.f+=_:this.s+=_);p=""}else{if(null==y||"/"==y||"\\"==y||"?"==y||"#"==y){f-=p.length,p="",l="host";continue}p+=y}break;case"file host":if(null==y||"/"==y||"\\"==y||"?"==y||"#"==y){2!=p.length||!c.test(p[0])||":"!=p[1]&&"|"!=p[1]?(0!=p.length&&(this.i=e.call(this,p),p=""),l="relative path start"):l="relative path";continue}"\t"==y||"\n"==y||"\r"==y?s("Invalid whitespace in file host."):p+=y;break;case"host":case"hostname":if(":"!=y||g){if(null==y||"/"==y||"\\"==y||"?"==y||"#"==y){if(this.i=e.call(this,p),p="",l="relative path start",i)break t;continue}"\t"!=y&&"\n"!=y&&"\r"!=y?("["==y?g=!0:"]"==y&&(g=!1),p+=y):s("Invalid code point in host/hostname: "+y)}else if(this.i=e.call(this,p),p="",l="port","hostname"==i)break t;break;case"port":if(/[0-9]/.test(y))p+=y;else{if(null==y||"/"==y||"\\"==y||"?"==y||"#"==y||i){if(""!=p&&((p=parseInt(p,10))!=u[this.g]&&(this.m=p+""),p=""),i)break t;l="relative path start";continue}"\t"==y||"\n"==y||"\r"==y?s("Invalid code point in port: "+y):(a.call(this),this.h=!0)}break;case"relative path start":if("\\"==y&&s("'\\' not allowed in path."),l="relative path","/"!=y&&"\\"!=y)continue;break;case"relative path":null!=y&&"/"!=y&&"\\"!=y&&(i||"?"!=y&&"#"!=y)?"\t"!=y&&"\n"!=y&&"\r"!=y&&(p+=r(y)):("\\"==y&&s("\\ not allowed in relative path."),(_=d[p.toLowerCase()])&&(p=_),".."==p?(this.j.pop(),"/"!=y&&"\\"!=y&&this.j.push("")):"."==p&&"/"!=y&&"\\"!=y?this.j.push(""):"."!=p&&("file"==this.g&&0==this.j.length&&2==p.length&&c.test(p[0])&&"|"==p[1]&&(p=p[0]+":"),this.j.push(p)),p="","?"==y?(this.o="?",l="query"):"#"==y&&(this.u="#",l="fragment"));break;case"query":i||"#"!=y?null!=y&&"\t"!=y&&"\n"!=y&&"\r"!=y&&(this.o+=n(y)):(this.u="#",l="fragment");break;case"fragment":null!=y&&"\t"!=y&&"\n"!=y&&"\r"!=y&&(this.u+=y)}f++}}function a(){this.s=this.pa=this.g="",this.f=null,this.m=this.i="",this.j=[],this.u=this.o="",this.A=this.h=!1}function o(t,e){void 0===e||e instanceof o||(e=new o(String(e))),this.a=t,a.call(this),i.call(this,this.a.replace(/^[ \t\r\n\f]+|[ \t\r\n\f]+$/g,""),null,e)}var s=!1;try{var l=new URL("b","http://a");l.pathname="c%20d",s="http://a/c%20d"===l.href}catch(p){}if(!s){var u=Object.create(null);u.ftp=21,u.file=0,u.gopher=70,u.http=80,u.https=443,u.ws=80,u.wss=443;var d=Object.create(null);d["%2e"]=".",d[".%2e"]="..",d["%2e."]="..",d["%2e%2e"]="..";var c=/[a-zA-Z]/,h=/[a-zA-Z0-9\+\-\.]/;o.prototype={toString:function(){return this.href},get href(){if(this.h)return this.a;var t="";return""==this.s&&null==this.f||(t=this.s+(null!=this.f?":"+this.f:"")+"@"),this.protocol+(this.A?"//"+t+this.host:"")+this.pathname+this.o+this.u},set href(t){a.call(this),i.call(this,t)},get protocol(){return this.g+":"},set protocol(t){this.h||i.call(this,t+":","scheme start")},get host(){return this.h?"":this.m?this.i+":"+this.m:this.i},set host(t){!this.h&&this.A&&i.call(this,t,"host")},get hostname(){return this.i},set hostname(t){!this.h&&this.A&&i.call(this,t,"hostname")},get port(){return this.m},set port(t){!this.h&&this.A&&i.call(this,t,"port")},get pathname(){return this.h?"":this.A?"/"+this.j.join("/"):this.pa},set pathname(t){!this.h&&this.A&&(this.j=[],i.call(this,t,"relative path start"))},get search(){return this.h||!this.o||"?"==this.o?"":this.o},set search(t){!this.h&&this.A&&(this.o="?","?"==t[0]&&(t=t.slice(1)),i.call(this,t,"query"))},get hash(){return this.h||!this.u||"#"==this.u?"":this.u},set hash(t){this.h||(t?(this.u="#","#"==t[0]&&(t=t.slice(1)),i.call(this,t,"fragment")):this.u="")},get origin(){var t;if(this.h||!this.g)return"";switch(this.g){case"data":case"file":case"javascript":case"mailto":return"null"}return(t=this.host)?this.g+"://"+t:""}};var f=t.URL;f&&(o.createObjectURL=function(t){return f.createObjectURL.apply(f,arguments)},o.revokeObjectURL=function(t){f.revokeObjectURL(t)}),t.URL=o}}(window),Object.getOwnPropertyDescriptor(Node.prototype,"baseURI")||Object.defineProperty(Node.prototype,"baseURI",{get:function(){var t=(this.ownerDocument||this).querySelector("base[href]");return t&&t.href||window.location.href},configurable:!0,enumerable:!0});var Ka=document.createElement("style");Ka.textContent="body {transition: opacity ease-in 0.2s; } \nbody[unresolved] {opacity: 0; display: block; overflow: hidden; position: relative; } \n";var Va=document.querySelector("head");Va.insertBefore(Ka,Va.firstChild);var Wa=window.customElements,qa=!1,Ya=null;function za(){window.HTMLTemplateElement.bootstrap&&window.HTMLTemplateElement.bootstrap(window.document),Ya&&Ya(),qa=!0,window.WebComponents.ready=!0,document.dispatchEvent(new CustomEvent("WebComponentsReady",{bubbles:!0}))}Wa.polyfillWrapFlushCallback&&Wa.polyfillWrapFlushCallback((function(t){Ya=t,qa&&t()})),"complete"!==document.readyState?(window.addEventListener("load",za),window.addEventListener("DOMContentLoaded",(function(){window.removeEventListener("load",za),za()}))):za()}).call(this),"undefined"!=typeof window&&function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Hls=e():t.Hls=e()}(this,(function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,(function(e){return t[e]}).bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/dist/",r(r.s=13)}([function(t,e,r){"use strict";r.d(e,"a",(function(){return d})),r.d(e,"b",(function(){return c}));var n=r(5);function i(){}var a={trace:i,debug:i,log:i,warn:i,info:i,error:i},o=a;function s(t,e){return"["+t+"] > "+e}var l=Object(n.a)();function u(t){var e=l.console[t];return e?function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];n[0]&&(n[0]=s(t,n[0])),e.apply(l.console,n)}:i}var d=function(t){if(l.console&&!0===t||"object"==typeof t){!function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];r.forEach((function(e){o[e]=t[e]?t[e].bind(t):u(e)}))}(t,"debug","log","info","warn","error");try{o.log()}catch(t){o=a}}else o=a},c=o},function(t,e,r){"use strict";e.a={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition",LIVE_BACK_BUFFER_REACHED:"hlsLiveBackBufferReached"}},function(t,e,r){"use strict";var n,i;r.d(e,"b",(function(){return n})),r.d(e,"a",(function(){return i})),function(t){t.NETWORK_ERROR="networkError",t.MEDIA_ERROR="mediaError",t.KEY_SYSTEM_ERROR="keySystemError",t.MUX_ERROR="muxError",t.OTHER_ERROR="otherError"}(n||(n={})),function(t){t.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",t.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",t.KEY_SYSTEM_NO_SESSION="keySystemNoSession",t.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",t.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData",t.MANIFEST_LOAD_ERROR="manifestLoadError",t.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",t.MANIFEST_PARSING_ERROR="manifestParsingError",t.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",t.LEVEL_LOAD_ERROR="levelLoadError",t.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",t.LEVEL_SWITCH_ERROR="levelSwitchError",t.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",t.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",t.FRAG_LOAD_ERROR="fragLoadError",t.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",t.FRAG_DECRYPT_ERROR="fragDecryptError",t.FRAG_PARSING_ERROR="fragParsingError",t.REMUX_ALLOC_ERROR="remuxAllocError",t.KEY_LOAD_ERROR="keyLoadError",t.KEY_LOAD_TIMEOUT="keyLoadTimeOut",t.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",t.BUFFER_APPEND_ERROR="bufferAppendError",t.BUFFER_APPENDING_ERROR="bufferAppendingError",t.BUFFER_STALLED_ERROR="bufferStalledError",t.BUFFER_FULL_ERROR="bufferFullError",t.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",t.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",t.INTERNAL_EXCEPTION="internalException"}(i||(i={}))},function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));var n=Number.isFinite||function(t){return"number"==typeof t&&isFinite(t)}},function(t,e,r){"use strict";r.d(e,"b",(function(){return s}));var n,i=r(5),a=function(){function t(){}return t.isHeader=function(t,e){return e+10<=t.length&&73===t[e]&&68===t[e+1]&&51===t[e+2]&&t[e+3]<255&&t[e+4]<255&&t[e+6]<128&&t[e+7]<128&&t[e+8]<128&&t[e+9]<128},t.isFooter=function(t,e){return e+10<=t.length&&51===t[e]&&68===t[e+1]&&73===t[e+2]&&t[e+3]<255&&t[e+4]<255&&t[e+6]<128&&t[e+7]<128&&t[e+8]<128&&t[e+9]<128},t.getID3Data=function(e,r){for(var n=r,i=0;t.isHeader(e,r);)i+=10,i+=t._readSize(e,r+6),t.isFooter(e,r+10)&&(i+=10),r+=i;if(i>0)return e.subarray(n,n+i)},t._readSize=function(t,e){var r=0;return r=(127&t[e])<<21,r|=(127&t[e+1])<<14,(r|=(127&t[e+2])<<7)|127&t[e+3]},t.getTimeStamp=function(e){for(var r=t.getID3Frames(e),n=0;n<r.length;n++){var i=r[n];if(t.isTimeStampFrame(i))return t._readTimeStamp(i)}},t.isTimeStampFrame=function(t){return t&&"PRIV"===t.key&&"com.apple.streaming.transportStreamTimestamp"===t.info},t._getFrameData=function(e){var r=String.fromCharCode(e[0],e[1],e[2],e[3]),n=t._readSize(e,4);return{type:r,size:n,data:e.subarray(10,10+n)}},t.getID3Frames=function(e){for(var r=0,n=[];t.isHeader(e,r);){for(var i=t._readSize(e,r+6),a=(r+=10)+i;r+8<a;){var o=t._getFrameData(e.subarray(r)),s=t._decodeFrame(o);s&&n.push(s),r+=o.size+10}t.isFooter(e,r)&&(r+=10)}return n},t._decodeFrame=function(e){return"PRIV"===e.type?t._decodePrivFrame(e):"T"===e.type[0]?t._decodeTextFrame(e):"W"===e.type[0]?t._decodeURLFrame(e):void 0},t._readTimeStamp=function(t){if(8===t.data.byteLength){var e=new Uint8Array(t.data),r=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return r/=45,1&e[3]&&(r+=47721858.84),Math.round(r)}},t._decodePrivFrame=function(e){if(!(e.size<2)){var r=t._utf8ArrayToStr(e.data,!0),n=new Uint8Array(e.data.subarray(r.length+1));return{key:e.type,info:r,data:n.buffer}}},t._decodeTextFrame=function(e){if(!(e.size<2)){if("TXXX"===e.type){var r=1,n=t._utf8ArrayToStr(e.data.subarray(r),!0),i=t._utf8ArrayToStr(e.data.subarray(r+=n.length+1));return{key:e.type,info:n,data:i}}var a=t._utf8ArrayToStr(e.data.subarray(1));return{key:e.type,data:a}}},t._decodeURLFrame=function(e){if("WXXX"===e.type){if(e.size<2)return;var r=1,n=t._utf8ArrayToStr(e.data.subarray(r)),i=t._utf8ArrayToStr(e.data.subarray(r+=n.length+1));return{key:e.type,info:n,data:i}}var a=t._utf8ArrayToStr(e.data);return{key:e.type,data:a}},t._utf8ArrayToStr=function(t,e){void 0===e&&(e=!1);var r=o();if(r){var n=r.decode(t);if(e){var i=n.indexOf("\0");return-1!==i?n.substring(0,i):n}return n.replace(/\0/g,"")}for(var a,s,l,u=t.length,d="",c=0;c<u;){if(0===(a=t[c++])&&e)return d;if(0!==a&&3!==a)switch(a>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:d+=String.fromCharCode(a);break;case 12:case 13:s=t[c++],d+=String.fromCharCode((31&a)<<6|63&s);break;case 14:s=t[c++],l=t[c++],d+=String.fromCharCode((15&a)<<12|(63&s)<<6|(63&l)<<0)}}return d},t}();function o(){var t=Object(i.a)();return n||void 0===t.TextDecoder||(n=new t.TextDecoder("utf-8")),n}var s=a._utf8ArrayToStr;e.a=a},function(t,e,r){"use strict";function n(){return"undefined"==typeof window?self:window}r.d(e,"a",(function(){return n}))},function(t,e,r){var n,i,a,o,s;n=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,i=/^([^\/?#]*)(.*)$/,a=/(?:\/|^)\.(?=\/)/g,o=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,s={buildAbsoluteURL:function(t,e,r){if(r=r||{},t=t.trim(),!(e=e.trim())){if(!r.alwaysNormalize)return t;var n=s.parseURL(t);if(!n)throw new Error("Error trying to parse base URL.");return n.path=s.normalizePath(n.path),s.buildURLFromParts(n)}var a=s.parseURL(e);if(!a)throw new Error("Error trying to parse relative URL.");if(a.scheme)return r.alwaysNormalize?(a.path=s.normalizePath(a.path),s.buildURLFromParts(a)):e;var o=s.parseURL(t);if(!o)throw new Error("Error trying to parse base URL.");if(!o.netLoc&&o.path&&"/"!==o.path[0]){var l=i.exec(o.path);o.netLoc=l[1],o.path=l[2]}o.netLoc&&!o.path&&(o.path="/");var u={scheme:o.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc&&(u.netLoc=o.netLoc,"/"!==a.path[0]))if(a.path){var d=o.path,c=d.substring(0,d.lastIndexOf("/")+1)+a.path;u.path=s.normalizePath(c)}else u.path=o.path,a.params||(u.params=o.params,a.query||(u.query=o.query));return null===u.path&&(u.path=r.alwaysNormalize?s.normalizePath(a.path):a.path),s.buildURLFromParts(u)},parseURL:function(t){var e=n.exec(t);return e?{scheme:e[1]||"",netLoc:e[2]||"",path:e[3]||"",params:e[4]||"",query:e[5]||"",fragment:e[6]||""}:null},normalizePath:function(t){for(t=t.split("").reverse().join("").replace(a,"");t.length!==(t=t.replace(o,"")).length;);return t.split("").reverse().join("")},buildURLFromParts:function(t){return t.scheme+t.netLoc+t.path+t.params+t.query+t.fragment}},t.exports=s},function(t,e,r){"use strict";var n=function(){function t(t,e){this.subtle=t,this.aesIV=e}return t.prototype.decrypt=function(t,e){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},e,t)},t}(),i=function(){function t(t,e){this.subtle=t,this.key=e}return t.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},t}(),a=function(){function t(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}var e=t.prototype;return e.uint8ArrayToUint32Array_=function(t){for(var e=new DataView(t),r=new Uint32Array(4),n=0;n<4;n++)r[n]=e.getUint32(4*n);return r},e.initTable=function(){var t=this.sBox,e=this.invSBox,r=this.subMix,n=r[0],i=r[1],a=r[2],o=r[3],s=this.invSubMix,l=s[0],u=s[1],d=s[2],c=s[3],h=new Uint32Array(256),f=0,p=0,v=0;for(v=0;v<256;v++)h[v]=v<128?v<<1:v<<1^283;for(v=0;v<256;v++){var g=p^p<<1^p<<2^p<<3^p<<4;t[f]=g=g>>>8^255&g^99,e[g]=f;var m=h[f],y=h[m],_=h[y],b=257*h[g]^16843008*g;n[f]=b<<24|b>>>8,i[f]=b<<16|b>>>16,a[f]=b<<8|b>>>24,o[f]=b,l[g]=(b=16843009*_^65537*y^257*m^16843008*f)<<24|b>>>8,u[g]=b<<16|b>>>16,d[g]=b<<8|b>>>24,c[g]=b,f?(f=m^h[h[h[_^m]]],p^=h[h[p]]):f=p=1}},e.expandKey=function(t){for(var e=this.uint8ArrayToUint32Array_(t),r=!0,n=0;n<e.length&&r;)r=e[n]===this.key[n],n++;if(!r){this.key=e;var i=this.keySize=e.length;if(4!==i&&6!==i&&8!==i)throw new Error("Invalid aes key size="+i);var a,o,s,l,u=this.ksRows=4*(i+6+1),d=this.keySchedule=new Uint32Array(u),c=this.invKeySchedule=new Uint32Array(u),h=this.sBox,f=this.rcon,p=this.invSubMix,v=p[0],g=p[1],m=p[2],y=p[3];for(a=0;a<u;a++)a<i?s=d[a]=e[a]:(l=s,a%i==0?(l=h[(l=l<<8|l>>>24)>>>24]<<24|h[l>>>16&255]<<16|h[l>>>8&255]<<8|h[255&l],l^=f[a/i|0]<<24):i>6&&a%i==4&&(l=h[l>>>24]<<24|h[l>>>16&255]<<16|h[l>>>8&255]<<8|h[255&l]),d[a]=s=(d[a-i]^l)>>>0);for(o=0;o<u;o++)a=u-o,l=3&o?d[a]:d[a-4],c[o]=o<4||a<=4?l:v[h[l>>>24]]^g[h[l>>>16&255]]^m[h[l>>>8&255]]^y[h[255&l]],c[o]=c[o]>>>0}},e.networkToHostOrderSwap=function(t){return t<<24|(65280&t)<<8|(16711680&t)>>8|t>>>24},e.decrypt=function(t,e,r,n){for(var i,a,o,s,l,u,d,c,h,f,p,v,g,m,y,_,b,E=this.keySize+6,T=this.invKeySchedule,S=this.invSBox,w=this.invSubMix,A=w[0],C=w[1],R=w[2],L=w[3],D=this.uint8ArrayToUint32Array_(r),k=D[0],O=D[1],N=D[2],x=D[3],I=new Int32Array(t),P=new Int32Array(I.length),M=this.networkToHostOrderSwap;e<I.length;){for(h=M(I[e]),f=M(I[e+1]),p=M(I[e+2]),v=M(I[e+3]),l=h^T[0],u=v^T[1],d=p^T[2],c=f^T[3],g=4,m=1;m<E;m++)a=A[u>>>24]^C[d>>16&255]^R[c>>8&255]^L[255&l]^T[g+1],o=A[d>>>24]^C[c>>16&255]^R[l>>8&255]^L[255&u]^T[g+2],s=A[c>>>24]^C[l>>16&255]^R[u>>8&255]^L[255&d]^T[g+3],l=i=A[l>>>24]^C[u>>16&255]^R[d>>8&255]^L[255&c]^T[g],u=a,d=o,c=s,g+=4;i=S[l>>>24]<<24^S[u>>16&255]<<16^S[d>>8&255]<<8^S[255&c]^T[g],a=S[u>>>24]<<24^S[d>>16&255]<<16^S[c>>8&255]<<8^S[255&l]^T[g+1],o=S[d>>>24]<<24^S[c>>16&255]<<16^S[l>>8&255]<<8^S[255&u]^T[g+2],s=S[c>>>24]<<24^S[l>>16&255]<<16^S[u>>8&255]<<8^S[255&d]^T[g+3],g+=3,P[e]=M(i^k),P[e+1]=M(s^O),P[e+2]=M(o^N),P[e+3]=M(a^x),k=h,O=f,N=p,x=v,e+=4}return n?(b=(_=(y=P.buffer).byteLength)&&new DataView(y).getUint8(_-1))?y.slice(0,_-b):y:P.buffer},e.destroy=function(){this.key=void 0,this.keySize=void 0,this.ksRows=void 0,this.sBox=void 0,this.invSBox=void 0,this.subMix=void 0,this.invSubMix=void 0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.rcon=void 0},t}(),o=r(2),s=r(0),l=r(1),u=r(5),d=Object(u.a)(),c=function(){function t(t,e,r){var n=(void 0===r?{}:r).removePKCS7Padding,i=void 0===n||n;if(this.logEnabled=!0,this.observer=t,this.config=e,this.removePKCS7Padding=i,i)try{var a=d.crypto;a&&(this.subtle=a.subtle||a.webkitSubtle)}catch(t){}this.disableWebCrypto=!this.subtle}var e=t.prototype;return e.isSync=function(){return this.disableWebCrypto&&this.config.enableSoftwareAES},e.decrypt=function(t,e,r,o){var l=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){this.logEnabled&&(s.b.log("JS AES decrypt"),this.logEnabled=!1);var u=this.decryptor;u||(this.decryptor=u=new a),u.expandKey(e),o(u.decrypt(t,0,r,this.removePKCS7Padding))}else{this.logEnabled&&(s.b.log("WebCrypto AES decrypt"),this.logEnabled=!1);var d=this.subtle;this.key!==e&&(this.key=e,this.fastAesKey=new i(d,e)),this.fastAesKey.expandKey().then((function(i){new n(d,r).decrypt(t,i).catch((function(n){l.onWebCryptoError(n,t,e,r,o)})).then((function(t){o(t)}))})).catch((function(n){l.onWebCryptoError(n,t,e,r,o)}))}},e.onWebCryptoError=function(t,e,r,n,i){this.config.enableSoftwareAES?(s.b.log("WebCrypto Error, disable WebCrypto API"),this.disableWebCrypto=!0,this.logEnabled=!0,this.decrypt(e,r,n,i)):(s.b.error("decrypting error : "+t.message),this.observer.trigger(l.a.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.FRAG_DECRYPT_ERROR,fatal:!0,reason:t.message}))},e.destroy=function(){var t=this.decryptor;t&&(t.destroy(),this.decryptor=void 0)},t}();e.a=c},function(t,e,r){"use strict";var n=Object.prototype.hasOwnProperty,i="~";function a(){}function o(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function s(t,e,r,n,a){if("function"!=typeof r)throw new TypeError("The listener must be a function");var s=new o(r,n||t,a),l=i?i+e:e;return t._events[l]?t._events[l].fn?t._events[l]=[t._events[l],s]:t._events[l].push(s):(t._events[l]=s,t._eventsCount++),t}function l(t,e){0==--t._eventsCount?t._events=new a:delete t._events[e]}function u(){this._events=new a,this._eventsCount=0}Object.create&&(a.prototype=Object.create(null),(new a).__proto__||(i=!1)),u.prototype.eventNames=function(){var t,e,r=[];if(0===this._eventsCount)return r;for(e in t=this._events)n.call(t,e)&&r.push(i?e.slice(1):e);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r},u.prototype.listeners=function(t){var e=this._events[i?i+t:t];if(!e)return[];if(e.fn)return[e.fn];for(var r=0,n=e.length,a=new Array(n);r<n;r++)a[r]=e[r].fn;return a},u.prototype.listenerCount=function(t){var e=this._events[i?i+t:t];return e?e.fn?1:e.length:0},u.prototype.emit=function(t,e,r,n,a,o){var s=i?i+t:t;if(!this._events[s])return!1;var l,u,d=this._events[s],c=arguments.length;if(d.fn){switch(d.once&&this.removeListener(t,d.fn,void 0,!0),c){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,e),!0;case 3:return d.fn.call(d.context,e,r),!0;case 4:return d.fn.call(d.context,e,r,n),!0;case 5:return d.fn.call(d.context,e,r,n,a),!0;case 6:return d.fn.call(d.context,e,r,n,a,o),!0}for(u=1,l=new Array(c-1);u<c;u++)l[u-1]=arguments[u];d.fn.apply(d.context,l)}else{var h,f=d.length;for(u=0;u<f;u++)switch(d[u].once&&this.removeListener(t,d[u].fn,void 0,!0),c){case 1:d[u].fn.call(d[u].context);break;case 2:d[u].fn.call(d[u].context,e);break;case 3:d[u].fn.call(d[u].context,e,r);break;case 4:d[u].fn.call(d[u].context,e,r,n);break;default:if(!l)for(h=1,l=new Array(c-1);h<c;h++)l[h-1]=arguments[h];d[u].fn.apply(d[u].context,l)}}return!0},u.prototype.on=function(t,e,r){return s(this,t,e,r,!1)},u.prototype.once=function(t,e,r){return s(this,t,e,r,!0)},u.prototype.removeListener=function(t,e,r,n){var a=i?i+t:t;if(!this._events[a])return this;if(!e)return l(this,a),this;var o=this._events[a];if(o.fn)o.fn!==e||n&&!o.once||r&&o.context!==r||l(this,a);else{for(var s=0,u=[],d=o.length;s<d;s++)(o[s].fn!==e||n&&!o[s].once||r&&o[s].context!==r)&&u.push(o[s]);u.length?this._events[a]=1===u.length?u[0]:u:l(this,a)}return this},u.prototype.removeAllListeners=function(t){var e;return t?this._events[e=i?i+t:t]&&l(this,e):(this._events=new a,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=i,u.EventEmitter=u,t.exports=u},function(t,e,r){"use strict";var n=r(1),i=r(2),a=r(7),o=r(3),s=r(0),l=r(5);function u(t,e){return 255===t[e]&&240==(246&t[e+1])}function d(t,e){return 1&t[e+1]?7:9}function c(t,e){return(3&t[e+3])<<11|t[e+4]<<3|(224&t[e+5])>>>5}function h(t,e){return!!(e+1<t.length&&u(t,e))}function f(t,e){if(h(t,e)){var r=d(t,e);e+5<t.length&&(r=c(t,e));var n=e+r;if(n===t.length||n+1<t.length&&u(t,n))return!0}return!1}function p(t,e,r,a,o){if(!t.samplerate){var l=function(t,e,r,a){var o,l,u,d,c,h=navigator.userAgent.toLowerCase(),f=a,p=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];if(o=1+((192&e[r+2])>>>6),!((l=(60&e[r+2])>>>2)>p.length-1))return d=(1&e[r+2])<<2,s.b.log("manifest codec:"+a+",ADTS data:type:"+o+",sampleingIndex:"+l+"["+p[l]+"Hz],channelConfig:"+(d|=(192&e[r+3])>>>6)),/firefox/i.test(h)?l>=6?(o=5,c=new Array(4),u=l-3):(o=2,c=new Array(2),u=l):-1!==h.indexOf("android")?(o=2,c=new Array(2),u=l):(o=5,c=new Array(4),a&&(-1!==a.indexOf("mp4a.40.29")||-1!==a.indexOf("mp4a.40.5"))||!a&&l>=6?u=l-3:((a&&-1!==a.indexOf("mp4a.40.2")&&(l>=6&&1===d||/vivaldi/i.test(h))||!a&&1===d)&&(o=2,c=new Array(2)),u=l)),c[0]=o<<3,c[0]|=(14&l)>>1,c[1]|=(1&l)<<7,c[1]|=d<<3,5===o&&(c[1]|=(14&u)>>1,c[2]=(1&u)<<7,c[2]|=8,c[3]=0),{config:c,samplerate:p[l],channelCount:d,codec:"mp4a.40."+o,manifestCodec:f};t.trigger(n.a.ERROR,{type:i.b.MEDIA_ERROR,details:i.a.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+l})}(e,r,a,o);t.config=l.config,t.samplerate=l.samplerate,t.channelCount=l.channelCount,t.codec=l.codec,t.manifestCodec=l.manifestCodec,s.b.log("parsed codec:"+t.codec+",rate:"+l.samplerate+",nb channel:"+l.channelCount)}}function v(t){return 9216e4/t}function g(t,e,r,n,i){var a=function(t,e,r,n,i){var a,o,s=t.length;if(a=d(t,e),o=c(t,e),(o-=a)>0&&e+a+o<=s)return{headerLength:a,frameLength:o,stamp:r+n*i}}(e,r,n,i,v(t.samplerate));if(a){var o=a.stamp,s=a.headerLength,l=a.frameLength,u={unit:e.subarray(r+s,r+s+l),pts:o,dts:o};return t.samples.push(u),{sample:u,length:l+s}}}var m=r(4),y=function(){function t(t,e,r){this.observer=t,this.config=r,this.remuxer=e}var e=t.prototype;return e.resetInitSegment=function(t,e,r,n){this._audioTrack={container:"audio/adts",type:"audio",id:0,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:e,duration:n,inputTimeScale:9e4}},e.resetTimeStamp=function(){},t.probe=function(t){if(!t)return!1;for(var e=(m.a.getID3Data(t,0)||[]).length,r=t.length;e<r;e++)if(f(t,e))return s.b.log("ADTS sync word found !"),!0;return!1},e.append=function(t,e,r,n){for(var i=this._audioTrack,a=m.a.getID3Data(t,0)||[],l=m.a.getTimeStamp(a),u=Object(o.a)(l)?90*l:9e4*e,d=0,c=u,f=t.length,v=a.length,y=[{pts:c,dts:c,data:a}];v<f-1;)if(h(t,v)&&v+5<f){p(i,this.observer,t,v,i.manifestCodec);var _=g(i,t,v,u,d);if(!_){s.b.log("Unable to parse AAC frame");break}v+=_.length,c=_.sample.pts,d++}else m.a.isHeader(t,v)?(a=m.a.getID3Data(t,v),y.push({pts:c,dts:c,data:a}),v+=a.length):v++;this.remuxer.remux(i,{samples:[]},{samples:y,inputTimeScale:9e4},{samples:[]},e,r,n)},e.destroy=function(){},t}(),_=r(10),b={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients:[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot:[0,1,1,4],appendFrame:function(t,e,r,n,i){if(!(r+24>e.length)){var a=this.parseHeader(e,r);if(a&&r+a.frameLength<=e.length){var o=n+i*(9e4*a.samplesPerFrame/a.sampleRate),s={unit:e.subarray(r,r+a.frameLength),pts:o,dts:o};return t.config=[],t.channelCount=a.channelCount,t.samplerate=a.sampleRate,t.samples.push(s),{sample:s,length:a.frameLength}}}},parseHeader:function(t,e){var r=t[e+1]>>3&3,n=t[e+1]>>1&3,i=t[e+2]>>4&15,a=t[e+2]>>2&3;if(1!==r&&0!==i&&15!==i&&3!==a){var o=b.SamplingRateMap[3*(3===r?0:2===r?1:2)+a],s=b.SamplesCoefficients[r][n],l=b.BytesInSlot[n],u=8*s*l;return{sampleRate:o,channelCount:t[e+3]>>6==3?1:2,frameLength:parseInt(s*(1e3*b.BitratesMap[14*(3===r?3-n:3===n?3:4)+i-1])/o+(t[e+2]>>1&1),10)*l,samplesPerFrame:u}}},isHeaderPattern:function(t,e){return 255===t[e]&&224==(224&t[e+1])&&0!=(6&t[e+1])},isHeader:function(t,e){return!!(e+1<t.length&&this.isHeaderPattern(t,e))},probe:function(t,e){if(e+1<t.length&&this.isHeaderPattern(t,e)){var r=this.parseHeader(t,e),n=4;r&&r.frameLength&&(n=r.frameLength);var i=e+n;if(i===t.length||i+1<t.length&&this.isHeaderPattern(t,i))return!0}return!1}},E=b,T=function(){function t(t){this.data=t,this.bytesAvailable=t.byteLength,this.word=0,this.bitsAvailable=0}var e=t.prototype;return e.loadWord=function(){var t=this.data,e=this.bytesAvailable,r=t.byteLength-e,n=new Uint8Array(4),i=Math.min(4,e);if(0===i)throw new Error("no bytes available");n.set(t.subarray(r,r+i)),this.word=new DataView(n.buffer).getUint32(0),this.bitsAvailable=8*i,this.bytesAvailable-=i},e.skipBits=function(t){var e;this.bitsAvailable>t?(this.word<<=t,this.bitsAvailable-=t):(t-=this.bitsAvailable,t-=(e=t>>3)>>3,this.bytesAvailable-=e,this.loadWord(),this.word<<=t,this.bitsAvailable-=t)},e.readBits=function(t){var e=Math.min(this.bitsAvailable,t),r=this.word>>>32-e;return t>32&&s.b.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=e,this.bitsAvailable>0?this.word<<=e:this.bytesAvailable>0&&this.loadWord(),(e=t-e)>0&&this.bitsAvailable?r<<e|this.readBits(e):r},e.skipLZ=function(){var t;for(t=0;t<this.bitsAvailable;++t)if(0!=(this.word&2147483648>>>t))return this.word<<=t,this.bitsAvailable-=t,t;return this.loadWord(),t+this.skipLZ()},e.skipUEG=function(){this.skipBits(1+this.skipLZ())},e.skipEG=function(){this.skipBits(1+this.skipLZ())},e.readUEG=function(){var t=this.skipLZ();return this.readBits(t+1)-1},e.readEG=function(){var t=this.readUEG();return 1&t?1+t>>>1:-1*(t>>>1)},e.readBoolean=function(){return 1===this.readBits(1)},e.readUByte=function(){return this.readBits(8)},e.readUShort=function(){return this.readBits(16)},e.readUInt=function(){return this.readBits(32)},e.skipScalingList=function(t){var e,r=8,n=8;for(e=0;e<t;e++)0!==n&&(n=(r+this.readEG()+256)%256),r=0===n?r:n},e.readSPS=function(){var t,e,r,n,i,a,o,s=0,l=0,u=0,d=0,c=this.readUByte.bind(this),h=this.readBits.bind(this),f=this.readUEG.bind(this),p=this.readBoolean.bind(this),v=this.skipBits.bind(this),g=this.skipEG.bind(this),m=this.skipUEG.bind(this),y=this.skipScalingList.bind(this);if(c(),t=c(),h(5),v(3),c(),m(),100===t||110===t||122===t||244===t||44===t||83===t||86===t||118===t||128===t){var _=f();if(3===_&&v(1),m(),m(),v(1),p())for(a=3!==_?8:12,o=0;o<a;o++)p()&&y(o<6?16:64)}m();var b=f();if(0===b)f();else if(1===b)for(v(1),g(),g(),e=f(),o=0;o<e;o++)g();m(),v(1),r=f(),n=f(),0===(i=h(1))&&v(1),v(1),p()&&(s=f(),l=f(),u=f(),d=f());var E=[1,1];if(p()&&p())switch(c()){case 1:E=[1,1];break;case 2:E=[12,11];break;case 3:E=[10,11];break;case 4:E=[16,11];break;case 5:E=[40,33];break;case 6:E=[24,11];break;case 7:E=[20,11];break;case 8:E=[32,11];break;case 9:E=[80,33];break;case 10:E=[18,11];break;case 11:E=[15,11];break;case 12:E=[64,33];break;case 13:E=[160,99];break;case 14:E=[4,3];break;case 15:E=[3,2];break;case 16:E=[2,1];break;case 255:E=[c()<<8|c(),c()<<8|c()]}return{width:Math.ceil(16*(r+1)-2*s-2*l),height:(2-i)*(n+1)*16-(i?2:4)*(u+d),pixelRatio:E}},e.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},t}(),S=function(){function t(t,e,r,n){this.decryptdata=r,this.discardEPB=n,this.decrypter=new a.a(t,e,{removePKCS7Padding:!1})}var e=t.prototype;return e.decryptBuffer=function(t,e){this.decrypter.decrypt(t,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,e)},e.decryptAacSample=function(t,e,r,n){var i=t[e].unit,a=i.subarray(16,i.length-i.length%16),o=a.buffer.slice(a.byteOffset,a.byteOffset+a.length),s=this;this.decryptBuffer(o,(function(a){a=new Uint8Array(a),i.set(a,16),n||s.decryptAacSamples(t,e+1,r)}))},e.decryptAacSamples=function(t,e,r){for(;;e++){if(e>=t.length)return void r();if(!(t[e].unit.length<32)){var n=this.decrypter.isSync();if(this.decryptAacSample(t,e,r,n),!n)return}}},e.getAvcEncryptedData=function(t){for(var e=16*Math.floor((t.length-48)/160)+16,r=new Int8Array(e),n=0,i=32;i<=t.length-16;i+=160,n+=16)r.set(t.subarray(i,i+16),n);return r},e.getAvcDecryptedUnit=function(t,e){e=new Uint8Array(e);for(var r=0,n=32;n<=t.length-16;n+=160,r+=16)t.set(e.subarray(r,r+16),n);return t},e.decryptAvcSample=function(t,e,r,n,i,a){var o=this.discardEPB(i.data),s=this.getAvcEncryptedData(o),l=this;this.decryptBuffer(s.buffer,(function(s){i.data=l.getAvcDecryptedUnit(o,s),a||l.decryptAvcSamples(t,e,r+1,n)}))},e.decryptAvcSamples=function(t,e,r,n){for(;;e++,r=0){if(e>=t.length)return void n();for(var i=t[e].units;!(r>=i.length);r++){var a=i[r];if(!(a.length<=48||1!==a.type&&5!==a.type)){var o=this.decrypter.isSync();if(this.decryptAvcSample(t,e,r,n,a,o),!o)return}}}},t}(),w={video:1,audio:2,id3:3,text:4},A=function(){function t(t,e,r,n){this.observer=t,this.config=r,this.typeSupported=n,this.remuxer=e,this.sampleAes=null}var e=t.prototype;return e.setDecryptData=function(t){this.sampleAes=null!=t&&null!=t.key&&"SAMPLE-AES"===t.method?new S(this.observer,this.config,t,this.discardEPB):null},t.probe=function(e){var r=t._syncOffset(e);return!(r<0||(r&&s.b.warn("MPEG2-TS detected but first sync word found @ offset "+r+", junk ahead ?"),0))},t._syncOffset=function(t){for(var e=Math.min(1e3,t.length-564),r=0;r<e;){if(71===t[r]&&71===t[r+188]&&71===t[r+376])return r;r++}return-1},t.createTrack=function(t,e){return{container:"video"===t||"audio"===t?"video/mp2t":void 0,type:t,id:w[t],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:"video"===t?0:void 0,isAAC:"audio"===t||void 0,duration:"audio"===t?e:void 0}},e.resetInitSegment=function(e,r,n,i){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=t.createTrack("video",i),this._audioTrack=t.createTrack("audio",i),this._id3Track=t.createTrack("id3",i),this._txtTrack=t.createTrack("text",i),this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=r,this.videoCodec=n,this._duration=i},e.resetTimeStamp=function(){},e.append=function(e,r,a,o){var l,u,d,c,h,f=e.length,p=!1;this.contiguous=a;var v=this.pmtParsed,g=this._avcTrack,m=this._audioTrack,y=this._id3Track,_=g.pid,b=m.pid,E=y.pid,T=this._pmtId,S=g.pesData,w=m.pesData,A=y.pesData,C=this._parsePAT,R=this._parsePMT,L=this._parsePES,D=this._parseAVCPES.bind(this),k=this._parseAACPES.bind(this),O=this._parseMPEGPES.bind(this),N=this._parseID3PES.bind(this),x=t._syncOffset(e);for(f-=(f+x)%188,l=x;l<f;l+=188)if(71===e[l]){if(u=!!(64&e[l+1]),d=((31&e[l+1])<<8)+e[l+2],(48&e[l+3])>>4>1){if((c=l+5+e[l+4])===l+188)continue}else c=l+4;switch(d){case _:u&&(S&&(h=L(S))&&D(h,!1),S={data:[],size:0}),S&&(S.data.push(e.subarray(c,l+188)),S.size+=l+188-c);break;case b:u&&(w&&(h=L(w))&&(m.isAAC?k(h):O(h)),w={data:[],size:0}),w&&(w.data.push(e.subarray(c,l+188)),w.size+=l+188-c);break;case E:u&&(A&&(h=L(A))&&N(h),A={data:[],size:0}),A&&(A.data.push(e.subarray(c,l+188)),A.size+=l+188-c);break;case 0:u&&(c+=e[c]+1),T=this._pmtId=C(e,c);break;case T:u&&(c+=e[c]+1);var I=R(e,c,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,null!=this.sampleAes);(_=I.avc)>0&&(g.pid=_),(b=I.audio)>0&&(m.pid=b,m.isAAC=I.isAAC),(E=I.id3)>0&&(y.pid=E),p&&!v&&(s.b.log("reparse from beginning"),p=!1,l=x-188),v=this.pmtParsed=!0;break;case 17:case 8191:break;default:p=!0}}else this.observer.trigger(n.a.ERROR,{type:i.b.MEDIA_ERROR,details:i.a.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});S&&(h=L(S))?(D(h,!0),g.pesData=null):g.pesData=S,w&&(h=L(w))?(m.isAAC?k(h):O(h),m.pesData=null):(w&&w.size&&s.b.log("last AAC PES packet truncated,might overlap between fragments"),m.pesData=w),A&&(h=L(A))?(N(h),y.pesData=null):y.pesData=A,null==this.sampleAes?this.remuxer.remux(m,g,y,this._txtTrack,r,a,o):this.decryptAndRemux(m,g,y,this._txtTrack,r,a,o)},e.decryptAndRemux=function(t,e,r,n,i,a,o){if(t.samples&&t.isAAC){var s=this;this.sampleAes.decryptAacSamples(t.samples,0,(function(){s.decryptAndRemuxAvc(t,e,r,n,i,a,o)}))}else this.decryptAndRemuxAvc(t,e,r,n,i,a,o)},e.decryptAndRemuxAvc=function(t,e,r,n,i,a,o){if(e.samples){var s=this;this.sampleAes.decryptAvcSamples(e.samples,0,0,(function(){s.remuxer.remux(t,e,r,n,i,a,o)}))}else this.remuxer.remux(t,e,r,n,i,a,o)},e.destroy=function(){this._initPTS=this._initDTS=void 0,this._duration=0},e._parsePAT=function(t,e){return(31&t[e+10])<<8|t[e+11]},e._parsePMT=function(t,e,r,n){var i,a,o={audio:-1,avc:-1,id3:-1,isAAC:!0};for(i=e+3+((15&t[e+1])<<8|t[e+2])-4,e+=12+((15&t[e+10])<<8|t[e+11]);e<i;){switch(a=(31&t[e+1])<<8|t[e+2],t[e]){case 207:if(!n){s.b.log("unknown stream type:"+t[e]);break}case 15:-1===o.audio&&(o.audio=a);break;case 21:-1===o.id3&&(o.id3=a);break;case 219:if(!n){s.b.log("unknown stream type:"+t[e]);break}case 27:-1===o.avc&&(o.avc=a);break;case 3:case 4:r?-1===o.audio&&(o.audio=a,o.isAAC=!1):s.b.log("MPEG audio found, not supported in this browser for now");break;case 36:s.b.warn("HEVC stream type found, not supported for now");break;default:s.b.log("unknown stream type:"+t[e])}e+=5+((15&t[e+3])<<8|t[e+4])}return o},e._parsePES=function(t){var e,r,n,i,a,o,l,u,d=0,c=t.data;if(!t||0===t.size)return null;for(;c[0].length<19&&c.length>1;){var h=new Uint8Array(c[0].length+c[1].length);h.set(c[0]),h.set(c[1],c[0].length),c[0]=h,c.splice(1,1)}if(1===((e=c[0])[0]<<16)+(e[1]<<8)+e[2]){if((n=(e[4]<<8)+e[5])&&n>t.size-6)return null;if(192&(r=e[7])&&((o=536870912*(14&e[9])+4194304*(255&e[10])+16384*(254&e[11])+128*(255&e[12])+(254&e[13])/2)>4294967295&&(o-=8589934592),64&r?((l=536870912*(14&e[14])+4194304*(255&e[15])+16384*(254&e[16])+128*(255&e[17])+(254&e[18])/2)>4294967295&&(l-=8589934592),o-l>54e5&&(s.b.warn(Math.round((o-l)/9e4)+"s delta between PTS and DTS, align them"),o=l)):l=o),u=(i=e[8])+9,t.size<=u)return null;t.size-=u,a=new Uint8Array(t.size);for(var f=0,p=c.length;f<p;f++){var v=(e=c[f]).byteLength;if(u){if(u>v){u-=v;continue}e=e.subarray(u),v-=u,u=0}a.set(e,d),d+=v}return n&&(n-=i+3),{data:a,pts:o,dts:l,len:n}}return null},e.pushAccesUnit=function(t,e){if(t.units.length&&t.frame){var r=e.samples,n=r.length;if(isNaN(t.pts)){if(!n)return void e.dropped++;var i=r[n-1];t.pts=i.pts,t.dts=i.dts}!this.config.forceKeyFrameOnDiscontinuity||!0===t.key||e.sps&&(n||this.contiguous)?(t.id=n,r.push(t)):e.dropped++}t.debug.length&&s.b.log(t.pts+"/"+t.dts+":"+t.debug)},e._parseAVCPES=function(t,e){var r,n,i,a=this,o=this._avcTrack,s=this._parseAVCNALu(t.data),l=this.avcSample,u=!1,d=this.pushAccesUnit.bind(this),c=function(t,e,r,n){return{key:t,pts:e,dts:r,units:[],debug:n}};t.data=null,l&&s.length&&!o.audFound&&(d(l,o),l=this.avcSample=c(!1,t.pts,t.dts,"")),s.forEach((function(e){switch(e.type){case 1:n=!0,l||(l=a.avcSample=c(!0,t.pts,t.dts,"")),l.frame=!0;var s=e.data;if(u&&s.length>4){var h=new T(s).readSliceType();2!==h&&4!==h&&7!==h&&9!==h||(l.key=!0)}break;case 5:n=!0,l||(l=a.avcSample=c(!0,t.pts,t.dts,"")),l.key=!0,l.frame=!0;break;case 6:n=!0,(r=new T(a.discardEPB(e.data))).readUByte();for(var f=0,p=0,v=!1,g=0;!v&&r.bytesAvailable>1;){f=0;do{f+=g=r.readUByte()}while(255===g);p=0;do{p+=g=r.readUByte()}while(255===g);if(4===f&&0!==r.bytesAvailable){if(v=!0,181===r.readUByte()&&49===r.readUShort()&&1195456820===r.readUInt()&&3===r.readUByte()){var y=r.readUByte(),_=31&y,b=[y,r.readUByte()];for(i=0;i<_;i++)b.push(r.readUByte()),b.push(r.readUByte()),b.push(r.readUByte());a._insertSampleInOrder(a._txtTrack.samples,{type:3,pts:t.pts,bytes:b})}}else if(5===f&&0!==r.bytesAvailable){if(v=!0,p>16){var E=[];for(i=0;i<16;i++)E.push(r.readUByte().toString(16)),3!==i&&5!==i&&7!==i&&9!==i||E.push("-");var S=p-16,w=new Uint8Array(S);for(i=0;i<S;i++)w[i]=r.readUByte();a._insertSampleInOrder(a._txtTrack.samples,{pts:t.pts,payloadType:f,uuid:E.join(""),userDataBytes:w,userData:Object(m.b)(w.buffer)})}}else if(p<r.bytesAvailable)for(i=0;i<p;i++)r.readUByte()}break;case 7:if(n=!0,u=!0,!o.sps){var A=(r=new T(e.data)).readSPS();o.width=A.width,o.height=A.height,o.pixelRatio=A.pixelRatio,o.sps=[e.data],o.duration=a._duration;var C=e.data.subarray(1,4),R="avc1.";for(i=0;i<3;i++){var L=C[i].toString(16);L.length<2&&(L="0"+L),R+=L}o.codec=R}break;case 8:n=!0,o.pps||(o.pps=[e.data]);break;case 9:n=!1,o.audFound=!0,l&&d(l,o),l=a.avcSample=c(!1,t.pts,t.dts,"");break;case 12:n=!1;break;default:n=!1,l&&(l.debug+="unknown NAL "+e.type+" ")}l&&n&&l.units.push(e)})),e&&l&&(d(l,o),this.avcSample=null)},e._insertSampleInOrder=function(t,e){var r=t.length;if(r>0){if(e.pts>=t[r-1].pts)t.push(e);else for(var n=r-1;n>=0;n--)if(e.pts<t[n].pts){t.splice(n,0,e);break}}else t.push(e)},e._getLastNalUnit=function(){var t,e=this.avcSample;if(!e||0===e.units.length){var r=this._avcTrack.samples;e=r[r.length-1]}if(e){var n=e.units;t=n[n.length-1]}return t},e._parseAVCNALu=function(t){var e,r,n,i,a=0,o=t.byteLength,s=this._avcTrack,l=s.naluState||0,u=l,d=[],c=-1;for(-1===l&&(c=0,i=31&t[0],l=0,a=1);a<o;)if(e=t[a++],l)if(1!==l)if(e)if(1===e){if(c>=0)n={data:t.subarray(c,a-l-1),type:i},d.push(n);else{var h=this._getLastNalUnit();if(h&&(u&&a<=4-u&&h.state&&(h.data=h.data.subarray(0,h.data.byteLength-u)),(r=a-l-1)>0)){var f=new Uint8Array(h.data.byteLength+r);f.set(h.data,0),f.set(t.subarray(0,r),h.data.byteLength),h.data=f}}a<o?(c=a,i=31&t[a],l=0):l=-1}else l=0;else l=3;else l=e?0:2;else l=e?0:1;if(c>=0&&l>=0&&(n={data:t.subarray(c,o),type:i,state:l},d.push(n)),0===d.length){var p=this._getLastNalUnit();if(p){var v=new Uint8Array(p.data.byteLength+t.byteLength);v.set(p.data,0),v.set(t,p.data.byteLength),p.data=v}}return s.naluState=l,d},e.discardEPB=function(t){for(var e,r,n=t.byteLength,i=[],a=1;a<n-2;)0===t[a]&&0===t[a+1]&&3===t[a+2]?(i.push(a+2),a+=2):a++;if(0===i.length)return t;e=n-i.length,r=new Uint8Array(e);var o=0;for(a=0;a<e;o++,a++)o===i[0]&&(o++,i.shift()),r[a]=t[o];return r},e._parseAACPES=function(t){var e,r,a,o,l,u,d,c=this._audioTrack,f=t.data,m=t.pts,y=this.aacOverFlow,_=this.aacLastPTS;if(y){var b=new Uint8Array(y.byteLength+f.byteLength);b.set(y,0),b.set(f,y.byteLength),f=b}for(a=0,l=f.length;a<l-1&&!h(f,a);a++);if(!a||(a<l-1?(u="AAC PES did not start with ADTS header,offset:"+a,d=!1):(u="no ADTS header found in AAC PES",d=!0),s.b.warn("parsing error:"+u),this.observer.trigger(n.a.ERROR,{type:i.b.MEDIA_ERROR,details:i.a.FRAG_PARSING_ERROR,fatal:d,reason:u}),!d)){if(p(c,this.observer,f,a,this.audioCodec),r=0,e=v(c.samplerate),y&&_){var E=_+e;Math.abs(E-m)>1&&(s.b.log("AAC: align PTS for overlapping frames by "+Math.round((E-m)/90)),m=E)}for(;a<l;){if(h(f,a)){if(a+5<l){var T=g(c,f,a,m,r);if(T){a+=T.length,o=T.sample.pts,r++;continue}}break}a++}y=a<l?f.subarray(a,l):null,this.aacOverFlow=y,this.aacLastPTS=o}},e._parseMPEGPES=function(t){for(var e=t.data,r=e.length,n=0,i=0,a=t.pts;i<r;)if(E.isHeader(e,i)){var o=E.appendFrame(this._audioTrack,e,i,a,n);if(!o)break;i+=o.length,n++}else i++},e._parseID3PES=function(t){this._id3Track.samples.push(t)},t}(),C=function(){function t(t,e,r){this.observer=t,this.config=r,this.remuxer=e}var e=t.prototype;return e.resetInitSegment=function(t,e,r,n){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:!1,samples:[],len:0,manifestCodec:e,duration:n,inputTimeScale:9e4}},e.resetTimeStamp=function(){},t.probe=function(t){var e,r,n=m.a.getID3Data(t,0);if(n&&void 0!==m.a.getTimeStamp(n))for(e=n.length,r=Math.min(t.length-1,e+100);e<r;e++)if(E.probe(t,e))return s.b.log("MPEG Audio sync word found !"),!0;return!1},e.append=function(t,e,r,n){for(var i=m.a.getID3Data(t,0),a=m.a.getTimeStamp(i),o=a?90*a:9e4*e,s=i.length,l=t.length,u=0,d=0,c=this._audioTrack,h=[{pts:o,dts:o,data:i}];s<l;)if(E.isHeader(t,s)){var f=E.appendFrame(c,t,s,o,u);if(!f)break;s+=f.length,d=f.sample.pts,u++}else m.a.isHeader(t,s)?(i=m.a.getID3Data(t,s),h.push({pts:d,dts:d,data:i}),s+=i.length):s++;this.remuxer.remux(c,{samples:[]},{samples:h,inputTimeScale:9e4},{samples:[]},e,r,n)},e.destroy=function(){},t}(),R=function(){function t(){}return t.getSilentFrame=function(t,e){switch(t){case"mp4a.40.2":if(1===e)return new Uint8Array([0,200,0,128,35,128]);if(2===e)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===e)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===e)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===e)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},t}(),L=Math.pow(2,32)-1,D=function(){function t(){}return t.init=function(){var e;for(e in t.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]})t.types.hasOwnProperty(e)&&(t.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);var r=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);t.HDLR_TYPES={video:r,audio:n};var i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),a=new Uint8Array([0,0,0,0,0,0,0,0]);t.STTS=t.STSC=t.STCO=a,t.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),t.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),t.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),t.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var o=new Uint8Array([105,115,111,109]),s=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);t.FTYP=t.box(t.types.ftyp,o,l,o,s),t.DINF=t.box(t.types.dinf,t.box(t.types.dref,i))},t.box=function(t){for(var e,r=Array.prototype.slice.call(arguments,1),n=8,i=r.length,a=i;i--;)n+=r[i].byteLength;for((e=new Uint8Array(n))[0]=n>>24&255,e[1]=n>>16&255,e[2]=n>>8&255,e[3]=255&n,e.set(t,4),i=0,n=8;i<a;i++)e.set(r[i],n),n+=r[i].byteLength;return e},t.hdlr=function(e){return t.box(t.types.hdlr,t.HDLR_TYPES[e])},t.mdat=function(e){return t.box(t.types.mdat,e)},t.mdhd=function(e,r){r*=e;var n=Math.floor(r/(L+1)),i=Math.floor(r%(L+1));return t.box(t.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,n>>24,n>>16&255,n>>8&255,255&n,i>>24,i>>16&255,i>>8&255,255&i,85,196,0,0]))},t.mdia=function(e){return t.box(t.types.mdia,t.mdhd(e.timescale,e.duration),t.hdlr(e.type),t.minf(e))},t.mfhd=function(e){return t.box(t.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e]))},t.minf=function(e){return t.box(t.types.minf,"audio"===e.type?t.box(t.types.smhd,t.SMHD):t.box(t.types.vmhd,t.VMHD),t.DINF,t.stbl(e))},t.moof=function(e,r,n){return t.box(t.types.moof,t.mfhd(e),t.traf(n,r))},t.moov=function(e){for(var r=e.length,n=[];r--;)n[r]=t.trak(e[r]);return t.box.apply(null,[t.types.moov,t.mvhd(e[0].timescale,e[0].duration)].concat(n).concat(t.mvex(e)))},t.mvex=function(e){for(var r=e.length,n=[];r--;)n[r]=t.trex(e[r]);return t.box.apply(null,[t.types.mvex].concat(n))},t.mvhd=function(e,r){r*=e;var n=Math.floor(r/(L+1)),i=Math.floor(r%(L+1)),a=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,n>>24,n>>16&255,n>>8&255,255&n,i>>24,i>>16&255,i>>8&255,255&i,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return t.box(t.types.mvhd,a)},t.sdtp=function(e){var r,n,i=e.samples||[],a=new Uint8Array(4+i.length);for(n=0;n<i.length;n++)a[n+4]=(r=i[n].flags).dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return t.box(t.types.sdtp,a)},t.stbl=function(e){return t.box(t.types.stbl,t.stsd(e),t.box(t.types.stts,t.STTS),t.box(t.types.stsc,t.STSC),t.box(t.types.stsz,t.STSZ),t.box(t.types.stco,t.STCO))},t.avc1=function(e){var r,n,i,a=[],o=[];for(r=0;r<e.sps.length;r++)i=(n=e.sps[r]).byteLength,a.push(i>>>8&255),a.push(255&i),a=a.concat(Array.prototype.slice.call(n));for(r=0;r<e.pps.length;r++)i=(n=e.pps[r]).byteLength,o.push(i>>>8&255),o.push(255&i),o=o.concat(Array.prototype.slice.call(n));var s=t.box(t.types.avcC,new Uint8Array([1,a[3],a[4],a[5],255,224|e.sps.length].concat(a).concat([e.pps.length]).concat(o))),l=e.width,u=e.height,d=e.pixelRatio[0],c=e.pixelRatio[1];return t.box(t.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,255&l,u>>8&255,255&u,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s,t.box(t.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),t.box(t.types.pasp,new Uint8Array([d>>24,d>>16&255,d>>8&255,255&d,c>>24,c>>16&255,c>>8&255,255&c])))},t.esds=function(t){var e=t.config.length;return new Uint8Array([0,0,0,0,3,23+e,0,1,0,4,15+e,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([e]).concat(t.config).concat([6,1,2]))},t.mp4a=function(e){var r=e.samplerate;return t.box(t.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]),t.box(t.types.esds,t.esds(e)))},t.mp3=function(e){var r=e.samplerate;return t.box(t.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]))},t.stsd=function(e){return t.box(t.types.stsd,t.STSD,"audio"===e.type?e.isAAC||"mp3"!==e.codec?t.mp4a(e):t.mp3(e):t.avc1(e))},t.tkhd=function(e){var r=e.id,n=e.duration*e.timescale,i=e.width,a=e.height,o=Math.floor(n/(L+1)),s=Math.floor(n%(L+1));return t.box(t.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,r>>24&255,r>>16&255,r>>8&255,255&r,0,0,0,0,o>>24,o>>16&255,o>>8&255,255&o,s>>24,s>>16&255,s>>8&255,255&s,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,255&i,0,0,a>>8&255,255&a,0,0]))},t.traf=function(e,r){var n=t.sdtp(e),i=e.id,a=Math.floor(r/(L+1)),o=Math.floor(r%(L+1));return t.box(t.types.traf,t.box(t.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i])),t.box(t.types.tfdt,new Uint8Array([1,0,0,0,a>>24,a>>16&255,a>>8&255,255&a,o>>24,o>>16&255,o>>8&255,255&o])),t.trun(e,n.length+16+20+8+16+8+8),n)},t.trak=function(e){return e.duration=e.duration||4294967295,t.box(t.types.trak,t.tkhd(e),t.mdia(e))},t.trex=function(e){var r=e.id;return t.box(t.types.trex,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},t.trun=function(e,r){var n,i,a,o,s,l,u=e.samples||[],d=u.length,c=12+16*d,h=new Uint8Array(c);for(h.set([0,0,15,1,d>>>24&255,d>>>16&255,d>>>8&255,255&d,(r+=8+c)>>>24&255,r>>>16&255,r>>>8&255,255&r],0),n=0;n<d;n++)a=(i=u[n]).duration,h.set([a>>>24&255,a>>>16&255,a>>>8&255,255&a,(o=i.size)>>>24&255,o>>>16&255,o>>>8&255,255&o,(s=i.flags).isLeading<<2|s.dependsOn,s.isDependedOn<<6|s.hasRedundancy<<4|s.paddingValue<<1|s.isNonSync,61440&s.degradPrio,15&s.degradPrio,(l=i.cts)>>>24&255,l>>>16&255,l>>>8&255,255&l],12+16*n);return t.box(t.types.trun,h)},t.initSegment=function(e){t.types||t.init();var r,n=t.moov(e);return(r=new Uint8Array(t.FTYP.byteLength+n.byteLength)).set(t.FTYP),r.set(n,t.FTYP.byteLength),r},t}();function k(t,e,r,n){void 0===r&&(r=1),void 0===n&&(n=!1);var i=t*e*r;return n?Math.round(i):i}function O(t,e){return void 0===e&&(e=!1),k(t,1e3,1/9e4,e)}function N(t,e){return void 0===e&&(e=1),k(t,9e4,1/e)}var x,I=N(10),P=N(.2),M=function(){function t(t,e,r,n){this.observer=t,this.config=e,this.typeSupported=r;var i=navigator.userAgent;this.isSafari=n&&n.indexOf("Apple")>-1&&i&&!i.match("CriOS"),this.ISGenerated=!1}var e=t.prototype;return e.destroy=function(){},e.resetTimeStamp=function(t){this._initPTS=this._initDTS=t},e.resetInitSegment=function(){this.ISGenerated=!1},e.remux=function(t,e,r,i,a,o,l){if(this.ISGenerated||this.generateIS(t,e,a),this.ISGenerated){var u=t.samples.length,d=e.samples.length,c=a,h=a;if(u&&d){var f=(t.samples[0].pts-e.samples[0].pts)/e.inputTimeScale;c+=Math.max(0,f),h+=Math.max(0,-f)}if(u){t.timescale||(s.b.warn("regenerate InitSegment as audio detected"),this.generateIS(t,e,a));var p,v=this.remuxAudio(t,c,o,l);d&&(v&&(p=v.endPTS-v.startPTS),e.timescale||(s.b.warn("regenerate InitSegment as video detected"),this.generateIS(t,e,a)),this.remuxVideo(e,h,o,p,l))}else if(d){var g=this.remuxVideo(e,h,o,0,l);g&&t.codec&&this.remuxEmptyAudio(t,c,o,g)}}r.samples.length&&this.remuxID3(r,a),i.samples.length&&this.remuxText(i,a),this.observer.trigger(n.a.FRAG_PARSED)},e.generateIS=function(t,e,r){var a,o,l=this.observer,u=t.samples,d=e.samples,c=this.typeSupported,h="audio/mp4",f={},p={tracks:f},v=void 0===this._initPTS;if(v&&(a=o=1/0),t.config&&u.length&&(t.timescale=t.samplerate,s.b.log("audio sampling rate : "+t.samplerate),t.isAAC||(c.mpeg?(h="audio/mpeg",t.codec=""):c.mp3&&(t.codec="mp3")),f.audio={container:h,codec:t.codec,initSegment:!t.isAAC&&c.mpeg?new Uint8Array:D.initSegment([t]),metadata:{channelCount:t.channelCount}},v&&(a=o=u[0].pts-t.inputTimeScale*r)),e.sps&&e.pps&&d.length){var g=e.inputTimeScale;e.timescale=g,f.video={container:"video/mp4",codec:e.codec,initSegment:D.initSegment([e]),metadata:{width:e.width,height:e.height}},v&&(a=Math.min(a,d[0].pts-g*r),o=Math.min(o,d[0].dts-g*r),this.observer.trigger(n.a.INIT_PTS_FOUND,{initPTS:a}))}Object.keys(f).length?(l.trigger(n.a.FRAG_PARSING_INIT_SEGMENT,p),this.ISGenerated=!0,v&&(this._initPTS=a,this._initDTS=o)):l.trigger(n.a.ERROR,{type:i.b.MEDIA_ERROR,details:i.a.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})},e.remuxVideo=function(t,e,r,a,o){var l,u,d,c,h,f,p,v=8,g=t.timescale,m=t.samples,y=[],_=m.length,b=this._PTSNormalize,E=this._initPTS,T=this.nextAvcDts,S=this.isSafari;if(0!==_){S&&(r|=m.length&&T&&(o&&Math.abs(e-T/g)<.1||Math.abs(m[0].pts-T-E)<g/5)),r||(T=e*g),m.forEach((function(t){t.pts=b(t.pts-E,T),t.dts=b(t.dts-E,T)})),m.sort((function(t,e){return t.dts-e.dts||t.pts-e.pts||t.id-e.id}));var w=m.reduce((function(t,e){return Math.max(Math.min(t,e.pts-e.dts),-1*P)}),0);if(w<0){s.b.warn("PTS < DTS detected in video samples, shifting DTS by "+O(w,!0)+" ms to overcome this issue");for(var A=0;A<m.length;A++)m[A].dts+=w}var C=m[0];h=Math.max(C.dts,0),c=Math.max(C.pts,0);var R=h-T;r&&R&&(R>1?s.b.log("AVC: "+O(R,!0)+" ms hole between fragments detected,filling it"):R<-1&&s.b.log("AVC: "+O(-R,!0)+" ms overlapping between fragments detected"),m[0].dts=h=T,c=Math.max(c-R,T),m[0].pts=c,s.b.log("Video: PTS/DTS adjusted: "+O(c,!0)+"/"+O(h,!0)+", delta: "+O(R,!0)+" ms")),C=m[m.length-1],p=Math.max(C.dts,0),f=Math.max(C.pts,0,p),S&&(l=Math.round((p-h)/(m.length-1)));for(var L=0,k=0,N=0;N<_;N++){for(var x=m[N],I=x.units,M=I.length,F=0,U=0;U<M;U++)F+=I[U].data.length;k+=F,L+=M,x.length=F,x.dts=S?h+N*l:Math.max(x.dts,h),x.pts=Math.max(x.pts,x.dts)}var B=k+4*L+8;try{u=new Uint8Array(B)}catch(t){return void this.observer.trigger(n.a.ERROR,{type:i.b.MUX_ERROR,details:i.a.REMUX_ALLOC_ERROR,fatal:!1,bytes:B,reason:"fail allocating video mdat "+B})}var j=new DataView(u.buffer);j.setUint32(0,B),u.set(D.types.mdat,4);for(var G=0;G<_;G++){for(var H=m[G],K=H.units,V=0,W=void 0,q=0,Y=K.length;q<Y;q++){var z=K[q],X=z.data,$=z.data.byteLength;j.setUint32(v,$),u.set(X,v+=4),v+=$,V+=4+$}if(S)W=Math.max(0,l*Math.round((H.pts-H.dts)/l));else{if(G<_-1)l=m[G+1].dts-H.dts;else{var J=this.config,Z=H.dts-m[G>0?G-1:G].dts;if(J.stretchShortVideoTrack){var Q=Math.floor(J.maxBufferHole*g),tt=(a?c+a*g:this.nextAudioPts)-H.pts;tt>Q?((l=tt-Z)<0&&(l=Z),s.b.log("It is approximately "+O(tt,!1)+" ms to the next segment; using duration "+O(l,!1)+" ms for the last video frame.")):l=Z}else l=Z}W=Math.round(H.pts-H.dts)}y.push({size:V,duration:l,cts:W,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:H.key?2:1,isNonSync:H.key?0:1}})}this.nextAvcDts=p+l;var et=t.dropped;if(t.nbNalu=0,t.dropped=0,y.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var rt=y[0].flags;rt.dependsOn=2,rt.isNonSync=0}t.samples=y,d=D.moof(t.sequenceNumber++,h,t),t.samples=[];var nt={data1:d,data2:u,startPTS:c/g,endPTS:(f+l)/g,startDTS:h/g,endDTS:this.nextAvcDts/g,type:"video",hasAudio:!1,hasVideo:!0,nb:y.length,dropped:et};return this.observer.trigger(n.a.FRAG_PARSING_DATA,nt),nt}},e.remuxAudio=function(t,e,r,a){var o,l,u,d,c,h,f=t.inputTimeScale,p=f/t.timescale,v=(t.isAAC?1024:1152)*p,g=this._PTSNormalize,m=this._initPTS,y=!t.isAAC&&this.typeSupported.mpeg,_=y?0:8,b=t.samples,E=[],T=this.nextAudioPts;if(r|=b.length&&T&&(a&&Math.abs(e-T/f)<.1||Math.abs(b[0].pts-T-m)<20*v),b.forEach((function(t){t.pts=t.dts=g(t.pts-m,e*f)})),0!==(b=b.filter((function(t){return t.pts>=0}))).length){if(r||(T=a?e*f:b[0].pts),t.isAAC)for(var S=this.config.maxAudioFramesDrift,w=0,A=T;w<b.length;){var C,L=b[w];if((C=L.pts-A)<=-S*v)s.b.warn("Dropping 1 audio frame @ "+O(A,!0)+" ms due to "+O(C,!0)+" ms overlap."),b.splice(w,1);else if(C>=S*v&&C<I&&A){var k=Math.round(C/v);s.b.warn("Injecting "+k+" audio frames @ "+O(A,!0)+" ms due to "+O(A,!0)+" ms gap.");for(var N=0;N<k;N++){var x=Math.max(A,0);(l=R.getSilentFrame(t.manifestCodec||t.codec,t.channelCount))||(s.b.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),l=L.unit.subarray()),b.splice(w,0,{unit:l,pts:x,dts:x}),A+=v,w++}L.pts=L.dts=A,A+=v,w++}else Math.abs(C),L.pts=L.dts=A,A+=v,w++}for(var P=b.length,M=0;P--;)M+=b[P].unit.byteLength;for(var F=0,U=b.length;F<U;F++){var B=b[F],j=B.unit,G=B.pts;if(void 0!==h)o.duration=Math.round((G-h)/p);else{var H=G-T,K=0;if(r&&t.isAAC&&H){if(H>0&&H<I)K=Math.round((G-T)/v),s.b.log(O(H,!0)+" ms hole between AAC samples detected,filling it"),K>0&&((l=R.getSilentFrame(t.manifestCodec||t.codec,t.channelCount))||(l=j.subarray()),M+=K*l.length);else if(H<-12){s.b.log("drop overlapping AAC sample, expected/parsed/delta: "+O(T,!0)+" ms / "+O(G,!0)+" ms / "+O(-H,!0)+" ms"),M-=j.byteLength;continue}G=T}if(c=G,!(M>0))return;M+=_;try{u=new Uint8Array(M)}catch(t){return void this.observer.trigger(n.a.ERROR,{type:i.b.MUX_ERROR,details:i.a.REMUX_ALLOC_ERROR,fatal:!1,bytes:M,reason:"fail allocating audio mdat "+M})}y||(new DataView(u.buffer).setUint32(0,M),u.set(D.types.mdat,4));for(var V=0;V<K;V++)(l=R.getSilentFrame(t.manifestCodec||t.codec,t.channelCount))||(s.b.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),l=j.subarray()),u.set(l,_),_+=l.byteLength,E.push(o={size:l.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}})}u.set(j,_);var W=j.byteLength;_+=W,E.push(o={size:W,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}}),h=G}var q=0;if((P=E.length)>=2&&(o.duration=q=E[P-2].duration),P){this.nextAudioPts=T=h+p*q,t.samples=E,d=y?new Uint8Array:D.moof(t.sequenceNumber++,c/p,t),t.samples=[];var Y=c/f,z=T/f,X={data1:d,data2:u,startPTS:Y,endPTS:z,startDTS:Y,endDTS:z,type:"audio",hasAudio:!0,hasVideo:!1,nb:P};return this.observer.trigger(n.a.FRAG_PARSING_DATA,X),X}return null}},e.remuxEmptyAudio=function(t,e,r,n){var i=t.inputTimeScale,a=this.nextAudioPts,o=(void 0!==a?a:n.startDTS*i)+this._initDTS,l=i/(t.samplerate?t.samplerate:i)*1024,u=Math.ceil((n.endDTS*i+this._initDTS-o)/l),d=R.getSilentFrame(t.manifestCodec||t.codec,t.channelCount);if(s.b.warn("remux empty Audio"),d){for(var c=[],h=0;h<u;h++){var f=o+h*l;c.push({unit:d,pts:f,dts:f})}t.samples=c,this.remuxAudio(t,e,r)}else s.b.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!")},e.remuxID3=function(t){var e,r=t.samples.length,i=t.inputTimeScale,a=this._initPTS,o=this._initDTS;if(r){for(var s=0;s<r;s++)(e=t.samples[s]).pts=(e.pts-a)/i,e.dts=(e.dts-o)/i;this.observer.trigger(n.a.FRAG_PARSING_METADATA,{samples:t.samples})}t.samples=[]},e.remuxText=function(t){t.samples.sort((function(t,e){return t.pts-e.pts}));var e,r=t.samples.length,i=t.inputTimeScale,a=this._initPTS;if(r){for(var o=0;o<r;o++)(e=t.samples[o]).pts=(e.pts-a)/i;this.observer.trigger(n.a.FRAG_PARSING_USERDATA,{samples:t.samples})}t.samples=[]},e._PTSNormalize=function(t,e){var r;if(void 0===e)return t;for(r=e<t?-8589934592:8589934592;Math.abs(t-e)>4294967296;)t+=r;return t},t}(),F=function(){function t(t){this.observer=t}var e=t.prototype;return e.destroy=function(){},e.resetTimeStamp=function(){},e.resetInitSegment=function(){},e.remux=function(t,e,r,i,a,o,s,l){var u=this.observer,d="";t&&(d+="audio"),e&&(d+="video"),u.trigger(n.a.FRAG_PARSING_DATA,{data1:l,startPTS:a,startDTS:a,type:d,hasAudio:!!t,hasVideo:!!e,nb:1,dropped:0}),u.trigger(n.a.FRAG_PARSED)},t}(),U=Object(l.a)();try{x=U.performance.now.bind(U.performance)}catch(t){s.b.debug("Unable to use Performance API on this environment"),x=U.Date.now}var B=function(){function t(t,e,r,n){this.observer=t,this.typeSupported=e,this.config=r,this.vendor=n}var e=t.prototype;return e.destroy=function(){var t=this.demuxer;t&&t.destroy()},e.push=function(t,e,r,i,o,s,l,u,d,c,h,f){var p=this;if(t.byteLength>0&&null!=e&&null!=e.key&&"AES-128"===e.method){var v=this.decrypter;null==v&&(v=this.decrypter=new a.a(this.observer,this.config));var g=x();v.decrypt(t,e.key.buffer,e.iv.buffer,(function(t){var a=x();p.observer.trigger(n.a.FRAG_DECRYPTED,{stats:{tstart:g,tdecrypt:a}}),p.pushDecrypted(new Uint8Array(t),e,new Uint8Array(r),i,o,s,l,u,d,c,h,f)}))}else this.pushDecrypted(new Uint8Array(t),e,new Uint8Array(r),i,o,s,l,u,d,c,h,f)},e.pushDecrypted=function(t,e,r,a,o,s,l,u,d,c,h,f){var p=this.demuxer;if(!p||(l||u)&&!this.probe(t)){for(var v=this.observer,g=this.typeSupported,m=this.config,b=[{demux:A,remux:M},{demux:_.a,remux:F},{demux:y,remux:M},{demux:C,remux:M}],E=0,T=b.length;E<T;E++){var S=b[E],w=S.demux.probe;if(w(t)){var R=this.remuxer=new S.remux(v,m,g,this.vendor);p=new S.demux(v,R,m,g),this.probe=w;break}}if(!p)return void v.trigger(n.a.ERROR,{type:i.b.MEDIA_ERROR,details:i.a.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});this.demuxer=p}var L=this.remuxer;(l||u)&&(p.resetInitSegment(r,a,o,c),L.resetInitSegment()),l&&(p.resetTimeStamp(f),L.resetTimeStamp(f)),"function"==typeof p.setDecryptData&&p.setDecryptData(e),p.append(t,s,d,h)},t}();e.a=B},function(t,e,r){"use strict";var n=r(0),i=r(1),a=Math.pow(2,32)-1,o=function(){function t(t,e){this.observer=t,this.remuxer=e}var e=t.prototype;return e.resetTimeStamp=function(t){this.initPTS=t},e.resetInitSegment=function(e,r,n,a){if(e&&e.byteLength){var o=this.initData=t.parseInitSegment(e);null==r&&(r="mp4a.40.5"),null==n&&(n="avc1.42e01e");var s={};o.audio&&o.video?s.audiovideo={container:"video/mp4",codec:r+","+n,initSegment:a?e:null}:(o.audio&&(s.audio={container:"audio/mp4",codec:r,initSegment:a?e:null}),o.video&&(s.video={container:"video/mp4",codec:n,initSegment:a?e:null})),this.observer.trigger(i.a.FRAG_PARSING_INIT_SEGMENT,{tracks:s})}else r&&(this.audioCodec=r),n&&(this.videoCodec=n)},t.probe=function(e){return t.findBox({data:e,start:0,end:Math.min(e.length,16384)},["moof"]).length>0},t.bin2str=function(t){return String.fromCharCode.apply(null,t)},t.readUint16=function(t,e){t.data&&(e+=t.start,t=t.data);var r=t[e]<<8|t[e+1];return r<0?65536+r:r},t.readUint32=function(t,e){t.data&&(e+=t.start,t=t.data);var r=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3];return r<0?4294967296+r:r},t.writeUint32=function(t,e,r){t.data&&(e+=t.start,t=t.data),t[e]=r>>24,t[e+1]=r>>16&255,t[e+2]=r>>8&255,t[e+3]=255&r},t.findBox=function(e,r){var n,i,a,o,s,l,u=[];if(e.data?(s=e.start,a=e.end,e=e.data):(s=0,a=e.byteLength),!r.length)return null;for(n=s;n<a;)l=(i=t.readUint32(e,n))>1?n+i:a,t.bin2str(e.subarray(n+4,n+8))===r[0]&&(1===r.length?u.push({data:e,start:n+8,end:l}):(o=t.findBox({data:e,start:n+8,end:l},r.slice(1))).length&&(u=u.concat(o))),n=l;return u},t.parseSegmentIndex=function(e){var r,n=t.findBox(e,["moov"])[0],i=n?n.end:null,a=0,o=t.findBox(e,["sidx"]);if(!o||!o[0])return null;r=[];var s=(o=o[0]).data[0],l=t.readUint32(o,a=0===s?8:16);a+=4,a+=0===s?8:16;var u=o.end+0,d=t.readUint16(o,a+=2);a+=2;for(var c=0;c<d;c++){var h=a,f=t.readUint32(o,h);h+=4;var p=2147483647&f;if(1==(2147483648&f)>>>31)return void console.warn("SIDX has hierarchical references (not supported)");var v=t.readUint32(o,h);h+=4,r.push({referenceSize:p,subsegmentDuration:v,info:{duration:v/l,start:u,end:u+p-1}}),u+=p,a=h+=4}return{earliestPresentationTime:0,timescale:l,version:s,referencesCount:d,references:r,moovEndOffset:i}},t.parseInitSegment=function(e){var r=[];return t.findBox(e,["moov","trak"]).forEach((function(e){var i=t.findBox(e,["tkhd"])[0];if(i){var a=i.data[i.start],o=0===a?12:20,s=t.readUint32(i,o),l=t.findBox(e,["mdia","mdhd"])[0];if(l){o=0===(a=l.data[l.start])?12:20;var u=t.readUint32(l,o),d=t.findBox(e,["mdia","hdlr"])[0];if(d){var c={soun:"audio",vide:"video"}[t.bin2str(d.data.subarray(d.start+8,d.start+12))];if(c){var h=t.findBox(e,["mdia","minf","stbl","stsd"]);if(h.length){var f=t.bin2str((h=h[0]).data.subarray(h.start+12,h.start+16));n.b.log("MP4Demuxer:"+c+":"+f+" found")}r[s]={timescale:u,type:c},r[c]={timescale:u,id:s}}}}}})),r},t.getStartDTS=function(e,r){var n,i,a;return n=t.findBox(r,["moof","traf"]),i=[].concat.apply([],n.map((function(r){return t.findBox(r,["tfhd"]).map((function(n){var i,a;return i=t.readUint32(n,4),a=e[i].timescale||9e4,t.findBox(r,["tfdt"]).map((function(e){var r,n;return r=e.data[e.start],n=t.readUint32(e,4),1===r&&(n*=Math.pow(2,32),n+=t.readUint32(e,8)),n}))[0]/a}))}))),a=Math.min.apply(null,i),isFinite(a)?a:0},t.offsetStartDTS=function(e,r,n){t.findBox(r,["moof","traf"]).map((function(r){return t.findBox(r,["tfhd"]).map((function(i){var o=t.readUint32(i,4),s=e[o].timescale||9e4;t.findBox(r,["tfdt"]).map((function(e){var r=e.data[e.start],i=t.readUint32(e,4);if(0===r)t.writeUint32(e,4,i-n*s);else{i*=Math.pow(2,32),i+=t.readUint32(e,8),i-=n*s,i=Math.max(i,0);var o=Math.floor(i/(a+1)),l=Math.floor(i%(a+1));t.writeUint32(e,4,o),t.writeUint32(e,8,l)}}))}))}))},e.append=function(e,r,n,a){var o=this.initData;o||(this.resetInitSegment(e,this.audioCodec,this.videoCodec,!1),o=this.initData);var s,l=this.initPTS;if(void 0===l){var u=t.getStartDTS(o,e);this.initPTS=l=u-r,this.observer.trigger(i.a.INIT_PTS_FOUND,{initPTS:l})}t.offsetStartDTS(o,e,l),s=t.getStartDTS(o,e),this.remuxer.remux(o.audio,o.video,null,null,s,n,a,e)},e.destroy=function(){},t}();e.a=o},function(t,e,r){function n(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=e,r.i=function(t){return t},r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},r.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/",r.oe=function(t){throw console.error(t),t};var n=r(r.s=ENTRY_MODULE);return n.default||n}var i="\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)";function a(t){return(t+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function o(t,e,n){var o={};o[n]=[];var s=e.toString(),l=s.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!l)return o;for(var u,d=l[1],c=new RegExp("(\\\\n|\\W)"+a(d)+i,"g");u=c.exec(s);)"dll-reference"!==u[3]&&o[n].push(u[3]);for(c=new RegExp("\\("+a(d)+'\\("(dll-reference\\s([\\.|\\-|\\+|\\w|/|@]+))"\\)\\)'+i,"g");u=c.exec(s);)t[u[2]]||(o[n].push(u[1]),t[u[2]]=r(u[1]).m),o[u[2]]=o[u[2]]||[],o[u[2]].push(u[4]);for(var h=Object.keys(o),f=0;f<h.length;f++)for(var p=0;p<o[h[f]].length;p++)isNaN(1*o[h[f]][p])||(o[h[f]][p]=1*o[h[f]][p]);return o}function s(t){return Object.keys(t).reduce((function(e,r){return e||t[r].length>0}),!1)}t.exports=function(t,e){var i={main:r.m},a=(e=e||{}).all?{main:Object.keys(i.main)}:function(t,e){for(var r={main:[e]},n={main:[]},i={main:{}};s(r);)for(var a=Object.keys(r),l=0;l<a.length;l++){var u=a[l],d=r[u].pop();if(i[u]=i[u]||{},!i[u][d]&&t[u][d]){i[u][d]=!0,n[u]=n[u]||[],n[u].push(d);for(var c=o(t,t[u][d],u),h=Object.keys(c),f=0;f<h.length;f++)r[h[f]]=r[h[f]]||[],r[h[f]]=r[h[f]].concat(c[h[f]])}}return n}(i,t),l="";Object.keys(a).filter((function(t){return"main"!==t})).forEach((function(t){for(var e=0;a[t][e];)e++;a[t].push(e),i[t][e]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",l=l+"var "+t+" = ("+n.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+a[t].map((function(e){return JSON.stringify(e)+": "+i[t][e].toString()})).join(",")+"});\n"})),l=l+"new (("+n.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+a.main.map((function(t){return JSON.stringify(t)+": "+i.main[t].toString()})).join(",")+"}))(self);";var u=new window.Blob([l],{type:"text/javascript"});if(e.bare)return u;var d=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(u),c=new window.Worker(d);return c.objectURL=d,c}},function(t,e,r){"use strict";r.r(e);var n=r(9),i=r(1),a=r(0),o=r(8);e.default=function(t){var e=new o.EventEmitter;e.trigger=function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];e.emit.apply(e,[t,t].concat(n))},e.off=function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];e.removeListener.apply(e,[t].concat(n))};var r=function(e,r){t.postMessage({event:e,data:r})};t.addEventListener("message",(function(i){var o=i.data;switch(o.cmd){case"init":var s=JSON.parse(o.config);t.demuxer=new n.a(e,o.typeSupported,s,o.vendor),Object(a.a)(s.debug),r("init",null);break;case"demux":t.demuxer.push(o.data,o.decryptdata,o.initSegment,o.audioCodec,o.videoCodec,o.timeOffset,o.discontinuity,o.trackSwitch,o.contiguous,o.duration,o.accurateTimeOffset,o.defaultInitPTS)}})),e.on(i.a.FRAG_DECRYPTED,r),e.on(i.a.FRAG_PARSING_INIT_SEGMENT,r),e.on(i.a.FRAG_PARSED,r),e.on(i.a.ERROR,r),e.on(i.a.FRAG_PARSING_METADATA,r),e.on(i.a.FRAG_PARSING_USERDATA,r),e.on(i.a.INIT_PTS_FOUND,r),e.on(i.a.FRAG_PARSING_DATA,(function(e,r){var n=[],i={event:e,data:r};r.data1&&(i.data1=r.data1.buffer,n.push(r.data1.buffer),delete r.data1),r.data2&&(i.data2=r.data2.buffer,n.push(r.data2.buffer),delete r.data2),t.postMessage(i,n)}))}},function(t,e,r){"use strict";r.r(e);var n={};r.r(n),r.d(n,"newCue",(function(){return oe}));var i,a,o=r(6),s=r(2),l=r(3),u=r(1),d=r(0),c={hlsEventGeneric:!0,hlsHandlerDestroying:!0,hlsHandlerDestroyed:!0},h=function(){function t(t){this.hls=void 0,this.handledEvents=void 0,this.useGenericHandler=void 0,this.hls=t,this.onEvent=this.onEvent.bind(this);for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];this.handledEvents=r,this.useGenericHandler=!0,this.registerListeners()}var e=t.prototype;return e.destroy=function(){this.onHandlerDestroying(),this.unregisterListeners(),this.onHandlerDestroyed()},e.onHandlerDestroying=function(){},e.onHandlerDestroyed=function(){},e.isEventHandler=function(){return"object"==typeof this.handledEvents&&this.handledEvents.length&&"function"==typeof this.onEvent},e.registerListeners=function(){this.isEventHandler()&&this.handledEvents.forEach((function(t){if(c[t])throw new Error("Forbidden event-name: "+t);this.hls.on(t,this.onEvent)}),this)},e.unregisterListeners=function(){this.isEventHandler()&&this.handledEvents.forEach((function(t){this.hls.off(t,this.onEvent)}),this)},e.onEvent=function(t,e){this.onEventGeneric(t,e)},e.onEventGeneric=function(t,e){try{(function(t,e){var r="on"+t.replace("hls","");if("function"!=typeof this[r])throw new Error("Event "+t+" has no generic handler in this "+this.constructor.name+" class (tried "+r+")");return this[r].bind(this,e)}).call(this,t,e).call()}catch(e){d.b.error("An internal error happened while handling event "+t+'. Error message: "'+e.message+'". Here is a stacktrace:',e),this.hls.trigger(u.a.ERROR,{type:s.b.OTHER_ERROR,details:s.a.INTERNAL_EXCEPTION,fatal:!1,event:t,err:e})}},t}();!function(t){t.MANIFEST="manifest",t.LEVEL="level",t.AUDIO_TRACK="audioTrack",t.SUBTITLE_TRACK="subtitleTrack"}(i||(i={})),function(t){t.MAIN="main",t.AUDIO="audio",t.SUBTITLE="subtitle"}(a||(a={}));var f,p=r(10),v=function(){function t(t,e){this._uri=null,this.baseuri=void 0,this.reluri=void 0,this.method=null,this.key=null,this.iv=null,this.baseuri=t,this.reluri=e}var e;return(e=[{key:"uri",get:function(){return!this._uri&&this.reluri&&(this._uri=Object(o.buildAbsoluteURL)(this.baseuri,this.reluri,{alwaysNormalize:!0})),this._uri}}])&&function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(t.prototype,e),t}();!function(t){t.AUDIO="audio",t.VIDEO="video"}(f||(f={}));var g=function(){function t(){var t;this._url=null,this._byteRange=null,this._decryptdata=null,this._elementaryStreams=((t={})[f.AUDIO]=!1,t[f.VIDEO]=!1,t),this.deltaPTS=0,this.rawProgramDateTime=null,this.programDateTime=null,this.title=null,this.tagList=[],this.cc=void 0,this.type=void 0,this.relurl=void 0,this.baseurl=void 0,this.duration=void 0,this.start=void 0,this.sn=0,this.urlId=0,this.level=0,this.levelkey=void 0,this.loader=void 0}var e,r=t.prototype;return r.setByteRange=function(t,e){var r=t.split("@",2),n=[];n[0]=1===r.length?e?e.byteRangeEndOffset:0:parseInt(r[1]),n[1]=parseInt(r[0])+n[0],this._byteRange=n},r.addElementaryStream=function(t){this._elementaryStreams[t]=!0},r.hasElementaryStream=function(t){return!0===this._elementaryStreams[t]},r.createInitializationVector=function(t){for(var e=new Uint8Array(16),r=12;r<16;r++)e[r]=t>>8*(15-r)&255;return e},r.setDecryptDataFromLevelKey=function(t,e){var r=t;return t&&t.method&&t.uri&&!t.iv&&((r=new v(t.baseuri,t.reluri)).method=t.method,r.iv=this.createInitializationVector(e)),r},(e=[{key:"url",get:function(){return!this._url&&this.relurl&&(this._url=Object(o.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},set:function(t){this._url=t}},{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"decryptdata",get:function(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var t=this.sn;"number"!=typeof t&&(this.levelkey&&"AES-128"===this.levelkey.method&&!this.levelkey.iv&&d.b.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),t=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,t)}return this._decryptdata}},{key:"endProgramDateTime",get:function(){if(null===this.programDateTime)return null;if(!Object(l.a)(this.programDateTime))return null;var t=Object(l.a)(this.duration)?this.duration:0;return this.programDateTime+1e3*t}},{key:"encrypted",get:function(){return!(!this.decryptdata||null===this.decryptdata.uri||null!==this.decryptdata.key)}}])&&function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(t.prototype,e),t}(),m=function(){function t(t){this.endCC=0,this.endSN=0,this.fragments=[],this.initSegment=null,this.live=!0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=t,this.version=null}var e;return(e=[{key:"hasProgramDateTime",get:function(){return!(!this.fragments[0]||!Object(l.a)(this.fragments[0].programDateTime))}}])&&function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(t.prototype,e),t}(),y=/^(\d+)x(\d+)$/,_=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,b=function(){function t(e){for(var r in"string"==typeof e&&(e=t.parseAttrList(e)),e)e.hasOwnProperty(r)&&(this[r]=e[r])}var e=t.prototype;return e.decimalInteger=function(t){var e=parseInt(this[t],10);return e>Number.MAX_SAFE_INTEGER?1/0:e},e.hexadecimalInteger=function(t){if(this[t]){var e=(this[t]||"0x").slice(2);e=(1&e.length?"0":"")+e;for(var r=new Uint8Array(e.length/2),n=0;n<e.length/2;n++)r[n]=parseInt(e.slice(2*n,2*n+2),16);return r}return null},e.hexadecimalIntegerAsNumber=function(t){var e=parseInt(this[t],16);return e>Number.MAX_SAFE_INTEGER?1/0:e},e.decimalFloatingPoint=function(t){return parseFloat(this[t])},e.enumeratedString=function(t){return this[t]},e.decimalResolution=function(t){var e=y.exec(this[t]);if(null!==e)return{width:parseInt(e[1],10),height:parseInt(e[2],10)}},t.parseAttrList=function(t){var e,r={};for(_.lastIndex=0;null!==(e=_.exec(t));){var n=e[2];0===n.indexOf('"')&&n.lastIndexOf('"')===n.length-1&&(n=n.slice(1,-1)),r[e[1]]=n}return r},t}(),E={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0}};function T(t,e){return MediaSource.isTypeSupported((e||"video")+'/mp4;codecs="'+t+'"')}var S=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g,w=/#EXT-X-MEDIA:(.*)/g,A=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)([\S+ ?]+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),C=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)([^:]*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,R=/\.(mp4|m4s|m4v|m4a)$/i,L=function(){function t(){}return t.findGroup=function(t,e){for(var r=0;r<t.length;r++){var n=t[r];if(n.id===e)return n}},t.convertAVC1ToAVCOTI=function(t){var e,r=t.split(".");return r.length>2?(e=r.shift()+".",e+=parseInt(r.shift()).toString(16),e+=("000"+parseInt(r.shift()).toString(16)).substr(-4)):e=t,e},t.resolve=function(t,e){return o.buildAbsoluteURL(e,t,{alwaysNormalize:!0})},t.parseMasterPlaylist=function(e,r){var n,i=[];function a(t,e){["video","audio"].forEach((function(r){var n=t.filter((function(t){return function(t,e){var r=E[e];return!!r&&!0===r[t.slice(0,4)]}(t,r)}));if(n.length){var i=n.filter((function(t){return 0===t.lastIndexOf("avc1",0)||0===t.lastIndexOf("mp4a",0)}));e[r+"Codec"]=i.length>0?i[0]:n[0],t=t.filter((function(t){return-1===n.indexOf(t)}))}})),e.unknownCodecs=t}for(S.lastIndex=0;null!=(n=S.exec(e));){var o={},s=o.attrs=new b(n[1]);o.url=t.resolve(n[2],r);var l=s.decimalResolution("RESOLUTION");l&&(o.width=l.width,o.height=l.height),o.bitrate=s.decimalInteger("AVERAGE-BANDWIDTH")||s.decimalInteger("BANDWIDTH"),o.name=s.NAME,a([].concat((s.CODECS||"").split(/[ ,]+/)),o),o.videoCodec&&-1!==o.videoCodec.indexOf("avc1")&&(o.videoCodec=t.convertAVC1ToAVCOTI(o.videoCodec)),i.push(o)}return i},t.parseMasterPlaylistMedia=function(e,r,n,i){var a;void 0===i&&(i=[]);var o=[],s=0;for(w.lastIndex=0;null!==(a=w.exec(e));){var l=new b(a[1]);if(l.TYPE===n){var u={id:s++,groupId:l["GROUP-ID"],name:l.NAME||l.LANGUAGE,type:n,default:"YES"===l.DEFAULT,autoselect:"YES"===l.AUTOSELECT,forced:"YES"===l.FORCED,lang:l.LANGUAGE};if(l.URI&&(u.url=t.resolve(l.URI,r)),i.length){var d=t.findGroup(i,u.groupId);u.audioCodec=d?d.codec:i[0].codec}o.push(u)}}return o},t.parseLevelPlaylist=function(t,e,r,n,i){var a,o,s,u=0,c=0,h=new m(e),f=0,p=null,y=new g,_=null;for(A.lastIndex=0;null!==(a=A.exec(t));){var E=a[1];if(E){y.duration=parseFloat(E);var T=(" "+a[2]).slice(1);y.title=T||null,y.tagList.push(T?["INF",E,T]:["INF",E])}else if(a[3]){if(Object(l.a)(y.duration)){var S=u++;y.type=n,y.start=c,s&&(y.levelkey=s),y.sn=S,y.level=r,y.cc=f,y.urlId=i,y.baseurl=e,y.relurl=(" "+a[3]).slice(1),D(y,p),h.fragments.push(y),p=y,c+=y.duration,y=new g}}else if(a[4]){var w=(" "+a[4]).slice(1);p?y.setByteRange(w,p):y.setByteRange(w)}else if(a[5])y.rawProgramDateTime=(" "+a[5]).slice(1),y.tagList.push(["PROGRAM-DATE-TIME",y.rawProgramDateTime]),null===_&&(_=h.fragments.length);else{if(!(a=a[0].match(C))){d.b.warn("No matches on slow regex match for level playlist!");continue}for(o=1;o<a.length&&void 0===a[o];o++);var L=(" "+a[o+1]).slice(1),k=(" "+a[o+2]).slice(1);switch(a[o]){case"#":y.tagList.push(k?[L,k]:[L]);break;case"PLAYLIST-TYPE":h.type=L.toUpperCase();break;case"MEDIA-SEQUENCE":u=h.startSN=parseInt(L);break;case"TARGETDURATION":h.targetduration=parseFloat(L);break;case"VERSION":h.version=parseInt(L);break;case"EXTM3U":break;case"ENDLIST":h.live=!1;break;case"DIS":f++,y.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":f=parseInt(L);break;case"KEY":var O=new b(L),N=O.enumeratedString("METHOD"),x=O.URI,I=O.hexadecimalInteger("IV");N&&(s=new v(e,x),x&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(N)>=0&&(s.method=N,s.key=null,s.iv=I));break;case"START":var P=new b(L).decimalFloatingPoint("TIME-OFFSET");Object(l.a)(P)&&(h.startTimeOffset=P);break;case"MAP":var M=new b(L);y.relurl=M.URI,M.BYTERANGE&&y.setByteRange(M.BYTERANGE),y.baseurl=e,y.level=r,y.type=n,y.sn="initSegment",h.initSegment=y,(y=new g).rawProgramDateTime=h.initSegment.rawProgramDateTime;break;default:d.b.warn("line parsed but not handled: "+a)}}}return(y=p)&&!y.relurl&&(h.fragments.pop(),c-=y.duration),h.totalduration=c,h.averagetargetduration=c/h.fragments.length,h.endSN=u-1,h.startCC=h.fragments[0]?h.fragments[0].cc:0,h.endCC=f,!h.initSegment&&h.fragments.length&&h.fragments.every((function(t){return R.test(t.relurl)}))&&(d.b.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),(y=new g).relurl=h.fragments[0].relurl,y.baseurl=e,y.level=r,y.type=n,y.sn="initSegment",h.initSegment=y,h.needSidxRanges=!0),_&&function(t,e){for(var r=t[e],n=e-1;n>=0;n--){var i=t[n];i.programDateTime=r.programDateTime-1e3*i.duration,r=i}}(h.fragments,_),h},t}();function D(t,e){t.rawProgramDateTime?t.programDateTime=Date.parse(t.rawProgramDateTime):e&&e.programDateTime&&(t.programDateTime=e.endProgramDateTime),Object(l.a)(t.programDateTime)||(t.programDateTime=null,t.rawProgramDateTime=null)}var k=window.performance,O=function(t){var e,r;function n(e){var r;return(r=t.call(this,e,u.a.MANIFEST_LOADING,u.a.LEVEL_LOADING,u.a.AUDIO_TRACK_LOADING,u.a.SUBTITLE_TRACK_LOADING)||this).loaders={},r}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r,n.canHaveQualityLevels=function(t){return t!==i.AUDIO_TRACK&&t!==i.SUBTITLE_TRACK},n.mapContextToLevelType=function(t){switch(t.type){case i.AUDIO_TRACK:return a.AUDIO;case i.SUBTITLE_TRACK:return a.SUBTITLE;default:return a.MAIN}},n.getResponseUrl=function(t,e){var r=t.url;return void 0!==r&&0!==r.indexOf("data:")||(r=e.url),r};var o=n.prototype;return o.createInternalLoader=function(t){var e=this.hls.config,r=new(e.pLoader||e.loader)(e);return t.loader=r,this.loaders[t.type]=r,r},o.getInternalLoader=function(t){return this.loaders[t.type]},o.resetInternalLoader=function(t){this.loaders[t]&&delete this.loaders[t]},o.destroyInternalLoaders=function(){for(var t in this.loaders){var e=this.loaders[t];e&&e.destroy(),this.resetInternalLoader(t)}},o.destroy=function(){this.destroyInternalLoaders(),t.prototype.destroy.call(this)},o.onManifestLoading=function(t){this.load({url:t.url,type:i.MANIFEST,level:0,id:null,responseType:"text"})},o.onLevelLoading=function(t){this.load({url:t.url,type:i.LEVEL,level:t.level,id:t.id,responseType:"text"})},o.onAudioTrackLoading=function(t){this.load({url:t.url,type:i.AUDIO_TRACK,level:null,id:t.id,responseType:"text"})},o.onSubtitleTrackLoading=function(t){this.load({url:t.url,type:i.SUBTITLE_TRACK,level:null,id:t.id,responseType:"text"})},o.load=function(t){var e=this.hls.config;d.b.debug("Loading playlist of type "+t.type+", level: "+t.level+", id: "+t.id);var r,n,a,o,s=this.getInternalLoader(t);if(s){var l=s.context;if(l&&l.url===t.url)return d.b.trace("playlist request ongoing"),!1;d.b.warn("aborting previous loader for type: "+t.type),s.abort()}switch(t.type){case i.MANIFEST:r=e.manifestLoadingMaxRetry,n=e.manifestLoadingTimeOut,a=e.manifestLoadingRetryDelay,o=e.manifestLoadingMaxRetryTimeout;break;case i.LEVEL:r=0,o=0,a=0,n=e.levelLoadingTimeOut;break;default:r=e.levelLoadingMaxRetry,n=e.levelLoadingTimeOut,a=e.levelLoadingRetryDelay,o=e.levelLoadingMaxRetryTimeout}s=this.createInternalLoader(t);var u={timeout:n,maxRetry:r,retryDelay:a,maxRetryDelay:o},c={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};return d.b.debug("Calling internal loader delegate for URL: "+t.url),s.load(t,u,c),!0},o.loadsuccess=function(t,e,r,n){if(void 0===n&&(n=null),r.isSidxRequest)return this._handleSidxRequest(t,r),void this._handlePlaylistLoaded(t,e,r,n);if(this.resetInternalLoader(r.type),"string"!=typeof t.data)throw new Error('expected responseType of "text" for PlaylistLoader');var i=t.data;e.tload=k.now(),0===i.indexOf("#EXTM3U")?i.indexOf("#EXTINF:")>0||i.indexOf("#EXT-X-TARGETDURATION:")>0?this._handleTrackOrLevelPlaylist(t,e,r,n):this._handleMasterPlaylist(t,e,r,n):this._handleManifestParsingError(t,r,"no EXTM3U delimiter",n)},o.loaderror=function(t,e,r){void 0===r&&(r=null),this._handleNetworkError(e,r,!1,t)},o.loadtimeout=function(t,e,r){void 0===r&&(r=null),this._handleNetworkError(e,r,!0)},o._handleMasterPlaylist=function(t,e,r,i){var a=this.hls,o=t.data,s=n.getResponseUrl(t,r),l=L.parseMasterPlaylist(o,s);if(l.length){var c=l.map((function(t){return{id:t.attrs.AUDIO,codec:t.audioCodec}})),h=L.parseMasterPlaylistMedia(o,s,"AUDIO",c),f=L.parseMasterPlaylistMedia(o,s,"SUBTITLES");if(h.length){var p=!1;h.forEach((function(t){t.url||(p=!0)})),!1===p&&l[0].audioCodec&&!l[0].attrs.AUDIO&&(d.b.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),h.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1}))}a.trigger(u.a.MANIFEST_LOADED,{levels:l,audioTracks:h,subtitles:f,url:s,stats:e,networkDetails:i})}else this._handleManifestParsingError(t,r,"no level found in manifest",i)},o._handleTrackOrLevelPlaylist=function(t,e,r,a){var o=this.hls,s=r.id,d=r.level,c=r.type,h=n.getResponseUrl(t,r),f=Object(l.a)(s)?s:0,p=Object(l.a)(d)?d:f,v=n.mapContextToLevelType(r),g=L.parseLevelPlaylist(t.data,h,p,v,f);g.tload=e.tload,c===i.MANIFEST&&o.trigger(u.a.MANIFEST_LOADED,{levels:[{url:h,details:g}],audioTracks:[],url:h,stats:e,networkDetails:a}),e.tparsed=k.now(),g.needSidxRanges?this.load({url:g.initSegment.url,isSidxRequest:!0,type:c,level:d,levelDetails:g,id:s,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer"}):(r.levelDetails=g,this._handlePlaylistLoaded(t,e,r,a))},o._handleSidxRequest=function(t,e){if("string"==typeof t.data)throw new Error("sidx request must be made with responseType of array buffer");var r=p.a.parseSegmentIndex(new Uint8Array(t.data));if(r){var n=e.levelDetails;r.references.forEach((function(t,e){var r=t.info;if(n){var i=n.fragments[e];0===i.byteRange.length&&i.setByteRange(String(1+r.end-r.start)+"@"+String(r.start))}})),n&&n.initSegment.setByteRange(String(r.moovEndOffset)+"@0")}},o._handleManifestParsingError=function(t,e,r,n){this.hls.trigger(u.a.ERROR,{type:s.b.NETWORK_ERROR,details:s.a.MANIFEST_PARSING_ERROR,fatal:!0,url:t.url,reason:r,networkDetails:n})},o._handleNetworkError=function(t,e,r,n){var a,o;void 0===r&&(r=!1),void 0===n&&(n=null),d.b.info("A network error occured while loading a "+t.type+"-type playlist");var l=this.getInternalLoader(t);switch(t.type){case i.MANIFEST:a=r?s.a.MANIFEST_LOAD_TIMEOUT:s.a.MANIFEST_LOAD_ERROR,o=!0;break;case i.LEVEL:a=r?s.a.LEVEL_LOAD_TIMEOUT:s.a.LEVEL_LOAD_ERROR,o=!1;break;case i.AUDIO_TRACK:a=r?s.a.AUDIO_TRACK_LOAD_TIMEOUT:s.a.AUDIO_TRACK_LOAD_ERROR,o=!1;break;default:o=!1}l&&(l.abort(),this.resetInternalLoader(t.type));var c={type:s.b.NETWORK_ERROR,details:a,fatal:o,url:t.url,loader:l,context:t,networkDetails:e};n&&(c.response=n),this.hls.trigger(u.a.ERROR,c)},o._handlePlaylistLoaded=function(t,e,r,a){var o=r.type,s=r.level,l=r.id,d=r.levelDetails;if(d&&d.targetduration)if(n.canHaveQualityLevels(r.type))this.hls.trigger(u.a.LEVEL_LOADED,{details:d,level:s||0,id:l||0,stats:e,networkDetails:a});else switch(o){case i.AUDIO_TRACK:this.hls.trigger(u.a.AUDIO_TRACK_LOADED,{details:d,id:l,stats:e,networkDetails:a});break;case i.SUBTITLE_TRACK:this.hls.trigger(u.a.SUBTITLE_TRACK_LOADED,{details:d,id:l,stats:e,networkDetails:a})}else this._handleManifestParsingError(t,r,"invalid target duration",a)},n}(h),N=function(t){var e,r;function n(e){var r;return(r=t.call(this,e,u.a.FRAG_LOADING)||this).loaders={},r}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var i=n.prototype;return i.destroy=function(){var e=this.loaders;for(var r in e){var n=e[r];n&&n.destroy()}this.loaders={},t.prototype.destroy.call(this)},i.onFragLoading=function(t){var e=t.frag,r=e.type,n=this.loaders,i=this.hls.config,a=i.fLoader,o=i.loader;e.loaded=0;var s,u,c,h=n[r];h&&(d.b.warn("abort previous fragment loader for type: "+r),h.abort()),h=n[r]=e.loader=i.fLoader?new a(i):new o(i),s={url:e.url,frag:e,responseType:"arraybuffer",progressData:!1};var f=e.byteRangeStartOffset,p=e.byteRangeEndOffset;Object(l.a)(f)&&Object(l.a)(p)&&(s.rangeStart=f,s.rangeEnd=p),u={timeout:i.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:i.fragLoadingMaxRetryTimeout},c={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},h.load(s,u,c)},i.loadsuccess=function(t,e,r,n){void 0===n&&(n=null);var i=t.data,a=r.frag;a.loader=void 0,this.loaders[a.type]=void 0,this.hls.trigger(u.a.FRAG_LOADED,{payload:i,frag:a,stats:e,networkDetails:n})},i.loaderror=function(t,e,r){void 0===r&&(r=null);var n=e.frag,i=n.loader;i&&i.abort(),this.loaders[n.type]=void 0,this.hls.trigger(u.a.ERROR,{type:s.b.NETWORK_ERROR,details:s.a.FRAG_LOAD_ERROR,fatal:!1,frag:e.frag,response:t,networkDetails:r})},i.loadtimeout=function(t,e,r){void 0===r&&(r=null);var n=e.frag,i=n.loader;i&&i.abort(),this.loaders[n.type]=void 0,this.hls.trigger(u.a.ERROR,{type:s.b.NETWORK_ERROR,details:s.a.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e.frag,networkDetails:r})},i.loadprogress=function(t,e,r,n){void 0===n&&(n=null);var i=e.frag;i.loaded=t.loaded,this.hls.trigger(u.a.FRAG_LOAD_PROGRESS,{frag:i,stats:t,networkDetails:n})},n}(h),x=function(t){var e,r;function n(e){var r;return(r=t.call(this,e,u.a.KEY_LOADING)||this).loaders={},r.decryptkey=null,r.decrypturl=null,r}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var i=n.prototype;return i.destroy=function(){for(var e in this.loaders){var r=this.loaders[e];r&&r.destroy()}this.loaders={},t.prototype.destroy.call(this)},i.onKeyLoading=function(t){var e=t.frag,r=e.type,n=this.loaders[r];if(e.decryptdata){var i=e.decryptdata.uri;if(i!==this.decrypturl||null===this.decryptkey){var a=this.hls.config;if(n&&(d.b.warn("abort previous key loader for type:"+r),n.abort()),!i)return void d.b.warn("key uri is falsy");e.loader=this.loaders[r]=new a.loader(a),this.decrypturl=i,this.decryptkey=null;var o={url:i,frag:e,responseType:"arraybuffer"},s={timeout:a.fragLoadingTimeOut,maxRetry:0,retryDelay:a.fragLoadingRetryDelay,maxRetryDelay:a.fragLoadingMaxRetryTimeout},l={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};e.loader.load(o,s,l)}else this.decryptkey&&(e.decryptdata.key=this.decryptkey,this.hls.trigger(u.a.KEY_LOADED,{frag:e}))}else d.b.warn("Missing decryption data on fragment in onKeyLoading")},i.loadsuccess=function(t,e,r){var n=r.frag;n.decryptdata?(this.decryptkey=n.decryptdata.key=new Uint8Array(t.data),n.loader=void 0,delete this.loaders[n.type],this.hls.trigger(u.a.KEY_LOADED,{frag:n})):d.b.error("after key load, decryptdata unset")},i.loaderror=function(t,e){var r=e.frag,n=r.loader;n&&n.abort(),delete this.loaders[r.type],this.hls.trigger(u.a.ERROR,{type:s.b.NETWORK_ERROR,details:s.a.KEY_LOAD_ERROR,fatal:!1,frag:r,response:t})},i.loadtimeout=function(t,e){var r=e.frag,n=r.loader;n&&n.abort(),delete this.loaders[r.type],this.hls.trigger(u.a.ERROR,{type:s.b.NETWORK_ERROR,details:s.a.KEY_LOAD_TIMEOUT,fatal:!1,frag:r})},n}(h),I="NOT_LOADED",P="APPENDING",M="PARTIAL",F=function(t){var e,r;function n(e){var r;return(r=t.call(this,e,u.a.BUFFER_APPENDED,u.a.FRAG_BUFFERED,u.a.FRAG_LOADED)||this).bufferPadding=.2,r.fragments=Object.create(null),r.timeRanges=Object.create(null),r.config=e.config,r}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var i=n.prototype;return i.destroy=function(){this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.config=null,h.prototype.destroy.call(this),t.prototype.destroy.call(this)},i.getBufferedFrag=function(t,e){var r=this.fragments,n=Object.keys(r).filter((function(n){var i=r[n];if(i.body.type!==e)return!1;if(!i.buffered)return!1;var a=i.body;return a.startPTS<=t&&t<=a.endPTS}));if(0===n.length)return null;var i=n.pop();return r[i].body},i.detectEvictedFragments=function(t,e){var r,n,i=this;Object.keys(this.fragments).forEach((function(a){var o=i.fragments[a];if(!0===o.buffered){var s=o.range[t];if(s){r=s.time;for(var l=0;l<r.length;l++)if(!1===i.isTimeBuffered((n=r[l]).startPTS,n.endPTS,e)){i.removeFragment(o.body);break}}}}))},i.detectPartialFragments=function(t){var e=this,r=this.getFragmentKey(t),n=this.fragments[r];n&&(n.buffered=!0,Object.keys(this.timeRanges).forEach((function(r){t.hasElementaryStream(r)&&(n.range[r]=e.getBufferedTimes(t.startPTS,t.endPTS,e.timeRanges[r]))})))},i.getBufferedTimes=function(t,e,r){for(var n,i,a=[],o=!1,s=0;s<r.length;s++){if(n=r.start(s)-this.bufferPadding,i=r.end(s)+this.bufferPadding,t>=n&&e<=i){a.push({startPTS:Math.max(t,r.start(s)),endPTS:Math.min(e,r.end(s))});break}if(t<i&&e>n)a.push({startPTS:Math.max(t,r.start(s)),endPTS:Math.min(e,r.end(s))}),o=!0;else if(e<=n)break}return{time:a,partial:o}},i.getFragmentKey=function(t){return t.type+"_"+t.level+"_"+t.urlId+"_"+t.sn},i.getPartialFragment=function(t){var e,r,n,i=this,a=null,o=0;return Object.keys(this.fragments).forEach((function(s){var l=i.fragments[s];i.isPartial(l)&&(n=l.body.endPTS+i.bufferPadding,t>=(r=l.body.startPTS-i.bufferPadding)&&t<=n&&(e=Math.min(t-r,n-t),o<=e&&(a=l.body,o=e)))})),a},i.getState=function(t){var e=this.getFragmentKey(t),r=this.fragments[e],n=I;return void 0!==r&&(n=r.buffered?!0===this.isPartial(r)?M:"OK":P),n},i.isPartial=function(t){return!0===t.buffered&&(void 0!==t.range.video&&!0===t.range.video.partial||void 0!==t.range.audio&&!0===t.range.audio.partial)},i.isTimeBuffered=function(t,e,r){for(var n,i,a=0;a<r.length;a++){if(n=r.start(a)-this.bufferPadding,i=r.end(a)+this.bufferPadding,t>=n&&e<=i)return!0;if(e<=n)return!1}return!1},i.onFragLoaded=function(t){var e=t.frag;Object(l.a)(e.sn)&&!e.bitrateTest&&(this.fragments[this.getFragmentKey(e)]={body:e,range:Object.create(null),buffered:!1})},i.onBufferAppended=function(t){var e=this;this.timeRanges=t.timeRanges,Object.keys(this.timeRanges).forEach((function(t){e.detectEvictedFragments(t,e.timeRanges[t])}))},i.onFragBuffered=function(t){this.detectPartialFragments(t.frag)},i.hasFragment=function(t){var e=this.getFragmentKey(t);return void 0!==this.fragments[e]},i.removeFragment=function(t){var e=this.getFragmentKey(t);delete this.fragments[e]},i.removeAllFragments=function(){this.fragments=Object.create(null)},n}(h),U=function(t,e){for(var r=0,n=t.length-1,i=null,a=null;r<=n;){var o=e(a=t[i=(r+n)/2|0]);if(o>0)r=i+1;else{if(!(o<0))return a;n=i-1}}return null},B=function(){function t(){}return t.isBuffered=function(t,e){try{if(t)for(var r=t.buffered,n=0;n<r.length;n++)if(e>=r.start(n)&&e<=r.end(n))return!0}catch(t){}return!1},t.bufferInfo=function(t,e,r){try{if(t){var n,i=t.buffered,a=[];for(n=0;n<i.length;n++)a.push({start:i.start(n),end:i.end(n)});return this.bufferedInfo(a,e,r)}}catch(t){}return{len:0,start:e,end:e,nextStart:void 0}},t.bufferedInfo=function(t,e,r){t.sort((function(t,e){return t.start-e.start||e.end-t.end}));var n=[];if(r)for(var i=0;i<t.length;i++){var a=n.length;if(a){var o=n[a-1].end;t[i].start-o<r?t[i].end>o&&(n[a-1].end=t[i].end):n.push(t[i])}else n.push(t[i])}else n=t;for(var s,l=0,u=e,d=e,c=0;c<n.length;c++){var h=n[c].start,f=n[c].end;if(e+r>=h&&e<f)u=h,l=(d=f)-e;else if(e+r<h){s=h;break}}return{len:l,start:u,end:d,nextStart:s}},t}(),j=r(8),G=r(11),H=r(9);function K(){return window.MediaSource||window.WebKitMediaSource}var V=r(5),W=function(t){var e,r;function n(){return t.apply(this,arguments)||this}return r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r,n.prototype.trigger=function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];this.emit.apply(this,[t,t].concat(r))},n}(j.EventEmitter),q=Object(V.a)(),Y=K()||{isTypeSupported:function(){return!1}},z=function(){function t(t,e){var r=this;this.hls=t,this.id=e;var n=this.observer=new W,i=t.config,a=function(e,n){(n=n||{}).frag=r.frag,n.id=r.id,t.trigger(e,n)};n.on(u.a.FRAG_DECRYPTED,a),n.on(u.a.FRAG_PARSING_INIT_SEGMENT,a),n.on(u.a.FRAG_PARSING_DATA,a),n.on(u.a.FRAG_PARSED,a),n.on(u.a.ERROR,a),n.on(u.a.FRAG_PARSING_METADATA,a),n.on(u.a.FRAG_PARSING_USERDATA,a),n.on(u.a.INIT_PTS_FOUND,a);var o={mp4:Y.isTypeSupported("video/mp4"),mpeg:Y.isTypeSupported("audio/mpeg"),mp3:Y.isTypeSupported('audio/mp4; codecs="mp3"')},l=navigator.vendor;if(i.enableWorker&&"undefined"!=typeof Worker){var c;d.b.log("demuxing in webworker");try{c=this.w=G(12),this.onwmsg=this.onWorkerMessage.bind(this),c.addEventListener("message",this.onwmsg),c.onerror=function(e){t.trigger(u.a.ERROR,{type:s.b.OTHER_ERROR,details:s.a.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:e.message+" ("+e.filename+":"+e.lineno+")"}})},c.postMessage({cmd:"init",typeSupported:o,vendor:l,id:e,config:JSON.stringify(i)})}catch(t){d.b.warn("Error in worker:",t),d.b.error("Error while initializing DemuxerWorker, fallback on DemuxerInline"),c&&q.URL.revokeObjectURL(c.objectURL),this.demuxer=new H.a(n,o,i,l),this.w=void 0}}else this.demuxer=new H.a(n,o,i,l)}var e=t.prototype;return e.destroy=function(){var t=this.w;if(t)t.removeEventListener("message",this.onwmsg),t.terminate(),this.w=null;else{var e=this.demuxer;e&&(e.destroy(),this.demuxer=null)}var r=this.observer;r&&(r.removeAllListeners(),this.observer=null)},e.push=function(t,e,r,n,i,a,o,s){var u=this.w,c=Object(l.a)(i.startPTS)?i.startPTS:i.start,h=i.decryptdata,f=this.frag,p=!(f&&i.cc===f.cc),v=!(f&&i.level===f.level),g=!v&&f&&i.sn===f.sn+1;if(p&&d.b.log(this.id+":discontinuity detected"),v&&d.b.log(this.id+":switch detected"),this.frag=i,u)u.postMessage({cmd:"demux",data:t,decryptdata:h,initSegment:e,audioCodec:r,videoCodec:n,timeOffset:c,discontinuity:p,trackSwitch:v,contiguous:g,duration:a,accurateTimeOffset:o,defaultInitPTS:s},t instanceof ArrayBuffer?[t]:[]);else{var m=this.demuxer;m&&m.push(t,h,e,r,n,c,p,v,g,a,o,s)}},e.onWorkerMessage=function(t){var e=t.data,r=this.hls;switch(e.event){case"init":q.URL.revokeObjectURL(this.w.objectURL);break;case u.a.FRAG_PARSING_DATA:e.data.data1=new Uint8Array(e.data1),e.data2&&(e.data.data2=new Uint8Array(e.data2));default:e.data=e.data||{},e.data.frag=this.frag,e.data.id=this.id,r.trigger(e.event,e.data)}},t}();function X(t,e,r){switch(e){case"audio":t.audioGroupIds||(t.audioGroupIds=[]),t.audioGroupIds.push(r);break;case"text":t.textGroupIds||(t.textGroupIds=[]),t.textGroupIds.push(r)}}function $(t,e,r){var n=t[e],i=t[r],a=i.startPTS;Object(l.a)(a)?r>e?(n.duration=a-n.start,n.duration<0&&d.b.warn("negative duration computed for frag "+n.sn+",level "+n.level+", there should be some duration drift between playlist and fragment!")):(i.duration=n.start-a,i.duration<0&&d.b.warn("negative duration computed for frag "+i.sn+",level "+i.level+", there should be some duration drift between playlist and fragment!")):i.start=r>e?n.start+n.duration:Math.max(n.start-i.duration,0)}function J(t,e,r,n,i,a){var o=r;if(Object(l.a)(e.startPTS)){var s=Math.abs(e.startPTS-r);e.deltaPTS=Object(l.a)(e.deltaPTS)?Math.max(s,e.deltaPTS):s,o=Math.max(r,e.startPTS),r=Math.min(r,e.startPTS),n=Math.max(n,e.endPTS),i=Math.min(i,e.startDTS),a=Math.max(a,e.endDTS)}var u=r-e.start;e.start=e.startPTS=r,e.maxStartPTS=o,e.endPTS=n,e.startDTS=i,e.endDTS=a,e.duration=n-r;var d,c,h,f=e.sn;if(!t||f<t.startSN||f>t.endSN)return 0;for((c=t.fragments)[d=f-t.startSN]=e,h=d;h>0;h--)$(c,h,h-1);for(h=d;h<c.length-1;h++)$(c,h,h+1);return t.PTSKnown=!0,u}function Z(t,e){e.initSegment&&t.initSegment&&(e.initSegment=t.initSegment);var r,n=0;if(Q(t,e,(function(t,i){n=t.cc-i.cc,Object(l.a)(t.startPTS)&&(i.start=i.startPTS=t.startPTS,i.endPTS=t.endPTS,i.duration=t.duration,i.backtracked=t.backtracked,i.dropped=t.dropped,r=i),e.PTSKnown=!0})),e.PTSKnown){if(n){d.b.log("discontinuity sliding from playlist, take drift into account");for(var i=e.fragments,a=0;a<i.length;a++)i[a].cc+=n}r?J(e,r,r.startPTS,r.endPTS,r.startDTS,r.endDTS):function(t,e){var r=e.startSN-t.startSN,n=t.fragments,i=e.fragments;if(!(r<0||r>n.length))for(var a=0;a<i.length;a++)i[a].start+=n[r].start}(t,e),e.PTSKnown=t.PTSKnown}}function Q(t,e,r){if(t&&e)for(var n=Math.max(t.startSN,e.startSN)-e.startSN,i=Math.min(t.endSN,e.endSN)-e.startSN,a=e.startSN-t.startSN,o=n;o<=i;o++){var s=t.fragments[a+o],l=e.fragments[o];if(!s||!l)break;r(s,l,o)}}function tt(t,e,r){var n=1e3*(e.averagetargetduration?e.averagetargetduration:e.targetduration),i=n/2;return t&&e.endSN===t.endSN&&(n=i),r&&(n=Math.max(i,n-(window.performance.now()-r))),Math.round(n)}var et=function(t){for(var e="",r=t.length,n=0;n<r;n++)e+="["+t.start(n).toFixed(3)+","+t.end(n).toFixed(3)+"]";return e};function rt(t,e){e.fragments.forEach((function(e){if(e){var r=e.start+t;e.start=e.startPTS=r,e.endPTS=r+e.duration}})),e.PTSKnown=!0}function nt(t,e,r){!function(t,e,r){if(function(t,e,r){var n=!1;return e&&e.details&&r&&(r.endCC>r.startCC||t&&t.cc<r.startCC)&&(n=!0),n}(t,r,e)){var n=function(t,e){var r=t.fragments,n=e.fragments;if(n.length&&r.length){var i=function(t,e){for(var r=null,n=0;n<t.length;n+=1){var i=t[n];if(i&&i.cc===e){r=i;break}}return r}(r,n[0].cc);if(i&&(!i||i.startPTS))return i;d.b.log("No frag in previous level to align on")}else d.b.log("No fragments to align")}(r.details,e);n&&(d.b.log("Adjusting PTS using last level due to CC increase within current level"),rt(n.start,e))}}(t,r,e),!r.PTSKnown&&e&&function(t,e){if(e&&e.fragments.length){if(!t.hasProgramDateTime||!e.hasProgramDateTime)return;var r=(t.fragments[0].programDateTime-e.fragments[0].programDateTime)/1e3+e.fragments[0].start;Object(l.a)(r)&&(d.b.log("adjusting PTS using programDateTime delta, sliding:"+r.toFixed(3)),rt(r,t))}}(r,e.details)}function it(t,e,r){if(null===e||!Array.isArray(t)||!t.length||!Object(l.a)(e))return null;if(e<(t[0].programDateTime||0))return null;if(e>=(t[t.length-1].endProgramDateTime||0))return null;r=r||0;for(var n=0;n<t.length;++n){var i=t[n];if(st(e,r,i))return i}return null}function at(t,e,r,n){void 0===r&&(r=0),void 0===n&&(n=0);var i=t?e[t.sn-e[0].sn+1]:null;return i&&!ot(r,n,i)?i:U(e,ot.bind(null,r,n))}function ot(t,e,r){void 0===t&&(t=0),void 0===e&&(e=0);var n=Math.min(e,r.duration+(r.deltaPTS?r.deltaPTS:0));return r.start+r.duration-n<=t?1:r.start-n>t&&r.start?-1:0}function st(t,e,r){var n=1e3*Math.min(e,r.duration+(r.deltaPTS?r.deltaPTS:0));return(r.endProgramDateTime||0)-n>t}var lt=function(){function t(t,e,r,n){this.config=t,this.media=e,this.fragmentTracker=r,this.hls=n,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1}var e=t.prototype;return e.poll=function(t){var e=this.config,r=this.media,n=this.stalled,i=r.currentTime,a=r.seeking,o=this.seeking&&!a,s=!this.seeking&&a;if(this.seeking=a,i===t){if((s||o)&&(this.stalled=null),!r.paused&&!r.ended&&0!==r.playbackRate&&r.buffered.length){var l=B.bufferInfo(r,i,0),u=l.nextStart||0;if(l.len>0||u){if(a){if(l.len>2||!u||u-i>2)return;this.moved=!1}if(!this.moved&&this.stalled){var c=Math.max(u,l.start||0)-i;if(c>0&&c<=2)return void this._trySkipBufferHole(null)}var h=self.performance.now();if(null!==n){var f=h-n;!a&&f>=250&&this._reportStall(l.len);var p=B.bufferInfo(r,i,e.maxBufferHole);this._tryFixBufferStall(p,f)}else this.stalled=h}}}else if(this.moved=!0,null!==n){if(this.stallReported){var v=self.performance.now()-n;d.b.warn("playback not stuck anymore @"+i+", after "+Math.round(v)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}},e._tryFixBufferStall=function(t,e){var r=this.config,n=this.fragmentTracker.getPartialFragment(this.media.currentTime);n&&this._trySkipBufferHole(n)||t.len>r.maxBufferHole&&e>1e3*r.highBufferWatchdogPeriod&&(d.b.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())},e._reportStall=function(t){var e=this.hls,r=this.media;this.stallReported||(this.stallReported=!0,d.b.warn("Playback stalling at @"+r.currentTime+" due to low buffer"),e.trigger(u.a.ERROR,{type:s.b.MEDIA_ERROR,details:s.a.BUFFER_STALLED_ERROR,fatal:!1,buffer:t}))},e._trySkipBufferHole=function(t){for(var e=this.config,r=this.hls,n=this.media,i=n.currentTime,a=0,o=0;o<n.buffered.length;o++){var l=n.buffered.start(o);if(i+e.maxBufferHole>=a&&i<l){var c=Math.max(l+.05,n.currentTime+.1);return d.b.warn("skipping hole, adjusting currentTime from "+i+" to "+c),this.moved=!0,this.stalled=null,n.currentTime=c,t&&r.trigger(u.a.ERROR,{type:s.b.MEDIA_ERROR,details:s.a.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+i+" to "+c,frag:t}),c}a=n.buffered.end(o)}return 0},e._tryNudgeBuffer=function(){var t=this.config,e=this.hls,r=this.media,n=r.currentTime,i=(this.nudgeRetry||0)+1;if(this.nudgeRetry=i,i<t.nudgeMaxRetry){var a=n+i*t.nudgeOffset;d.b.warn("Nudging 'currentTime' from "+n+" to "+a),r.currentTime=a,e.trigger(u.a.ERROR,{type:s.b.MEDIA_ERROR,details:s.a.BUFFER_NUDGE_ON_STALL,fatal:!1})}else d.b.error("Playhead still not moving while enough data buffered @"+n+" after "+t.nudgeMaxRetry+" nudges"),e.trigger(u.a.ERROR,{type:s.b.MEDIA_ERROR,details:s.a.BUFFER_STALLED_ERROR,fatal:!0})},t}();function ut(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var dt=function(t){var e,r;function n(e){for(var r,n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];return(r=t.call.apply(t,[this,e].concat(i))||this)._boundTick=void 0,r._tickTimer=null,r._tickInterval=null,r._tickCallCount=0,r._boundTick=r.tick.bind(ut(r)),r}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var i=n.prototype;return i.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},i.hasInterval=function(){return!!this._tickInterval},i.hasNextTick=function(){return!!this._tickTimer},i.setInterval=function(t){return!this._tickInterval&&(this._tickInterval=self.setInterval(this._boundTick,t),!0)},i.clearInterval=function(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)},i.clearNextTick=function(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)},i.tick=function(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&(this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)),this._tickCallCount=0)},i.doTick=function(){},n}(h),ct="STOPPED",ht="STARTING",ft="IDLE",pt="KEY_LOADING",vt="FRAG_LOADING",gt="FRAG_LOADING_WAITING_RETRY",mt="WAITING_TRACK",yt="PARSING",_t="PARSED",bt="BUFFER_FLUSHING",Et="ENDED",Tt="ERROR",St="WAITING_INIT_PTS",wt="WAITING_LEVEL",At=function(t){var e,r;function n(){return t.apply(this,arguments)||this}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var i=n.prototype;return i.doTick=function(){},i.startLoad=function(){},i.stopLoad=function(){var t=this.fragCurrent;t&&(t.loader&&t.loader.abort(),this.fragmentTracker.removeFragment(t)),this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=ct},i._streamEnded=function(t,e){var r=this.fragCurrent;if(!e.live&&r&&!r.backtracked&&r.sn===e.endSN&&!t.nextStart){var n=this.fragmentTracker.getState(r);return n===M||"OK"===n}return!1},i.onMediaSeeking=function(){var t=this.config,e=this.media,r=this.state,n=e?e.currentTime:null,i=B.bufferInfo(this.mediaBuffer||e,n,this.config.maxBufferHole);if(Object(l.a)(n)&&d.b.log("media seeking to "+n.toFixed(3)),r===vt){var a=this.fragCurrent;if(0===i.len&&a){var o=t.maxFragLookUpTolerance;n<a.start-o||n>a.start+a.duration+o?(a.loader&&(d.b.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),a.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=ft):d.b.log("seeking outside of buffer but within currently loaded fragment range")}}else r===Et&&(0===i.len&&(this.fragPrevious=null,this.fragCurrent=null),this.state=ft);e&&(this.lastCurrentTime=n),this.loadedmetadata||(this.nextLoadPosition=this.startPosition=n),this.tick()},i.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},i.onHandlerDestroying=function(){this.stopLoad(),t.prototype.onHandlerDestroying.call(this)},i.onHandlerDestroyed=function(){this.state=ct,this.fragmentTracker=null},i.computeLivePosition=function(t,e){return t+Math.max(0,e.totalduration-(void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*e.targetduration))},n}(dt),Ct=function(t){var e,r;function n(e,r){var n;return(n=t.call(this,e,u.a.MEDIA_ATTACHED,u.a.MEDIA_DETACHING,u.a.MANIFEST_LOADING,u.a.MANIFEST_PARSED,u.a.LEVEL_LOADED,u.a.KEY_LOADED,u.a.FRAG_LOADED,u.a.FRAG_LOAD_EMERGENCY_ABORTED,u.a.FRAG_PARSING_INIT_SEGMENT,u.a.FRAG_PARSING_DATA,u.a.FRAG_PARSED,u.a.ERROR,u.a.AUDIO_TRACK_SWITCHING,u.a.AUDIO_TRACK_SWITCHED,u.a.BUFFER_CREATED,u.a.BUFFER_APPENDED,u.a.BUFFER_FLUSHED)||this).fragmentTracker=r,n.config=e.config,n.audioCodecSwap=!1,n._state=ct,n.stallReported=!1,n.gapController=null,n.altAudio=!1,n}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var i,o=n.prototype;return o.startLoad=function(t){if(this.levels){var e=this.lastCurrentTime,r=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var n=r.startLevel;-1===n&&(n=0,this.bitrateTest=!0),this.level=r.nextLoadLevel=n,this.loadedmetadata=!1}e>0&&-1===t&&(d.b.log("override startPosition with lastCurrentTime @"+e.toFixed(3)),t=e),this.state=ft,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=t,this.tick()}else this.forceStartLoad=!0,this.state=ct},o.stopLoad=function(){this.forceStartLoad=!1,t.prototype.stopLoad.call(this)},o.doTick=function(){switch(this.state){case bt:this.fragLoadError=0;break;case ft:this._doTickIdle();break;case wt:var t=this.levels[this.level];t&&t.details&&(this.state=ft);break;case gt:var e=window.performance.now(),r=this.retryDate;(!r||e>=r||this.media&&this.media.seeking)&&(d.b.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=ft)}this._checkBuffer(),this._checkFragmentChanged()},o._doTickIdle=function(){var t=this.hls,e=t.config,r=this.media;if(void 0!==this.levelLastLoaded&&(r||!this.startFragRequested&&e.startFragPrefetch)){var n;n=this.loadedmetadata?r.currentTime:this.nextLoadPosition;var i=t.nextLoadLevel,a=this.levels[i];if(a){var o,s=a.bitrate;o=s?Math.max(8*e.maxBufferSize/s,e.maxBufferLength):e.maxBufferLength,o=Math.min(o,e.maxMaxBufferLength);var l=B.bufferInfo(this.mediaBuffer?this.mediaBuffer:r,n,e.maxBufferHole),c=l.len;if(!(c>=o)){d.b.trace("buffer length of "+c.toFixed(3)+" is below max of "+o.toFixed(3)+". checking for more payload ..."),this.level=t.nextLoadLevel=i;var h=a.details;if(!h||h.live&&this.levelLastLoaded!==i)this.state=wt;else{if(this._streamEnded(l,h)){var f={};return this.altAudio&&(f.type="video"),this.hls.trigger(u.a.BUFFER_EOS,f),void(this.state=Et)}this._fetchPayloadOrEos(n,l,h)}}}}},o._fetchPayloadOrEos=function(t,e,r){var n=this.fragPrevious,i=this.level,a=r.fragments,o=a.length;if(0!==o){var s,l=a[0].start,u=a[o-1].start+a[o-1].duration,c=e.end;if(r.initSegment&&!r.initSegment.data)s=r.initSegment;else if(r.live){var h=this.config.initialLiveManifestSize;if(o<h)return void d.b.warn("Can not start playback of a level, reason: not enough fragments "+o+" < "+h);if(null===(s=this._ensureFragmentAtLivePoint(r,c,l,u,n,a,o)))return}else c<l&&(s=a[0]);s||(s=this._findFragment(l,n,o,a,c,u,r)),s&&(s.encrypted?(d.b.log("Loading key for "+s.sn+" of ["+r.startSN+" ,"+r.endSN+"],level "+i),this._loadKey(s)):(d.b.log("Loading "+s.sn+" of ["+r.startSN+" ,"+r.endSN+"],level "+i+", currentTime:"+t.toFixed(3)+",bufferEnd:"+c.toFixed(3)),this._loadFragment(s)))}},o._ensureFragmentAtLivePoint=function(t,e,r,n,i,a,o){var s,l=this.hls.config,u=this.media;if(e<Math.max(r-l.maxFragLookUpTolerance,n-(void 0!==l.liveMaxLatencyDuration?l.liveMaxLatencyDuration:l.liveMaxLatencyDurationCount*t.targetduration))){var c=this.liveSyncPosition=this.computeLivePosition(r,t);e=c,u&&!u.paused&&u.readyState&&u.duration>c&&c>u.currentTime&&(d.b.log("buffer end: "+e.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+c.toFixed(3)),u.currentTime=c),this.nextLoadPosition=c}if(t.PTSKnown&&e>n&&u&&u.readyState)return null;if(this.startFragRequested&&!t.PTSKnown){if(i)if(t.hasProgramDateTime)d.b.log("live playlist, switching playlist, load frag with same PDT: "+i.programDateTime),s=it(a,i.endProgramDateTime,l.maxFragLookUpTolerance);else{var h=i.sn+1;if(h>=t.startSN&&h<=t.endSN){var f=a[h-t.startSN];i.cc===f.cc&&d.b.log("live playlist, switching playlist, load frag with next SN: "+(s=f).sn)}s||(s=U(a,(function(t){return i.cc-t.cc})))&&d.b.log("live playlist, switching playlist, load frag with same CC: "+s.sn)}s||(s=a[Math.min(o-1,Math.round(o/2))],d.b.log("live playlist, switching playlist, unknown, load middle frag : "+s.sn))}return s},o._findFragment=function(t,e,r,n,i,a,o){var s,l=this.hls.config;if(s=i<a?at(e,n,i,i>a-l.maxFragLookUpTolerance?0:l.maxFragLookUpTolerance):n[r-1]){var u=s.sn-o.startSN,c=n[u-1],h=n[u+1];if(e&&s.sn===e.sn)if(e&&s.level===e.level&&!s.backtracked)if(s.sn<o.endSN){var f=e.deltaPTS;f&&f>l.maxBufferHole&&e.dropped&&u?(s=c,d.b.warn("Previous fragment was dropped with large PTS gap between audio and video. Maybe fragment is not starting with a keyframe? Loading previous one to try to overcome this")):d.b.log("Re-loading fragment with SN: "+(s=h).sn)}else s=null;else s.backtracked&&(h&&h.backtracked?(d.b.warn("Already backtracked from fragment "+h.sn+", will not backtrack to fragment "+s.sn+". Loading fragment "+h.sn),s=h):(d.b.warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe"),s.dropped=0,c?(s=c).backtracked=!0:u&&(s=null)))}return s},o._loadKey=function(t){this.state=pt,this.hls.trigger(u.a.KEY_LOADING,{frag:t})},o._loadFragment=function(t){var e=this.fragmentTracker.getState(t);this.fragCurrent=t,"initSegment"!==t.sn&&(this.startFragRequested=!0),Object(l.a)(t.sn)&&!t.bitrateTest&&(this.nextLoadPosition=t.start+t.duration),t.backtracked||e===I||e===M?(t.autoLevel=this.hls.autoLevelEnabled,t.bitrateTest=this.bitrateTest,this.hls.trigger(u.a.FRAG_LOADING,{frag:t}),this.demuxer||(this.demuxer=new z(this.hls,"main")),this.state=vt):e===P&&this._reduceMaxBufferLength(t.duration)&&this.fragmentTracker.removeFragment(t)},o.getBufferedFrag=function(t){return this.fragmentTracker.getBufferedFrag(t,a.MAIN)},o.followingBufferedFrag=function(t){return t?this.getBufferedFrag(t.endPTS+.5):null},o._checkFragmentChanged=function(){var t,e,r=this.media;if(r&&r.readyState&&!1===r.seeking&&((e=r.currentTime)>this.lastCurrentTime&&(this.lastCurrentTime=e),B.isBuffered(r,e)?t=this.getBufferedFrag(e):B.isBuffered(r,e+.1)&&(t=this.getBufferedFrag(e+.1)),t)){var n=t;if(n!==this.fragPlaying){this.hls.trigger(u.a.FRAG_CHANGED,{frag:n});var i=n.level;this.fragPlaying&&this.fragPlaying.level===i||this.hls.trigger(u.a.LEVEL_SWITCHED,{level:i}),this.fragPlaying=n}}},o.immediateLevelSwitch=function(){if(d.b.log("immediateLevelSwitch"),!this.immediateSwitch){this.immediateSwitch=!0;var t,e=this.media;e?(t=e.paused,e.pause()):t=!0,this.previouslyPaused=t}var r=this.fragCurrent;r&&r.loader&&r.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},o.immediateLevelSwitchEnd=function(){var t=this.media;t&&t.buffered.length&&(this.immediateSwitch=!1,B.isBuffered(t,t.currentTime)&&(t.currentTime-=1e-4),this.previouslyPaused||t.play())},o.nextLevelSwitch=function(){var t=this.media;if(t&&t.readyState){var e,r,n;if((r=this.getBufferedFrag(t.currentTime))&&r.startPTS>1&&this.flushMainBuffer(0,r.startPTS-1),t.paused)e=0;else{var i=this.fragLastKbps;e=i&&this.fragCurrent?this.fragCurrent.duration*this.levels[this.hls.nextLoadLevel].bitrate/(1e3*i)+1:0}if((n=this.getBufferedFrag(t.currentTime+e))&&(n=this.followingBufferedFrag(n))){var a=this.fragCurrent;a&&a.loader&&a.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(n.maxStartPTS,Number.POSITIVE_INFINITY)}}},o.flushMainBuffer=function(t,e){this.state=bt;var r={startOffset:t,endOffset:e};this.altAudio&&(r.type="video"),this.hls.trigger(u.a.BUFFER_FLUSHING,r)},o.onMediaAttached=function(t){var e=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),e.addEventListener("seeking",this.onvseeking),e.addEventListener("seeked",this.onvseeked),e.addEventListener("ended",this.onvended);var r=this.config;this.levels&&r.autoStartLoad&&this.hls.startLoad(r.startPosition),this.gapController=new lt(r,e,this.fragmentTracker,this.hls)},o.onMediaDetaching=function(){var t=this.media;t&&t.ended&&(d.b.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var e=this.levels;e&&e.forEach((function(t){t.details&&t.details.fragments.forEach((function(t){t.backtracked=void 0}))})),t&&(t.removeEventListener("seeking",this.onvseeking),t.removeEventListener("seeked",this.onvseeked),t.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.fragmentTracker.removeAllFragments(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()},o.onMediaSeeked=function(){var t=this.media,e=t?t.currentTime:void 0;Object(l.a)(e)&&d.b.log("media seeked to "+e.toFixed(3)),this.tick()},o.onManifestLoading=function(){d.b.log("trigger BUFFER_RESET"),this.hls.trigger(u.a.BUFFER_RESET),this.fragmentTracker.removeAllFragments(),this.stalled=!1,this.startPosition=this.lastCurrentTime=0},o.onManifestParsed=function(t){var e,r=!1,n=!1;t.levels.forEach((function(t){(e=t.audioCodec)&&(-1!==e.indexOf("mp4a.40.2")&&(r=!0),-1!==e.indexOf("mp4a.40.5")&&(n=!0))})),this.audioCodecSwitch=r&&n,this.audioCodecSwitch&&d.b.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.altAudio=t.altAudio,this.levels=t.levels,this.startFragRequested=!1;var i=this.config;(i.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(i.startPosition)},o.onLevelLoaded=function(t){var e=t.details,r=t.level,n=this.levels[this.levelLastLoaded],i=this.levels[r],a=e.totalduration,o=0;if(d.b.log("level "+r+" loaded ["+e.startSN+","+e.endSN+"],duration:"+a),e.live){var s=i.details;s&&e.fragments.length>0?(Z(s,e),this.liveSyncPosition=this.computeLivePosition(o=e.fragments[0].start,s),e.PTSKnown&&Object(l.a)(o)?d.b.log("live playlist sliding:"+o.toFixed(3)):(d.b.log("live playlist - outdated PTS, unknown sliding"),nt(this.fragPrevious,n,e))):(d.b.log("live playlist - first load, unknown sliding"),e.PTSKnown=!1,nt(this.fragPrevious,n,e))}else e.PTSKnown=!1;if(i.details=e,this.levelLastLoaded=r,this.hls.trigger(u.a.LEVEL_UPDATED,{details:e,level:r}),!1===this.startFragRequested){if(-1===this.startPosition||-1===this.lastCurrentTime){var c=e.startTimeOffset;Object(l.a)(c)?(c<0&&(d.b.log("negative start time offset "+c+", count from end of last fragment"),c=o+a+c),d.b.log("start time offset found in playlist, adjust startPosition to "+c),this.startPosition=c):e.live?(this.startPosition=this.computeLivePosition(o,e),d.b.log("configure startPosition to "+this.startPosition)):this.startPosition=0,this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}this.state===wt&&(this.state=ft),this.tick()},o.onKeyLoaded=function(){this.state===pt&&(this.state=ft,this.tick())},o.onFragLoaded=function(t){var e=this.fragCurrent,r=this.hls,n=this.media,i=t.frag;if(this.state===vt&&e&&"main"===i.type&&i.level===e.level&&i.sn===e.sn){var a=t.stats,o=this.levels[e.level],s=o.details;if(this.bitrateTest=!1,this.stats=a,d.b.log("Loaded "+e.sn+" of ["+s.startSN+" ,"+s.endSN+"],level "+e.level),i.bitrateTest&&r.nextLoadLevel)this.state=ft,this.startFragRequested=!1,a.tparsed=a.tbuffered=window.performance.now(),r.trigger(u.a.FRAG_BUFFERED,{stats:a,frag:e,id:"main"}),this.tick();else if("initSegment"===i.sn)this.state=ft,a.tparsed=a.tbuffered=window.performance.now(),s.initSegment.data=t.payload,r.trigger(u.a.FRAG_BUFFERED,{stats:a,frag:e,id:"main"}),this.tick();else{d.b.log("Parsing "+e.sn+" of ["+s.startSN+" ,"+s.endSN+"],level "+e.level+", cc "+e.cc),this.state=yt,this.pendingBuffering=!0,this.appended=!1,i.bitrateTest&&(i.bitrateTest=!1,this.fragmentTracker.onFragLoaded({frag:i}));var l=!(n&&n.seeking)&&(s.PTSKnown||!s.live),c=s.initSegment?s.initSegment.data:[],h=this._getAudioCodec(o);(this.demuxer=this.demuxer||new z(this.hls,"main")).push(t.payload,c,h,o.videoCodec,e,s.totalduration,l)}}this.fragLoadError=0},o.onFragParsingInitSegment=function(t){var e=this.fragCurrent,r=t.frag;if(e&&"main"===t.id&&r.sn===e.sn&&r.level===e.level&&this.state===yt){var n,i,a=t.tracks;if(a.audio&&this.altAudio&&delete a.audio,i=a.audio){var o=this.levels[this.level].audioCodec,s=navigator.userAgent.toLowerCase();o&&this.audioCodecSwap&&(d.b.log("swapping playlist audio codec"),o=-1!==o.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==i.metadata.channelCount&&-1===s.indexOf("firefox")&&(o="mp4a.40.5"),-1!==s.indexOf("android")&&"audio/mpeg"!==i.container&&d.b.log("Android: force audio codec to "+(o="mp4a.40.2")),i.levelCodec=o,i.id=t.id}for(n in(i=a.video)&&(i.levelCodec=this.levels[this.level].videoCodec,i.id=t.id),this.hls.trigger(u.a.BUFFER_CODECS,a),a){d.b.log("main track:"+n+",container:"+(i=a[n]).container+",codecs[level/parsed]=["+i.levelCodec+"/"+i.codec+"]");var l=i.initSegment;l&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(u.a.BUFFER_APPENDING,{type:n,data:l,parent:"main",content:"initSegment"}))}this.tick()}},o.onFragParsingData=function(t){var e=this,r=this.fragCurrent,n=t.frag;if(r&&"main"===t.id&&n.sn===r.sn&&n.level===r.level&&("audio"!==t.type||!this.altAudio)&&this.state===yt){var i=this.levels[this.level],a=r;if(Object(l.a)(t.endPTS)||(t.endPTS=t.startPTS+r.duration,t.endDTS=t.startDTS+r.duration),!0===t.hasAudio&&a.addElementaryStream(f.AUDIO),!0===t.hasVideo&&a.addElementaryStream(f.VIDEO),d.b.log("Parsed "+t.type+",PTS:["+t.startPTS.toFixed(3)+","+t.endPTS.toFixed(3)+"],DTS:["+t.startDTS.toFixed(3)+"/"+t.endDTS.toFixed(3)+"],nb:"+t.nb+",dropped:"+(t.dropped||0)),"video"===t.type)if(a.dropped=t.dropped,a.dropped)if(a.backtracked)d.b.warn("Already backtracked on this fragment, appending with the gap",a.sn);else{var o=i.details;if(!o||a.sn!==o.startSN)return d.b.warn("missing video frame(s), backtracking fragment",a.sn),this.fragmentTracker.removeFragment(a),a.backtracked=!0,this.nextLoadPosition=t.startPTS,this.state=ft,this.fragPrevious=a,void this.tick();d.b.warn("missing video frame(s) on first frag, appending with gap",a.sn)}else a.backtracked=!1;var s=J(i.details,a,t.startPTS,t.endPTS,t.startDTS,t.endDTS),c=this.hls;c.trigger(u.a.LEVEL_PTS_UPDATED,{details:i.details,level:this.level,drift:s,type:t.type,start:t.startPTS,end:t.endPTS}),[t.data1,t.data2].forEach((function(r){r&&r.length&&e.state===yt&&(e.appended=!0,e.pendingBuffering=!0,c.trigger(u.a.BUFFER_APPENDING,{type:t.type,data:r,parent:"main",content:"data"}))})),this.tick()}},o.onFragParsed=function(t){var e=this.fragCurrent,r=t.frag;e&&"main"===t.id&&r.sn===e.sn&&r.level===e.level&&this.state===yt&&(this.stats.tparsed=window.performance.now(),this.state=_t,this._checkAppendedParsed())},o.onAudioTrackSwitching=function(t){var e=t.id;if(!t.url){if(this.mediaBuffer!==this.media){d.b.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var r=this.fragCurrent;r.loader&&(d.b.log("switching to main audio track, cancel main fragment load"),r.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=ft}var n=this.hls;n.trigger(u.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),n.trigger(u.a.AUDIO_TRACK_SWITCHED,{id:e}),this.altAudio=!1}},o.onAudioTrackSwitched=function(t){var e=!!this.hls.audioTracks[t.id].url;if(e){var r=this.videoBuffer;r&&this.mediaBuffer!==r&&(d.b.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=r)}this.altAudio=e,this.tick()},o.onBufferCreated=function(t){var e,r,n=t.tracks,i=!1;for(var a in n){var o=n[a];"main"===o.id?(r=a,e=o,"video"===a&&(this.videoBuffer=n[a].buffer)):i=!0}i&&e?(d.b.log("alternate track found, use "+r+".buffered to schedule main fragment loading"),this.mediaBuffer=e.buffer):this.mediaBuffer=this.media},o.onBufferAppended=function(t){if("main"===t.parent){var e=this.state;e!==yt&&e!==_t||(this.pendingBuffering=t.pending>0,this._checkAppendedParsed())}},o._checkAppendedParsed=function(){if(!(this.state!==_t||this.appended&&this.pendingBuffering)){var t=this.fragCurrent;if(t){d.b.log("main buffered : "+et((this.mediaBuffer?this.mediaBuffer:this.media).buffered)),this.fragPrevious=t;var e=this.stats;e.tbuffered=window.performance.now(),this.fragLastKbps=Math.round(8*e.total/(e.tbuffered-e.tfirst)),this.hls.trigger(u.a.FRAG_BUFFERED,{stats:e,frag:t,id:"main"}),this.state=ft}this.tick()}},o.onError=function(t){var e=t.frag||this.fragCurrent;if(!e||"main"===e.type){var r=!!this.media&&B.isBuffered(this.media,this.media.currentTime)&&B.isBuffered(this.media,this.media.currentTime+.5);switch(t.details){case s.a.FRAG_LOAD_ERROR:case s.a.FRAG_LOAD_TIMEOUT:case s.a.KEY_LOAD_ERROR:case s.a.KEY_LOAD_TIMEOUT:if(!t.fatal)if(this.fragLoadError+1<=this.config.fragLoadingMaxRetry){var n=Math.min(Math.pow(2,this.fragLoadError)*this.config.fragLoadingRetryDelay,this.config.fragLoadingMaxRetryTimeout);d.b.warn("mediaController: frag loading failed, retry in "+n+" ms"),this.retryDate=window.performance.now()+n,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.fragLoadError++,this.state=gt}else d.b.error("mediaController: "+t.details+" reaches max retry, redispatch as fatal ..."),t.fatal=!0,this.state=Tt;break;case s.a.LEVEL_LOAD_ERROR:case s.a.LEVEL_LOAD_TIMEOUT:this.state!==Tt&&(t.fatal?(this.state=Tt,d.b.warn("streamController: "+t.details+",switch to "+this.state+" state ...")):t.levelRetry||this.state!==wt||(this.state=ft));break;case s.a.BUFFER_FULL_ERROR:"main"!==t.parent||this.state!==yt&&this.state!==_t||(r?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=ft):(d.b.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)))}}},o._reduceMaxBufferLength=function(t){var e=this.config;return e.maxMaxBufferLength>=t&&(e.maxMaxBufferLength/=2,d.b.warn("main:reduce max buffer length to "+e.maxMaxBufferLength+"s"),!0)},o._checkBuffer=function(){var t=this.media;if(t&&0!==t.readyState){var e=(this.mediaBuffer?this.mediaBuffer:t).buffered;!this.loadedmetadata&&e.length?(this.loadedmetadata=!0,this._seekToStartPos()):this.immediateSwitch?this.immediateLevelSwitchEnd():this.gapController.poll(this.lastCurrentTime,e)}},o.onFragLoadEmergencyAborted=function(){this.state=ft,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()},o.onBufferFlushed=function(){var t=this.mediaBuffer?this.mediaBuffer:this.media;t&&this.fragmentTracker.detectEvictedFragments(f.VIDEO,t.buffered),this.state=ft,this.fragPrevious=null},o.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},o._seekToStartPos=function(){var t=this.media,e=t.currentTime,r=t.seeking?e:this.startPosition;e!==r&&r>=0&&(d.b.log("target start position not buffered, seek to buffered.start(0) "+r+" from current time "+e+" "),t.currentTime=r)},o._getAudioCodec=function(t){var e=this.config.defaultAudioCodec||t.audioCodec;return this.audioCodecSwap&&(d.b.log("swapping playlist audio codec"),e&&(e=-1!==e.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5")),e},(i=[{key:"state",set:function(t){if(this.state!==t){var e=this.state;this._state=t,d.b.log("main stream-controller: "+e+"->"+t),this.hls.trigger(u.a.STREAM_STATE_TRANSITION,{previousState:e,nextState:t})}},get:function(){return this._state}},{key:"currentLevel",get:function(){var t=this.media;if(t){var e=this.getBufferedFrag(t.currentTime);if(e)return e.level}return-1}},{key:"nextBufferedFrag",get:function(){var t=this.media;return t?this.followingBufferedFrag(this.getBufferedFrag(t.currentTime)):null}},{key:"nextLevel",get:function(){var t=this.nextBufferedFrag;return t?t.level:-1}},{key:"liveSyncPosition",get:function(){return this._liveSyncPosition},set:function(t){this._liveSyncPosition=t}}])&&function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(n.prototype,i),n}(At);window;var Rt,Lt=function(t){var e,r;function n(e){var r;return(r=t.call(this,e,u.a.MANIFEST_LOADED,u.a.LEVEL_LOADED,u.a.AUDIO_TRACK_SWITCHED,u.a.FRAG_LOADED,u.a.ERROR)||this).canload=!1,r.currentLevelIndex=null,r.manualLevelIndex=-1,r.timer=null,Rt=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),r}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var i,a=n.prototype;return a.onHandlerDestroying=function(){this.clearTimer(),this.manualLevelIndex=-1},a.clearTimer=function(){null!==this.timer&&(clearTimeout(this.timer),this.timer=null)},a.startLoad=function(){var t=this._levels;this.canload=!0,this.levelRetryCount=0,t&&t.forEach((function(t){t.loadError=0;var e=t.details;e&&e.live&&(t.details=void 0)})),null!==this.timer&&this.loadLevel()},a.stopLoad=function(){this.canload=!1},a.onManifestLoaded=function(t){var e,r=[],n=[],i={},a=null,o=!1,l=!1;if(t.levels.forEach((function(t){var e=t.attrs;t.loadError=0,t.fragmentError=!1,o=o||!!t.videoCodec,l=l||!!t.audioCodec,Rt&&t.audioCodec&&-1!==t.audioCodec.indexOf("mp4a.40.34")&&(t.audioCodec=void 0),(a=i[t.bitrate])?a.url.push(t.url):(t.url=[t.url],t.urlId=0,i[t.bitrate]=t,r.push(t)),e&&(e.AUDIO&&(l=!0,X(a||t,"audio",e.AUDIO)),e.SUBTITLES&&X(a||t,"text",e.SUBTITLES))})),o&&l&&(r=r.filter((function(t){return!!t.videoCodec}))),r=r.filter((function(t){var e=t.audioCodec,r=t.videoCodec;return(!e||T(e,"audio"))&&(!r||T(r,"video"))})),t.audioTracks&&(n=t.audioTracks.filter((function(t){return!t.audioCodec||T(t.audioCodec,"audio")}))).forEach((function(t,e){t.id=e})),r.length>0){e=r[0].bitrate,r.sort((function(t,e){return t.bitrate-e.bitrate})),this._levels=r;for(var c=0;c<r.length;c++)if(r[c].bitrate===e){this._firstLevel=c,d.b.log("manifest loaded,"+r.length+" level(s) found, first bitrate:"+e);break}this.hls.trigger(u.a.MANIFEST_PARSED,{levels:r,audioTracks:n,firstLevel:this._firstLevel,stats:t.stats,audio:l,video:o,altAudio:n.some((function(t){return!!t.url}))})}else this.hls.trigger(u.a.ERROR,{type:s.b.MEDIA_ERROR,details:s.a.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:this.hls.url,reason:"no level with compatible codecs found in manifest"})},a.setLevelInternal=function(t){var e=this._levels,r=this.hls;if(t>=0&&t<e.length){if(this.clearTimer(),this.currentLevelIndex!==t){d.b.log("switching to level "+t),this.currentLevelIndex=t;var n=e[t];n.level=t,r.trigger(u.a.LEVEL_SWITCHING,n)}var i=e[t],a=i.details;if(!a||a.live){var o=i.urlId;r.trigger(u.a.LEVEL_LOADING,{url:i.url[o],level:t,id:o})}}else r.trigger(u.a.ERROR,{type:s.b.OTHER_ERROR,details:s.a.LEVEL_SWITCH_ERROR,level:t,fatal:!1,reason:"invalid level idx"})},a.onError=function(t){if(t.fatal)t.type===s.b.NETWORK_ERROR&&this.clearTimer();else{var e,r=!1,n=!1;switch(t.details){case s.a.FRAG_LOAD_ERROR:case s.a.FRAG_LOAD_TIMEOUT:case s.a.KEY_LOAD_ERROR:case s.a.KEY_LOAD_TIMEOUT:e=t.frag.level,n=!0;break;case s.a.LEVEL_LOAD_ERROR:case s.a.LEVEL_LOAD_TIMEOUT:e=t.context.level,r=!0;break;case s.a.REMUX_ALLOC_ERROR:e=t.level,r=!0}void 0!==e&&this.recoverLevel(t,e,r,n)}},a.recoverLevel=function(t,e,r,n){var i,a,o,s=this,l=this.hls.config,u=t.details,c=this._levels[e];if(c.loadError++,c.fragmentError=n,r){if(!(this.levelRetryCount+1<=l.levelLoadingMaxRetry))return d.b.error("level controller, cannot recover from "+u+" error"),this.currentLevelIndex=null,this.clearTimer(),void(t.fatal=!0);a=Math.min(Math.pow(2,this.levelRetryCount)*l.levelLoadingRetryDelay,l.levelLoadingMaxRetryTimeout),this.timer=setTimeout((function(){return s.loadLevel()}),a),t.levelRetry=!0,this.levelRetryCount++,d.b.warn("level controller, "+u+", retry in "+a+" ms, current retry count is "+this.levelRetryCount)}(r||n)&&((i=c.url.length)>1&&c.loadError<i?(c.urlId=(c.urlId+1)%i,c.details=void 0,d.b.warn("level controller, "+u+" for level "+e+": switching to redundant URL-id "+c.urlId)):-1===this.manualLevelIndex?(d.b.warn("level controller, "+u+": switch to "+(o=0===e?this._levels.length-1:e-1)),this.hls.nextAutoLevel=this.currentLevelIndex=o):n&&(d.b.warn("level controller, "+u+": reload a fragment"),this.currentLevelIndex=null))},a.onFragLoaded=function(t){var e=t.frag;if(void 0!==e&&"main"===e.type){var r=this._levels[e.level];void 0!==r&&(r.fragmentError=!1,r.loadError=0,this.levelRetryCount=0)}},a.onLevelLoaded=function(t){var e=this,r=t.level,n=t.details;if(r===this.currentLevelIndex){var i=this._levels[r];if(i.fragmentError||(i.loadError=0,this.levelRetryCount=0),n.live){var a=tt(i.details,n,t.stats.trequest);d.b.log("live playlist, reload in "+Math.round(a)+" ms"),this.timer=setTimeout((function(){return e.loadLevel()}),a)}else this.clearTimer()}},a.onAudioTrackSwitched=function(t){var e=this.hls.audioTracks[t.id].groupId,r=this.hls.levels[this.currentLevelIndex];if(r&&r.audioGroupIds){for(var n=-1,i=0;i<r.audioGroupIds.length;i++)if(r.audioGroupIds[i]===e){n=i;break}n!==r.urlId&&(r.urlId=n,this.startLoad())}},a.loadLevel=function(){if(d.b.debug("call to loadLevel"),null!==this.currentLevelIndex&&this.canload){var t=this._levels[this.currentLevelIndex];if("object"==typeof t&&t.url.length>0){var e=this.currentLevelIndex,r=t.urlId,n=t.url[r];d.b.log("Attempt loading level index "+e+" with URL-id "+r),this.hls.trigger(u.a.LEVEL_LOADING,{url:n,level:e,id:r})}}},(i=[{key:"levels",get:function(){return this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(t){var e=this._levels;e&&(t=Math.min(t,e.length-1),this.currentLevelIndex===t&&e[t].details||this.setLevelInternal(t))}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(t){this.manualLevelIndex=t,void 0===this._startLevel&&(this._startLevel=t),-1!==t&&(this.level=t)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(t){this._firstLevel=t}},{key:"startLevel",get:function(){if(void 0===this._startLevel){var t=this.hls.config.startLevel;return void 0!==t?t:this._firstLevel}return this._startLevel},set:function(t){this._startLevel=t}},{key:"nextLoadLevel",get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(t){this.level=t,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=t)}}])&&function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(n.prototype,i),n}(h),Dt=r(4);function kt(t,e){var r;try{r=new Event("addtrack")}catch(t){(r=document.createEvent("Event")).initEvent("addtrack",!1,!1)}r.track=t,e.dispatchEvent(r)}function Ot(t){if(t&&t.cues)for(;t.cues.length>0;)t.removeCue(t.cues[0])}var Nt=function(t){var e,r;function n(e){var r;return(r=t.call(this,e,u.a.MEDIA_ATTACHED,u.a.MEDIA_DETACHING,u.a.FRAG_PARSING_METADATA,u.a.LIVE_BACK_BUFFER_REACHED)||this).id3Track=void 0,r.media=void 0,r}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var i=n.prototype;return i.destroy=function(){h.prototype.destroy.call(this)},i.onMediaAttached=function(t){this.media=t.media},i.onMediaDetaching=function(){Ot(this.id3Track),this.id3Track=void 0,this.media=void 0},i.getID3Track=function(t){for(var e=0;e<t.length;e++){var r=t[e];if("metadata"===r.kind&&"id3"===r.label)return kt(r,this.media),r}return this.media.addTextTrack("metadata","id3")},i.onFragParsingMetadata=function(t){var e=t.frag,r=t.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var n=window.WebKitDataCue||window.VTTCue||window.TextTrackCue,i=0;i<r.length;i++){var a=Dt.a.getID3Frames(r[i].data);if(a){var o=r[i].pts,s=i<r.length-1?r[i+1].pts:e.endPTS;o===s?s+=1e-4:o>s&&(d.b.warn("detected an id3 sample with endTime < startTime, adjusting endTime to (startTime + 0.25)"),s=o+.25);for(var l=0;l<a.length;l++){var u=a[l];if(!Dt.a.isTimeStampFrame(u)){var c=new n(o,s,"");c.value=u,this.id3Track.addCue(c)}}}}},i.onLiveBackBufferReached=function(t){var e=this.id3Track;if(e&&e.cues&&e.cues.length){var r=function(t,e){if(e<t[0].endTime)return t[0];if(e>t[t.length-1].endTime)return t[t.length-1];for(var r=0,n=t.length-1;r<=n;){var i=Math.floor((n+r)/2);if(e<t[i].endTime)n=i-1;else{if(!(e>t[i].endTime))return t[i];r=i+1}}return t[r].endTime-e<e-t[n].endTime?t[r]:t[n]}(e.cues,t.bufferEnd);if(r)for(;e.cues[0]!==r;)e.removeCue(e.cues[0])}},n}(h),xt=function(){function t(t){this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.alpha_=t?Math.exp(Math.log(.5)/t):0,this.estimate_=0,this.totalWeight_=0}var e=t.prototype;return e.sample=function(t,e){var r=Math.pow(this.alpha_,t);this.estimate_=e*(1-r)+r*this.estimate_,this.totalWeight_+=t},e.getTotalWeight=function(){return this.totalWeight_},e.getEstimate=function(){if(this.alpha_){var t=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/t}return this.estimate_},t}(),It=function(){function t(t,e,r,n){this.hls=void 0,this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.hls=t,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new xt(e),this.fast_=new xt(r)}var e=t.prototype;return e.sample=function(t,e){var r=(t=Math.max(t,this.minDelayMs_))/1e3,n=8*e/r;this.fast_.sample(r,n),this.slow_.sample(r,n)},e.canEstimate=function(){var t=this.fast_;return t&&t.getTotalWeight()>=this.minWeight_},e.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},e.destroy=function(){},t}(),Pt=window.performance,Mt=function(t){var e,r;function n(e){var r;return(r=t.call(this,e,u.a.FRAG_LOADING,u.a.FRAG_LOADED,u.a.FRAG_BUFFERED,u.a.ERROR)||this).lastLoadedFragLevel=0,r._nextAutoLevel=-1,r.hls=e,r.timer=null,r._bwEstimator=null,r.onCheck=r._abandonRulesCheck.bind(function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(r)),r}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var i,a=n.prototype;return a.destroy=function(){this.clearTimer(),h.prototype.destroy.call(this)},a.onFragLoading=function(t){var e=t.frag;if("main"===e.type&&(this.timer||(this.fragCurrent=e,this.timer=setInterval(this.onCheck,100)),!this._bwEstimator)){var r,n,i=this.hls,a=i.config;i.levels[e.level].details.live?(r=a.abrEwmaFastLive,n=a.abrEwmaSlowLive):(r=a.abrEwmaFastVoD,n=a.abrEwmaSlowVoD),this._bwEstimator=new It(i,n,r,a.abrEwmaDefaultEstimate)}},a._abandonRulesCheck=function(){var t=this.hls,e=t.media,r=this.fragCurrent;if(r){var n=r.loader,i=t.minAutoLevel;if(!n||n.stats&&n.stats.aborted)return d.b.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),void(this._nextAutoLevel=-1);var a=n.stats;if(e&&a&&(!e.paused&&0!==e.playbackRate||!e.readyState)&&r.autoLevel&&r.level){var o=Pt.now()-a.trequest,s=Math.abs(e.playbackRate);if(o>500*r.duration/s){var l=t.levels,c=Math.max(1,a.bw?a.bw/8:1e3*a.loaded/o),h=l[r.level],f=h.realBitrate?Math.max(h.realBitrate,h.bitrate):h.bitrate,p=a.total?a.total:Math.max(a.loaded,Math.round(r.duration*f/8)),v=e.currentTime,g=(p-a.loaded)/c,m=(B.bufferInfo(e,v,t.config.maxBufferHole).end-v)/s;if(m<2*r.duration/s&&g>m){var y;for(y=r.level-1;y>i;y--){var _=l[y].realBitrate?Math.max(l[y].realBitrate,l[y].bitrate):l[y].bitrate;if(r.duration*_/(6.4*c)<m)break}void 0<g&&(d.b.warn("loading too slow, abort fragment loading and switch to level "+y+":fragLoadedDelay["+y+"]<fragLoadedDelay["+(r.level-1)+"];bufferStarvationDelay:"+(void 0).toFixed(1)+"<"+g.toFixed(1)+":"+m.toFixed(1)),t.nextLoadLevel=y,this._bwEstimator.sample(o,a.loaded),n.abort(),this.clearTimer(),t.trigger(u.a.FRAG_LOAD_EMERGENCY_ABORTED,{frag:r,stats:a}))}}}}},a.onFragLoaded=function(t){var e=t.frag;if("main"===e.type&&Object(l.a)(e.sn)){if(this.clearTimer(),this.lastLoadedFragLevel=e.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var r=this.hls.levels[e.level],n=(r.loaded?r.loaded.bytes:0)+t.stats.loaded,i=(r.loaded?r.loaded.duration:0)+t.frag.duration;r.loaded={bytes:n,duration:i},r.realBitrate=Math.round(8*n/i)}if(t.frag.bitrateTest){var a=t.stats;a.tparsed=a.tbuffered=a.tload,this.onFragBuffered(t)}}},a.onFragBuffered=function(t){var e=t.stats,r=t.frag;if(!0!==e.aborted&&"main"===r.type&&Object(l.a)(r.sn)&&(!r.bitrateTest||e.tload===e.tbuffered)){var n=e.tparsed-e.trequest;d.b.log("latency/loading/parsing/append/kbps:"+Math.round(e.tfirst-e.trequest)+"/"+Math.round(e.tload-e.tfirst)+"/"+Math.round(e.tparsed-e.tload)+"/"+Math.round(e.tbuffered-e.tparsed)+"/"+Math.round(8*e.loaded/(e.tbuffered-e.trequest))),this._bwEstimator.sample(n,e.loaded),e.bwEstimate=this._bwEstimator.getEstimate(),this.bitrateTestDelay=r.bitrateTest?n/1e3:0}},a.onError=function(t){switch(t.details){case s.a.FRAG_LOAD_ERROR:case s.a.FRAG_LOAD_TIMEOUT:this.clearTimer()}},a.clearTimer=function(){clearInterval(this.timer),this.timer=null},a._findBestLevel=function(t,e,r,n,i,a,o,s,l){for(var u=i;u>=n;u--){var c=l[u];if(c){var h,f=c.details,p=f?f.totalduration/f.fragments.length:e,v=!!f&&f.live;h=u<=t?o*r:s*r;var g=l[u].realBitrate?Math.max(l[u].realBitrate,l[u].bitrate):l[u].bitrate,m=g*p/h;if(d.b.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+u+"/"+Math.round(h)+"/"+g+"/"+p+"/"+a+"/"+m),h>g&&(!m||v&&!this.bitrateTestDelay||m<a))return u}}return-1},(i=[{key:"nextAutoLevel",get:function(){var t=this._nextAutoLevel,e=this._bwEstimator;if(!(-1===t||e&&e.canEstimate()))return t;var r=this._nextABRAutoLevel;return-1!==t&&(r=Math.min(t,r)),r},set:function(t){this._nextAutoLevel=t}},{key:"_nextABRAutoLevel",get:function(){var t=this.hls,e=t.maxAutoLevel,r=t.levels,n=t.config,i=t.minAutoLevel,a=t.media,o=this.lastLoadedFragLevel,s=this.fragCurrent?this.fragCurrent.duration:0,l=a?a.currentTime:0,u=a&&0!==a.playbackRate?Math.abs(a.playbackRate):1,c=this._bwEstimator?this._bwEstimator.getEstimate():n.abrEwmaDefaultEstimate,h=(B.bufferInfo(a,l,n.maxBufferHole).end-l)/u,f=this._findBestLevel(o,s,c,i,e,h,n.abrBandWidthFactor,n.abrBandWidthUpFactor,r);if(f>=0)return f;d.b.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var p=s?Math.min(s,n.maxStarvationDelay):n.maxStarvationDelay,v=n.abrBandWidthFactor,g=n.abrBandWidthUpFactor;if(0===h){var m=this.bitrateTestDelay;m&&(p=(s?Math.min(s,n.maxLoadingDelay):n.maxLoadingDelay)-m,d.b.trace("bitrate test took "+Math.round(1e3*m)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*p)+" ms"),v=g=1)}return f=this._findBestLevel(o,s,c,i,e,h+p,v,g,r),Math.max(f,0)}}])&&function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(n.prototype,i),n}(h),Ft=K(),Ut=function(t){var e,r;function n(e){var r;return(r=t.call(this,e,u.a.MEDIA_ATTACHING,u.a.MEDIA_DETACHING,u.a.MANIFEST_PARSED,u.a.BUFFER_RESET,u.a.BUFFER_APPENDING,u.a.BUFFER_CODECS,u.a.BUFFER_EOS,u.a.BUFFER_FLUSHING,u.a.LEVEL_PTS_UPDATED,u.a.LEVEL_UPDATED)||this)._msDuration=null,r._levelDuration=null,r._levelTargetDuration=10,r._live=null,r._objectUrl=null,r._needsFlush=!1,r._needsEos=!1,r.config=void 0,r.audioTimestampOffset=void 0,r.bufferCodecEventsExpected=0,r._bufferCodecEventsTotal=0,r.media=null,r.mediaSource=null,r.segments=[],r.parent=void 0,r.appending=!1,r.appended=0,r.appendError=0,r.flushBufferCounter=0,r.tracks={},r.pendingTracks={},r.sourceBuffer={},r.flushRange=[],r._onMediaSourceOpen=function(){d.b.log("media source opened"),r.hls.trigger(u.a.MEDIA_ATTACHED,{media:r.media});var t=r.mediaSource;t&&t.removeEventListener("sourceopen",r._onMediaSourceOpen),r.checkPendingTracks()},r._onMediaSourceClose=function(){d.b.log("media source closed")},r._onMediaSourceEnded=function(){d.b.log("media source ended")},r._onSBUpdateEnd=function(){if(r.audioTimestampOffset&&r.sourceBuffer.audio){var t=r.sourceBuffer.audio;d.b.warn("change mpeg audio timestamp offset from "+t.timestampOffset+" to "+r.audioTimestampOffset),t.timestampOffset=r.audioTimestampOffset,delete r.audioTimestampOffset}r._needsFlush&&r.doFlush(),r._needsEos&&r.checkEos(),r.appending=!1;var e=r.parent,n=r.segments.reduce((function(t,r){return r.parent===e?t+1:t}),0),i={},a=r.sourceBuffer;for(var o in a){var s=a[o];if(!s)throw Error("handling source buffer update end error: source buffer for "+o+" uninitilized and unable to update buffered TimeRanges.");i[o]=s.buffered}r.hls.trigger(u.a.BUFFER_APPENDED,{parent:e,pending:n,timeRanges:i}),r._needsFlush||r.doAppending(),r.updateMediaElementDuration(),0===n&&r.flushLiveBackBuffer()},r._onSBUpdateError=function(t){d.b.error("sourceBuffer error:",t),r.hls.trigger(u.a.ERROR,{type:s.b.MEDIA_ERROR,details:s.a.BUFFER_APPENDING_ERROR,fatal:!1})},r.config=e.config,r}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var i=n.prototype;return i.destroy=function(){h.prototype.destroy.call(this)},i.onLevelPtsUpdated=function(t){var e=this.tracks.audio;if("audio"===t.type&&e&&"audio/mpeg"===e.container){var r=this.sourceBuffer.audio;if(!r)throw Error("Level PTS Updated and source buffer for audio uninitalized");if(Math.abs(r.timestampOffset-t.start)>.1){var n=r.updating;try{r.abort()}catch(t){d.b.warn("can not abort audio buffer: "+t)}n?this.audioTimestampOffset=t.start:(d.b.warn("change mpeg audio timestamp offset from "+r.timestampOffset+" to "+t.start),r.timestampOffset=t.start)}}},i.onManifestParsed=function(t){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=t.altAudio?2:1,d.b.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},i.onMediaAttaching=function(t){var e=this.media=t.media;if(e&&Ft){var r=this.mediaSource=new Ft;r.addEventListener("sourceopen",this._onMediaSourceOpen),r.addEventListener("sourceended",this._onMediaSourceEnded),r.addEventListener("sourceclose",this._onMediaSourceClose),e.src=window.URL.createObjectURL(r),this._objectUrl=e.src}},i.onMediaDetaching=function(){d.b.log("media source detaching");var t=this.mediaSource;if(t){if("open"===t.readyState)try{t.endOfStream()}catch(t){d.b.warn("onMediaDetaching:"+t.message+" while calling endOfStream")}t.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("sourceended",this._onMediaSourceEnded),t.removeEventListener("sourceclose",this._onMediaSourceClose),this.media&&(this._objectUrl&&window.URL.revokeObjectURL(this._objectUrl),this.media.src===this._objectUrl?(this.media.removeAttribute("src"),this.media.load()):d.b.warn("media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.hls.trigger(u.a.MEDIA_DETACHED)},i.checkPendingTracks=function(){var t=this.bufferCodecEventsExpected,e=this.pendingTracks,r=Object.keys(e).length;(r&&!t||2===r)&&(this.createSourceBuffers(e),this.pendingTracks={},this.doAppending())},i.onBufferReset=function(){var t=this.sourceBuffer;for(var e in t){var r=t[e];try{r&&(this.mediaSource&&this.mediaSource.removeSourceBuffer(r),r.removeEventListener("updateend",this._onSBUpdateEnd),r.removeEventListener("error",this._onSBUpdateError))}catch(t){}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0},i.onBufferCodecs=function(t){var e=this;Object.keys(this.sourceBuffer).length||(Object.keys(t).forEach((function(r){e.pendingTracks[r]=t[r]})),this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks())},i.createSourceBuffers=function(t){var e=this.sourceBuffer,r=this.mediaSource;if(!r)throw Error("createSourceBuffers called when mediaSource was null");for(var n in t)if(!e[n]){var i=t[n];if(!i)throw Error("source buffer exists for track "+n+", however track does not");var a=i.levelCodec||i.codec,o=i.container+";codecs="+a;d.b.log("creating sourceBuffer("+o+")");try{var l=e[n]=r.addSourceBuffer(o);l.addEventListener("updateend",this._onSBUpdateEnd),l.addEventListener("error",this._onSBUpdateError),this.tracks[n]={buffer:l,codec:a,id:i.id,container:i.container,levelCodec:i.levelCodec}}catch(t){d.b.error("error while trying to add sourceBuffer:"+t.message),this.hls.trigger(u.a.ERROR,{type:s.b.MEDIA_ERROR,details:s.a.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:t,mimeType:o})}}this.hls.trigger(u.a.BUFFER_CREATED,{tracks:this.tracks})},i.onBufferAppending=function(t){this._needsFlush||(this.segments?this.segments.push(t):this.segments=[t],this.doAppending())},i.onBufferEos=function(t){for(var e in this.sourceBuffer)if(!t.type||t.type===e){var r=this.sourceBuffer[e];r&&!r.ended&&(r.ended=!0,d.b.log(e+" sourceBuffer now EOS"))}this.checkEos()},i.checkEos=function(){var t=this.sourceBuffer,e=this.mediaSource;if(e&&"open"===e.readyState){for(var r in t){var n=t[r];if(n){if(!n.ended)return;if(n.updating)return void(this._needsEos=!0)}}d.b.log("all media data are available, signal endOfStream() to MediaSource and stop loading fragment");try{e.endOfStream()}catch(t){d.b.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1}else this._needsEos=!1},i.onBufferFlushing=function(t){t.type?this.flushRange.push({start:t.startOffset,end:t.endOffset,type:t.type}):(this.flushRange.push({start:t.startOffset,end:t.endOffset,type:"video"}),this.flushRange.push({start:t.startOffset,end:t.endOffset,type:"audio"})),this.flushBufferCounter=0,this.doFlush()},i.flushLiveBackBuffer=function(){if(this._live){var t=this.config.liveBackBufferLength;if(isFinite(t)&&!(t<0))if(this.media)for(var e=this.media.currentTime,r=this.sourceBuffer,n=Object.keys(r),i=e-Math.max(t,this._levelTargetDuration),a=n.length-1;a>=0;a--){var o=n[a],s=r[o];if(s){var l=s.buffered;l.length>0&&i>l.start(0)&&this.removeBufferRange(o,s,0,i)&&this.hls.trigger(u.a.LIVE_BACK_BUFFER_REACHED,{bufferEnd:i})}}else d.b.error("flushLiveBackBuffer called without attaching media")}},i.onLevelUpdated=function(t){var e=t.details;e.fragments.length>0&&(this._levelDuration=e.totalduration+e.fragments[0].start,this._levelTargetDuration=e.averagetargetduration||e.targetduration||10,this._live=e.live,this.updateMediaElementDuration())},i.updateMediaElementDuration=function(){var t,e=this.config;if(null!==this._levelDuration&&this.media&&this.mediaSource&&this.sourceBuffer&&0!==this.media.readyState&&"open"===this.mediaSource.readyState){for(var r in this.sourceBuffer){var n=this.sourceBuffer[r];if(n&&!0===n.updating)return}t=this.media.duration,null===this._msDuration&&(this._msDuration=this.mediaSource.duration),!0===this._live&&!0===e.liveDurationInfinity?(d.b.log("Media Source duration is set to Infinity"),this._msDuration=this.mediaSource.duration=1/0):(this._levelDuration>this._msDuration&&this._levelDuration>t||!Object(l.a)(t))&&(d.b.log("Updating Media Source duration to "+this._levelDuration.toFixed(3)),this._msDuration=this.mediaSource.duration=this._levelDuration)}},i.doFlush=function(){for(;this.flushRange.length;){var t=this.flushRange[0];if(!this.flushBuffer(t.start,t.end,t.type))return void(this._needsFlush=!0);this.flushRange.shift(),this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var e=0,r=this.sourceBuffer;try{for(var n in r){var i=r[n];i&&(e+=i.buffered.length)}}catch(t){d.b.error("error while accessing sourceBuffer.buffered")}this.appended=e,this.hls.trigger(u.a.BUFFER_FLUSHED)}},i.doAppending=function(){var t=this.config,e=this.hls,r=this.segments,n=this.sourceBuffer;if(Object.keys(n).length){if(!this.media||this.media.error)return this.segments=[],void d.b.error("trying to append although a media error occured, flush segment and abort");if(!this.appending){var i=r.shift();if(i)try{var a=n[i.type];if(!a)return void this._onSBUpdateEnd();if(a.updating)return void r.unshift(i);a.ended=!1,this.parent=i.parent,a.appendBuffer(i.data),this.appendError=0,this.appended++,this.appending=!0}catch(n){d.b.error("error while trying to append buffer:"+n.message),r.unshift(i);var o={type:s.b.MEDIA_ERROR,parent:i.parent,details:"",fatal:!1};22===n.code?(this.segments=[],o.details=s.a.BUFFER_FULL_ERROR):(this.appendError++,o.details=s.a.BUFFER_APPEND_ERROR,this.appendError>t.appendErrorMaxRetry&&(d.b.log("fail "+t.appendErrorMaxRetry+" times to append segment in sourceBuffer"),this.segments=[],o.fatal=!0)),e.trigger(u.a.ERROR,o)}}}},i.flushBuffer=function(t,e,r){var n=this.sourceBuffer;if(!Object.keys(n).length)return!0;var i="null";if(this.media&&(i=this.media.currentTime.toFixed(3)),d.b.log("flushBuffer,pos/start/end: "+i+"/"+t+"/"+e),this.flushBufferCounter>=this.appended)return d.b.warn("abort flushing too many retries"),!0;var a=n[r];if(a){if(a.ended=!1,a.updating)return d.b.warn("cannot flush, sb updating in progress"),!1;if(this.removeBufferRange(r,a,t,e))return this.flushBufferCounter++,!1}return d.b.log("buffer flushed"),!0},i.removeBufferRange=function(t,e,r,n){try{for(var i=0;i<e.buffered.length;i++){var a=e.buffered.start(i),o=e.buffered.end(i),s=Math.max(a,r),l=Math.min(o,n);if(Math.min(l,o)-s>.5){var u="null";return this.media&&(u=this.media.currentTime.toString()),d.b.log("sb remove "+t+" ["+s+","+l+"], of ["+a+","+o+"], pos:"+u),e.remove(s,l),!0}}}catch(t){d.b.warn("removeBufferRange failed",t)}return!1},n}(h);function Bt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var jt=function(t){var e,r;function n(e){var r;return(r=t.call(this,e,u.a.FPS_DROP_LEVEL_CAPPING,u.a.MEDIA_ATTACHING,u.a.MANIFEST_PARSED,u.a.BUFFER_CODECS,u.a.MEDIA_DETACHING)||this).autoLevelCapping=Number.POSITIVE_INFINITY,r.firstLevel=null,r.levels=[],r.media=null,r.restrictedLevels=[],r.timer=null,r}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var i,a,o,s=n.prototype;return s.destroy=function(){this.hls.config.capLevelToPlayerSize&&(this.media=null,this.stopCapping())},s.onFpsDropLevelCapping=function(t){n.isLevelAllowed(t.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(t.droppedLevel)},s.onMediaAttaching=function(t){this.media=t.media instanceof window.HTMLVideoElement?t.media:null},s.onManifestParsed=function(t){var e=this.hls;this.restrictedLevels=[],this.levels=t.levels,this.firstLevel=t.firstLevel,e.config.capLevelToPlayerSize&&t.video&&this.startCapping()},s.onBufferCodecs=function(t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()},s.onLevelsUpdated=function(t){this.levels=t.levels},s.onMediaDetaching=function(){this.stopCapping()},s.detectPlayerSize=function(){if(this.media){var t=this.levels?this.levels.length:0;if(t){var e=this.hls;e.autoLevelCapping=this.getMaxLevel(t-1),e.autoLevelCapping>this.autoLevelCapping&&e.streamController.nextLevelSwitch(),this.autoLevelCapping=e.autoLevelCapping}}},s.getMaxLevel=function(t){var e=this;if(!this.levels)return-1;var r=this.levels.filter((function(r,i){return n.isLevelAllowed(i,e.restrictedLevels)&&i<=t}));return n.getMaxLevelByMediaSize(r,this.mediaWidth,this.mediaHeight)},s.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},s.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=null,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer),this.timer=null)},n.isLevelAllowed=function(t,e){return void 0===e&&(e=[]),-1===e.indexOf(t)},n.getMaxLevelByMediaSize=function(t,e,r){if(!t||t&&!t.length)return-1;for(var n,i,a=t.length-1,o=0;o<t.length;o+=1){var s=t[o];if((s.width>=e||s.height>=r)&&(n=s,!(i=t[o+1])||n.width!==i.width||n.height!==i.height)){a=o;break}}return a},i=n,o=[{key:"contentScaleFactor",get:function(){var t=1;try{t=window.devicePixelRatio}catch(t){}return t}}],(a=[{key:"mediaWidth",get:function(){var t,e=this.media;return e&&(t=e.width||e.clientWidth||e.offsetWidth,t*=n.contentScaleFactor),t}},{key:"mediaHeight",get:function(){var t,e=this.media;return e&&(t=e.height||e.clientHeight||e.offsetHeight,t*=n.contentScaleFactor),t}}])&&Bt(i.prototype,a),o&&Bt(i,o),n}(h),Gt=window.performance,Ht=function(t){var e,r;function n(e){return t.call(this,e,u.a.MEDIA_ATTACHING)||this}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var i=n.prototype;return i.destroy=function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1},i.onMediaAttaching=function(t){var e=this.hls.config;e.capLevelOnFPSDrop&&("function"==typeof(this.video=t.media instanceof window.HTMLVideoElement?t.media:null).getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),e.fpsDroppedMonitoringPeriod))},i.checkFPS=function(t,e,r){var n=Gt.now();if(e){if(this.lastTime){var i=r-this.lastDroppedFrames,a=e-this.lastDecodedFrames,o=1e3*i/(n-this.lastTime),s=this.hls;if(s.trigger(u.a.FPS_DROP,{currentDropped:i,currentDecoded:a,totalDroppedFrames:r}),o>0&&i>s.config.fpsDroppedMonitoringThreshold*a){var l=s.currentLevel;d.b.warn("drop FPS ratio greater than max allowed value for currentLevel: "+l),l>0&&(-1===s.autoLevelCapping||s.autoLevelCapping>=l)&&(s.trigger(u.a.FPS_DROP_LEVEL_CAPPING,{level:l-=1,droppedLevel:s.currentLevel}),s.autoLevelCapping=l,s.streamController.nextLevelSwitch())}}this.lastTime=n,this.lastDroppedFrames=r,this.lastDecodedFrames=e}},i.checkFPSInterval=function(){var t=this.video;if(t)if(this.isVideoPlaybackQualityAvailable){var e=t.getVideoPlaybackQuality();this.checkFPS(t,e.totalVideoFrames,e.droppedVideoFrames)}else this.checkFPS(t,t.webkitDecodedFrameCount,t.webkitDroppedFrameCount)},n}(h),Kt=window,Vt=Kt.performance,Wt=Kt.XMLHttpRequest,qt=function(){function t(t){t&&t.xhrSetup&&(this.xhrSetup=t.xhrSetup)}var e=t.prototype;return e.destroy=function(){this.abort(),this.loader=null},e.abort=function(){var t=this.loader;t&&4!==t.readyState&&(this.stats.aborted=!0,t.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null},e.load=function(t,e,r){this.context=t,this.config=e,this.callbacks=r,this.stats={trequest:Vt.now(),retry:0},this.retryDelay=e.retryDelay,this.loadInternal()},e.loadInternal=function(){var t,e=this.context;t=this.loader=new Wt;var r=this.stats;r.tfirst=0,r.loaded=0;var n=this.xhrSetup;try{if(n)try{n(t,e.url)}catch(r){t.open("GET",e.url,!0),n(t,e.url)}t.readyState||t.open("GET",e.url,!0)}catch(r){return void this.callbacks.onError({code:t.status,text:r.message},e,t)}e.rangeEnd&&t.setRequestHeader("Range","bytes="+e.rangeStart+"-"+(e.rangeEnd-1)),t.onreadystatechange=this.readystatechange.bind(this),t.onprogress=this.loadprogress.bind(this),t.responseType=e.responseType,this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),t.send()},e.readystatechange=function(t){var e=t.currentTarget,r=e.readyState,n=this.stats,i=this.context,a=this.config;if(!n.aborted&&r>=2)if(window.clearTimeout(this.requestTimeout),0===n.tfirst&&(n.tfirst=Math.max(Vt.now(),n.trequest)),4===r){var o,s,l=e.status;l>=200&&l<300?(n.tload=Math.max(n.tfirst,Vt.now()),s="arraybuffer"===i.responseType?(o=e.response).byteLength:(o=e.responseText).length,n.loaded=n.total=s,this.callbacks.onSuccess({url:e.responseURL,data:o},n,i,e)):n.retry>=a.maxRetry||l>=400&&l<499?(d.b.error(l+" while loading "+i.url),this.callbacks.onError({code:l,text:e.statusText},i,e)):(d.b.warn(l+" while loading "+i.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,a.maxRetryDelay),n.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),a.timeout)},e.loadtimeout=function(){d.b.warn("timeout while loading "+this.context.url),this.callbacks.onTimeout(this.stats,this.context,null)},e.loadprogress=function(t){var e=t.currentTarget,r=this.stats;r.loaded=t.loaded,t.lengthComputable&&(r.total=t.total);var n=this.callbacks.onProgress;n&&n(r,this.context,null,e)},t}(),Yt=function(t){var e,r;function n(e){var r;return(r=t.call(this,e,u.a.MANIFEST_LOADING,u.a.MANIFEST_PARSED,u.a.AUDIO_TRACK_LOADED,u.a.AUDIO_TRACK_SWITCHED,u.a.LEVEL_LOADED,u.a.ERROR)||this)._trackId=-1,r._selectDefaultTrack=!0,r.tracks=[],r.trackIdBlacklist=Object.create(null),r.audioGroupId=null,r}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var i,a=n.prototype;return a.onManifestLoading=function(){this.tracks=[],this._trackId=-1,this._selectDefaultTrack=!0},a.onManifestParsed=function(t){var e=this.tracks=t.audioTracks||[];this.hls.trigger(u.a.AUDIO_TRACKS_UPDATED,{audioTracks:e}),this._selectAudioGroup(this.hls.nextLoadLevel)},a.onAudioTrackLoaded=function(t){t.id>=this.tracks.length?d.b.warn("Invalid audio track id:",t.id):(d.b.log("audioTrack "+t.id+" loaded"),this.tracks[t.id].details=t.details,t.details.live&&!this.hasInterval()&&this.setInterval(1e3*t.details.targetduration),!t.details.live&&this.hasInterval()&&this.clearInterval())},a.onAudioTrackSwitched=function(t){var e=this.tracks[t.id].groupId;e&&this.audioGroupId!==e&&(this.audioGroupId=e)},a.onLevelLoaded=function(t){this._selectAudioGroup(t.level)},a.onError=function(t){t.type===s.b.NETWORK_ERROR&&(t.fatal&&this.clearInterval(),t.details===s.a.AUDIO_TRACK_LOAD_ERROR&&(d.b.warn("Network failure on audio-track id:",t.context.id),this._handleLoadError()))},a._setAudioTrack=function(t){if(this._trackId===t&&this.tracks[this._trackId].details)d.b.debug("Same id as current audio-track passed, and track details available -> no-op");else if(t<0||t>=this.tracks.length)d.b.warn("Invalid id passed to audio-track controller");else{var e=this.tracks[t];d.b.log("Now switching to audio-track index "+t),this.clearInterval(),this._trackId=t,this.hls.trigger(u.a.AUDIO_TRACK_SWITCHING,{id:e.id,type:e.type,url:e.url}),this._loadTrackDetailsIfNeeded(e)}},a.doTick=function(){this._updateTrack(this._trackId)},a._selectAudioGroup=function(t){var e=this.hls.levels[t];if(e&&e.audioGroupIds){var r=e.audioGroupIds[e.urlId];this.audioGroupId!==r&&(this.audioGroupId=r,this._selectInitialAudioTrack())}},a._selectInitialAudioTrack=function(){var t=this,e=this.tracks;if(e.length){var r=this.tracks[this._trackId],n=null;if(r&&(n=r.name),this._selectDefaultTrack){var i=e.filter((function(t){return t.default}));i.length?e=i:d.b.warn("No default audio tracks defined")}var a=!1,o=function(){e.forEach((function(e){a||t.audioGroupId&&e.groupId!==t.audioGroupId||n&&n!==e.name||(t._setAudioTrack(e.id),a=!0)}))};o(),a||(n=null,o()),a||(d.b.error("No track found for running audio group-ID: "+this.audioGroupId),this.hls.trigger(u.a.ERROR,{type:s.b.MEDIA_ERROR,details:s.a.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))}},a._needsTrackLoading=function(t){var e=t.details;return!(e&&!e.live||!t.url)},a._loadTrackDetailsIfNeeded=function(t){if(this._needsTrackLoading(t)){var e=t.url,r=t.id;d.b.log("loading audio-track playlist for id: "+r),this.hls.trigger(u.a.AUDIO_TRACK_LOADING,{url:e,id:r})}},a._updateTrack=function(t){t<0||t>=this.tracks.length||(this.clearInterval(),this._trackId=t,d.b.log("trying to update audio-track "+t),this._loadTrackDetailsIfNeeded(this.tracks[t]))},a._handleLoadError=function(){this.trackIdBlacklist[this._trackId]=!0;var t=this._trackId,e=this.tracks[t],r=e.name,n=e.language;d.b.warn("Loading failed on audio track id: "+t+", group-id: "+e.groupId+', name/language: "'+r+'" / "'+n+'"');for(var i=t,a=0;a<this.tracks.length;a++)if(!this.trackIdBlacklist[a]&&this.tracks[a].name===r){i=a;break}i!==t?(d.b.log("Attempting audio-track fallback id:",i,"group-id:",this.tracks[i].groupId),this._setAudioTrack(i)):d.b.warn('No fallback audio-track found for name/language: "'+r+'" / "'+n+'"')},(i=[{key:"audioTracks",get:function(){return this.tracks}},{key:"audioTrack",get:function(){return this._trackId},set:function(t){this._setAudioTrack(t),this._selectDefaultTrack=!1}}])&&function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(n.prototype,i),n}(dt),zt=window.performance,Xt=function(t){var e,r;function n(e,r){var n;return(n=t.call(this,e,u.a.MEDIA_ATTACHED,u.a.MEDIA_DETACHING,u.a.AUDIO_TRACKS_UPDATED,u.a.AUDIO_TRACK_SWITCHING,u.a.AUDIO_TRACK_LOADED,u.a.KEY_LOADED,u.a.FRAG_LOADED,u.a.FRAG_PARSING_INIT_SEGMENT,u.a.FRAG_PARSING_DATA,u.a.FRAG_PARSED,u.a.ERROR,u.a.BUFFER_RESET,u.a.BUFFER_CREATED,u.a.BUFFER_APPENDED,u.a.BUFFER_FLUSHED,u.a.INIT_PTS_FOUND)||this).fragmentTracker=r,n.config=e.config,n.audioCodecSwap=!1,n._state=ct,n.initPTS=[],n.waitingFragment=null,n.videoTrackCC=null,n}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var i,a=n.prototype;return a.onInitPtsFound=function(t){var e=t.frag.cc,r=t.initPTS;"main"===t.id&&(this.initPTS[e]=r,this.videoTrackCC=e,d.b.log("InitPTS for cc: "+e+" found from video track: "+r),this.state===St&&this.tick())},a.startLoad=function(t){if(this.tracks){var e=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),this.fragLoadError=0,e>0&&-1===t?(d.b.log("audio:override startPosition with lastCurrentTime @"+e.toFixed(3)),this.state=ft):(this.lastCurrentTime=this.startPosition?this.startPosition:t,this.state=ht),this.nextLoadPosition=this.startPosition=this.lastCurrentTime,this.tick()}else this.startPosition=t,this.state=ct},a.doTick=function(){var t,e,r,n=this.hls,i=n.config;switch(this.state){case Tt:case"PAUSED":case bt:break;case ht:this.state=mt,this.loadedmetadata=!1;break;case ft:var a=this.tracks;if(!a)break;if(!this.media&&(this.startFragRequested||!i.startFragPrefetch))break;if(this.loadedmetadata)t=this.media.currentTime;else if(void 0===(t=this.nextLoadPosition))break;var o=this.mediaBuffer?this.mediaBuffer:this.media,s=this.videoBuffer?this.videoBuffer:this.media,c=B.bufferInfo(o,t,i.maxBufferHole),h=B.bufferInfo(s,t,i.maxBufferHole),f=c.len,p=c.end,v=this.fragPrevious,g=Math.min(i.maxBufferLength,i.maxMaxBufferLength),m=Math.max(g,h.len),y=this.audioSwitch,_=this.trackId;if((f<m||y)&&_<a.length){if(void 0===(r=a[_].details)){this.state=mt;break}if(!y&&this._streamEnded(c,r))return this.hls.trigger(u.a.BUFFER_EOS,{type:"audio"}),void(this.state=Et);var b,E=r.fragments,T=E.length,S=E[0].start,w=E[T-1].start+E[T-1].duration;if(y)if(r.live&&!r.PTSKnown)d.b.log("switching audiotrack, live stream, unknown PTS,load first fragment"),p=0;else if(p=t,r.PTSKnown&&t<S){if(!(c.end>S||c.nextStart))return;d.b.log("alt audio track ahead of main track, seek to start of alt audio track"),this.media.currentTime=S+.05}if(r.initSegment&&!r.initSegment.data)b=r.initSegment;else if(p<=S){if(b=E[0],null!==this.videoTrackCC&&b.cc!==this.videoTrackCC&&(b=function(t,e){return U(t,(function(t){return t.cc<e?1:t.cc>e?-1:0}))}(E,this.videoTrackCC)),r.live&&b.loadIdx&&b.loadIdx===this.fragLoadIdx){var A=c.nextStart?c.nextStart:S;return d.b.log("no alt audio available @currentTime:"+this.media.currentTime+", seeking @"+(A+.05)),void(this.media.currentTime=A+.05)}}else{var C,R=i.maxFragLookUpTolerance,L=v?E[v.sn-E[0].sn+1]:void 0,D=function(t){var e=Math.min(R,t.duration);return t.start+t.duration-e<=p?1:t.start-e>p&&t.start?-1:0};p<w?(p>w-R&&(R=0),C=L&&!D(L)?L:U(E,D)):C=E[T-1],C&&(b=C,S=C.start,v&&b.level===v.level&&b.sn===v.sn&&(b.sn<r.endSN?d.b.log("SN just loaded, load next one: "+(b=E[b.sn+1-r.startSN]).sn):b=null))}b&&(b.encrypted?(d.b.log("Loading key for "+b.sn+" of ["+r.startSN+" ,"+r.endSN+"],track "+_),this.state=pt,n.trigger(u.a.KEY_LOADING,{frag:b})):(d.b.log("Loading "+b.sn+", cc: "+b.cc+" of ["+r.startSN+" ,"+r.endSN+"],track "+_+", currentTime:"+t+",bufferEnd:"+p.toFixed(3)),this.fragCurrent=b,(y||this.fragmentTracker.getState(b)===I)&&("initSegment"!==b.sn&&(this.startFragRequested=!0),Object(l.a)(b.sn)&&(this.nextLoadPosition=b.start+b.duration),n.trigger(u.a.FRAG_LOADING,{frag:b}),this.state=vt)))}break;case mt:(e=this.tracks[this.trackId])&&e.details&&(this.state=ft);break;case gt:var k=zt.now(),O=this.retryDate,N=(o=this.media)&&o.seeking;(!O||k>=O||N)&&(d.b.log("audioStreamController: retryDate reached, switch back to IDLE state"),this.state=ft);break;case St:var x=this.videoTrackCC;if(void 0===this.initPTS[x])break;var P=this.waitingFragment;if(P){var M=P.frag.cc;x!==M?(e=this.tracks[this.trackId]).details&&e.details.live&&(d.b.warn("Waiting fragment CC ("+M+") does not match video track CC ("+x+")"),this.waitingFragment=null,this.state=ft):(this.state=vt,this.onFragLoaded(this.waitingFragment),this.waitingFragment=null)}else this.state=ft}},a.onMediaAttached=function(t){var e=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),e.addEventListener("seeking",this.onvseeking),e.addEventListener("ended",this.onvended);var r=this.config;this.tracks&&r.autoStartLoad&&this.startLoad(r.startPosition)},a.onMediaDetaching=function(){var t=this.media;t&&t.ended&&(d.b.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),t&&(t.removeEventListener("seeking",this.onvseeking),t.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},a.onAudioTracksUpdated=function(t){d.b.log("audio tracks updated"),this.tracks=t.audioTracks},a.onAudioTrackSwitching=function(t){var e=!!t.url;this.trackId=t.id,this.fragCurrent=null,this.state="PAUSED",this.waitingFragment=null,e?this.setInterval(100):this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),e&&(this.audioSwitch=!0,this.state=ft),this.tick()},a.onAudioTrackLoaded=function(t){var e=t.details,r=t.id,n=this.tracks[r],i=0;if(d.b.log("track "+r+" loaded ["+e.startSN+","+e.endSN+"],duration:"+e.totalduration),e.live){var a=n.details;a&&e.fragments.length>0?(Z(a,e),i=e.fragments[0].start,d.b.log(e.PTSKnown?"live audio playlist sliding:"+i.toFixed(3):"live audio playlist - outdated PTS, unknown sliding")):(e.PTSKnown=!1,d.b.log("live audio playlist - first load, unknown sliding"))}else e.PTSKnown=!1;if(n.details=e,!this.startFragRequested){if(-1===this.startPosition){var o=e.startTimeOffset;Object(l.a)(o)?(d.b.log("start time offset found in playlist, adjust startPosition to "+o),this.startPosition=o):e.live?(this.startPosition=this.computeLivePosition(i,e),d.b.log("compute startPosition for audio-track to "+this.startPosition)):this.startPosition=0}this.nextLoadPosition=this.startPosition}this.state===mt&&(this.state=ft),this.tick()},a.onKeyLoaded=function(){this.state===pt&&(this.state=ft,this.tick())},a.onFragLoaded=function(t){var e=this.fragCurrent,r=t.frag;if(this.state===vt&&e&&"audio"===r.type&&r.level===e.level&&r.sn===e.sn){var n=this.tracks[this.trackId],i=n.details,a=i.totalduration,o=e.level,s=e.sn,l=e.cc,c=this.config.defaultAudioCodec||n.audioCodec||"mp4a.40.2",h=this.stats=t.stats;if("initSegment"===s)this.state=ft,h.tparsed=h.tbuffered=zt.now(),i.initSegment.data=t.payload,this.hls.trigger(u.a.FRAG_BUFFERED,{stats:h,frag:e,id:"audio"}),this.tick();else{this.state=yt,this.appended=!1,this.demuxer||(this.demuxer=new z(this.hls,"audio"));var f=this.initPTS[l],p=i.initSegment?i.initSegment.data:[];i.initSegment||void 0!==f?(this.pendingBuffering=!0,d.b.log("Demuxing "+s+" of ["+i.startSN+" ,"+i.endSN+"],track "+o),this.demuxer.push(t.payload,p,c,null,e,a,!1,f)):(d.b.log("unknown video PTS for continuity counter "+l+", waiting for video PTS before demuxing audio frag "+s+" of ["+i.startSN+" ,"+i.endSN+"],track "+o),this.waitingFragment=t,this.state=St)}}this.fragLoadError=0},a.onFragParsingInitSegment=function(t){var e=this.fragCurrent,r=t.frag;if(e&&"audio"===t.id&&r.sn===e.sn&&r.level===e.level&&this.state===yt){var n,i=t.tracks;if(i.video&&delete i.video,n=i.audio){n.levelCodec=n.codec,n.id=t.id,this.hls.trigger(u.a.BUFFER_CODECS,i),d.b.log("audio track:audio,container:"+n.container+",codecs[level/parsed]=["+n.levelCodec+"/"+n.codec+"]");var a=n.initSegment;if(a){var o={type:"audio",data:a,parent:"audio",content:"initSegment"};this.audioSwitch?this.pendingData=[o]:(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(u.a.BUFFER_APPENDING,o))}this.tick()}}},a.onFragParsingData=function(t){var e=this,r=this.fragCurrent,n=t.frag;if(r&&"audio"===t.id&&"audio"===t.type&&n.sn===r.sn&&n.level===r.level&&this.state===yt){var i=this.trackId,a=this.tracks[i],o=this.hls;Object(l.a)(t.endPTS)||(t.endPTS=t.startPTS+r.duration,t.endDTS=t.startDTS+r.duration),r.addElementaryStream(f.AUDIO),d.b.log("parsed "+t.type+",PTS:["+t.startPTS.toFixed(3)+","+t.endPTS.toFixed(3)+"],DTS:["+t.startDTS.toFixed(3)+"/"+t.endDTS.toFixed(3)+"],nb:"+t.nb),J(a.details,r,t.startPTS,t.endPTS);var c=this.media,h=!1;if(this.audioSwitch)if(c&&c.readyState){var p=c.currentTime;d.b.log("switching audio track : currentTime:"+p),p>=t.startPTS&&(d.b.log("switching audio track : flushing all audio"),this.state=bt,o.trigger(u.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),h=!0,this.audioSwitch=!1,o.trigger(u.a.AUDIO_TRACK_SWITCHED,{id:i}))}else this.audioSwitch=!1,o.trigger(u.a.AUDIO_TRACK_SWITCHED,{id:i});var v=this.pendingData;if(!v)return d.b.warn("Apparently attempt to enqueue media payload without codec initialization data upfront"),void o.trigger(u.a.ERROR,{type:s.b.MEDIA_ERROR,details:null,fatal:!0});this.audioSwitch||([t.data1,t.data2].forEach((function(e){e&&e.length&&v.push({type:t.type,data:e,parent:"audio",content:"data"})})),!h&&v.length&&(v.forEach((function(t){e.state===yt&&(e.pendingBuffering=!0,e.hls.trigger(u.a.BUFFER_APPENDING,t))})),this.pendingData=[],this.appended=!0)),this.tick()}},a.onFragParsed=function(t){var e=this.fragCurrent,r=t.frag;e&&"audio"===t.id&&r.sn===e.sn&&r.level===e.level&&this.state===yt&&(this.stats.tparsed=zt.now(),this.state=_t,this._checkAppendedParsed())},a.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},a.onBufferCreated=function(t){var e=t.tracks.audio;e&&(this.mediaBuffer=e.buffer,this.loadedmetadata=!0),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer)},a.onBufferAppended=function(t){if("audio"===t.parent){var e=this.state;e!==yt&&e!==_t||(this.pendingBuffering=t.pending>0,this._checkAppendedParsed())}},a._checkAppendedParsed=function(){if(!(this.state!==_t||this.appended&&this.pendingBuffering)){var t=this.fragCurrent,e=this.stats,r=this.hls;if(t){this.fragPrevious=t,e.tbuffered=zt.now(),r.trigger(u.a.FRAG_BUFFERED,{stats:e,frag:t,id:"audio"});var n=this.mediaBuffer?this.mediaBuffer:this.media;n&&d.b.log("audio buffered : "+et(n.buffered)),this.audioSwitch&&this.appended&&(this.audioSwitch=!1,r.trigger(u.a.AUDIO_TRACK_SWITCHED,{id:this.trackId})),this.state=ft}this.tick()}},a.onError=function(t){var e=t.frag;if(!e||"audio"===e.type)switch(t.details){case s.a.FRAG_LOAD_ERROR:case s.a.FRAG_LOAD_TIMEOUT:var r=t.frag;if(r&&"audio"!==r.type)break;if(!t.fatal){var n=this.fragLoadError;n?n++:n=1;var i=this.config;if(n<=i.fragLoadingMaxRetry){this.fragLoadError=n;var a=Math.min(Math.pow(2,n-1)*i.fragLoadingRetryDelay,i.fragLoadingMaxRetryTimeout);d.b.warn("AudioStreamController: frag loading failed, retry in "+a+" ms"),this.retryDate=zt.now()+a,this.state=gt}else d.b.error("AudioStreamController: "+t.details+" reaches max retry, redispatch as fatal ..."),t.fatal=!0,this.state=Tt}break;case s.a.AUDIO_TRACK_LOAD_ERROR:case s.a.AUDIO_TRACK_LOAD_TIMEOUT:case s.a.KEY_LOAD_ERROR:case s.a.KEY_LOAD_TIMEOUT:this.state!==Tt&&(this.state=t.fatal?Tt:ft,d.b.warn("AudioStreamController: "+t.details+" while loading frag, now switching to "+this.state+" state ..."));break;case s.a.BUFFER_FULL_ERROR:if("audio"===t.parent&&(this.state===yt||this.state===_t)){var o=this.mediaBuffer,l=this.media.currentTime;if(o&&B.isBuffered(o,l)&&B.isBuffered(o,l+.5)){var c=this.config;c.maxMaxBufferLength>=c.maxBufferLength&&(c.maxMaxBufferLength/=2,d.b.warn("AudioStreamController: reduce max buffer length to "+c.maxMaxBufferLength+"s")),this.state=ft}else d.b.warn("AudioStreamController: buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,this.state=bt,this.hls.trigger(u.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"})}}},a.onBufferFlushed=function(){var t=this,e=this.pendingData;e&&e.length?(d.b.log("AudioStreamController: appending pending audio data after buffer flushed"),e.forEach((function(e){t.hls.trigger(u.a.BUFFER_APPENDING,e)})),this.appended=!0,this.pendingData=[],this.state=_t):(this.state=ft,this.fragPrevious=null,this.tick())},(i=[{key:"state",set:function(t){if(this.state!==t){var e=this.state;this._state=t,d.b.log("audio stream:"+e+"->"+t)}},get:function(){return this._state}}])&&function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(n.prototype,i),n}(At),$t=function(){if("undefined"!=typeof window&&window.VTTCue)return window.VTTCue;var t={"":!0,lr:!0,rl:!0},e={start:!0,middle:!0,end:!0,left:!0,right:!0};function r(t){return"string"==typeof t&&!!e[t.toLowerCase()]&&t.toLowerCase()}function n(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)t[n]=r[n]}return t}function i(e,i,a){var o=this,s={enumerable:!0};o.hasBeenReset=!1;var l="",u=!1,d=e,c=i,h=a,f=null,p="",v=!0,g="auto",m="start",y=50,_="middle",b=50,E="middle";Object.defineProperty(o,"id",n({},s,{get:function(){return l},set:function(t){l=""+t}})),Object.defineProperty(o,"pauseOnExit",n({},s,{get:function(){return u},set:function(t){u=!!t}})),Object.defineProperty(o,"startTime",n({},s,{get:function(){return d},set:function(t){if("number"!=typeof t)throw new TypeError("Start time must be set to a number.");d=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"endTime",n({},s,{get:function(){return c},set:function(t){if("number"!=typeof t)throw new TypeError("End time must be set to a number.");c=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"text",n({},s,{get:function(){return h},set:function(t){h=""+t,this.hasBeenReset=!0}})),Object.defineProperty(o,"region",n({},s,{get:function(){return f},set:function(t){f=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"vertical",n({},s,{get:function(){return p},set:function(e){var r=function(e){return"string"==typeof e&&!!t[e.toLowerCase()]&&e.toLowerCase()}(e);if(!1===r)throw new SyntaxError("An invalid or illegal string was specified.");p=r,this.hasBeenReset=!0}})),Object.defineProperty(o,"snapToLines",n({},s,{get:function(){return v},set:function(t){v=!!t,this.hasBeenReset=!0}})),Object.defineProperty(o,"line",n({},s,{get:function(){return g},set:function(t){if("number"!=typeof t&&"auto"!==t)throw new SyntaxError("An invalid number or illegal string was specified.");g=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"lineAlign",n({},s,{get:function(){return m},set:function(t){var e=r(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");m=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"position",n({},s,{get:function(){return y},set:function(t){if(t<0||t>100)throw new Error("Position must be between 0 and 100.");y=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"positionAlign",n({},s,{get:function(){return _},set:function(t){var e=r(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");_=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"size",n({},s,{get:function(){return b},set:function(t){if(t<0||t>100)throw new Error("Size must be between 0 and 100.");b=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"align",n({},s,{get:function(){return E},set:function(t){var e=r(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");E=e,this.hasBeenReset=!0}})),o.displayState=void 0}return i.prototype.getCueAsHTML=function(){return window.WebVTT.convertCueToDOMTree(window,this.text)},i}(),Jt=function(){return{decode:function(t){if(!t)return"";if("string"!=typeof t)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(t))}}};function Zt(){this.window=window,this.state="INITIAL",this.buffer="",this.decoder=new Jt,this.regionList=[]}function Qt(){this.values=Object.create(null)}function te(t,e,r,n){var i=n?t.split(n):[t];for(var a in i)if("string"==typeof i[a]){var o=i[a].split(r);2===o.length&&e(o[0],o[1])}}Qt.prototype={set:function(t,e){this.get(t)||""===e||(this.values[t]=e)},get:function(t,e,r){return r?this.has(t)?this.values[t]:e[r]:this.has(t)?this.values[t]:e},has:function(t){return t in this.values},alt:function(t,e,r){for(var n=0;n<r.length;++n)if(e===r[n]){this.set(t,e);break}},integer:function(t,e){/^-?\d+$/.test(e)&&this.set(t,parseInt(e,10))},percent:function(t,e){return!!(e.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(e=parseFloat(e))>=0&&e<=100)&&(this.set(t,e),!0)}};var ee=new $t(0,0,0),re="middle"===ee.align?"middle":"center";function ne(t,e,r){var n=t;function i(){var e=function(t){function e(t,e,r,n){return 3600*(0|t)+60*(0|e)+(0|r)+(0|n)/1e3}var r=t.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return r?r[3]?e(r[1],r[2],r[3].replace(":",""),r[4]):r[1]>59?e(r[1],r[2],0,r[4]):e(0,r[1],r[2],r[4]):null}(t);if(null===e)throw new Error("Malformed timestamp: "+n);return t=t.replace(/^[^\sa-zA-Z-]+/,""),e}function a(){t=t.replace(/^\s+/,"")}if(a(),e.startTime=i(),a(),"--\x3e"!==t.substr(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+n);t=t.substr(3),a(),e.endTime=i(),a(),function(t,e){var n=new Qt;te(t,(function(t,e){switch(t){case"region":for(var i=r.length-1;i>=0;i--)if(r[i].id===e){n.set(t,r[i].region);break}break;case"vertical":n.alt(t,e,["rl","lr"]);break;case"line":var a=e.split(","),o=a[0];n.integer(t,o),n.percent(t,o)&&n.set("snapToLines",!1),n.alt(t,o,["auto"]),2===a.length&&n.alt("lineAlign",a[1],["start",re,"end"]);break;case"position":a=e.split(","),n.percent(t,a[0]),2===a.length&&n.alt("positionAlign",a[1],["start",re,"end","line-left","line-right","auto"]);break;case"size":n.percent(t,e);break;case"align":n.alt(t,e,["start",re,"end","left","right"])}}),/:/,/\s/),e.region=n.get("region",null),e.vertical=n.get("vertical","");var i=n.get("line","auto");"auto"===i&&-1===ee.line&&(i=-1),e.line=i,e.lineAlign=n.get("lineAlign","start"),e.snapToLines=n.get("snapToLines",!0),e.size=n.get("size",100),e.align=n.get("align",re);var a=n.get("position","auto");"auto"===a&&50===ee.position&&(a="start"===e.align||"left"===e.align?0:"end"===e.align||"right"===e.align?100:50),e.position=a}(t,e)}function ie(t){return t.replace(/<br(?: \/)?>/gi,"\n")}Zt.prototype={parse:function(t){var e=this;function r(){var t=e.buffer,r=0;for(t=ie(t);r<t.length&&"\r"!==t[r]&&"\n"!==t[r];)++r;var n=t.substr(0,r);return"\r"===t[r]&&++r,"\n"===t[r]&&++r,e.buffer=t.substr(r),n}t&&(e.buffer+=e.decoder.decode(t,{stream:!0}));try{var n;if("INITIAL"===e.state){if(!/\r\n|\n/.test(e.buffer))return this;var i=(n=r()).match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!i||!i[0])throw new Error("Malformed WebVTT signature.");e.state="HEADER"}for(var a=!1;e.buffer;){if(!/\r\n|\n/.test(e.buffer))return this;switch(a?a=!1:n=r(),e.state){case"HEADER":/:/.test(n)?te(n,(function(t,e){}),/:/):n||(e.state="ID");continue;case"NOTE":n||(e.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(n)){e.state="NOTE";break}if(!n)continue;if(e.cue=new $t(0,0,""),e.state="CUE",-1===n.indexOf("--\x3e")){e.cue.id=n;continue}case"CUE":try{ne(n,e.cue,e.regionList)}catch(t){e.cue=null,e.state="BADCUE";continue}e.state="CUETEXT";continue;case"CUETEXT":var o=-1!==n.indexOf("--\x3e");if(!n||o&&(a=!0)){e.oncue&&e.oncue(e.cue),e.cue=null,e.state="ID";continue}e.cue.text&&(e.cue.text+="\n"),e.cue.text+=n;continue;case"BADCUE":n||(e.state="ID");continue}}}catch(t){"CUETEXT"===e.state&&e.cue&&e.oncue&&e.oncue(e.cue),e.cue=null,e.state="INITIAL"===e.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){try{if(this.buffer+=this.decoder.decode(),(this.cue||"HEADER"===this.state)&&(this.buffer+="\n\n",this.parse()),"INITIAL"===this.state)throw new Error("Malformed WebVTT signature.")}catch(t){throw t}return this.onflush&&this.onflush(),this}};var ae=Zt;function oe(t,e,r,n){for(var i,a,o,s,l,u=window.VTTCue||TextTrackCue,d=0;d<n.rows.length;d++)if(o=!0,s=0,l="",!(i=n.rows[d]).isEmpty()){for(var c=0;c<i.chars.length;c++)i.chars[c].uchar.match(/\s/)&&o?s++:(l+=i.chars[c].uchar,o=!1);i.cueStartTime=e,e===r&&(r+=1e-4),s>=16?s--:s++,(a=new u(e,r,ie(l.trim()))).line=navigator.userAgent.match(/Firefox\//)?d+1:d>7?d-2:d+1,a.align="left",a.position=Math.max(0,Math.min(100,s/32*100)),t.addCue(a)}}var se,le={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},ue=function(t){var e=t;return le.hasOwnProperty(t)&&(e=le[t]),String.fromCharCode(e)},de={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},ce={17:2,18:4,21:6,22:8,23:10,19:13,20:15},he={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},fe={25:2,26:4,29:6,30:8,31:10,27:13,28:15},pe=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];!function(t){t[t.ERROR=0]="ERROR",t[t.TEXT=1]="TEXT",t[t.WARNING=2]="WARNING",t[t.INFO=2]="INFO",t[t.DEBUG=3]="DEBUG",t[t.DATA=3]="DATA"}(se||(se={}));var ve={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(t){this.time=t},log:function(t,e){}},ge=function(t){for(var e=[],r=0;r<t.length;r++)e.push(t[r].toString(16));return e},me=function(){function t(t,e,r,n,i){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=t||"white",this.underline=e||!1,this.italics=r||!1,this.background=n||"black",this.flash=i||!1}var e=t.prototype;return e.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},e.setStyles=function(t){for(var e=["foreground","underline","italics","background","flash"],r=0;r<e.length;r++){var n=e[r];t.hasOwnProperty(n)&&(this[n]=t[n])}},e.isDefault=function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},e.equals=function(t){return this.foreground===t.foreground&&this.underline===t.underline&&this.italics===t.italics&&this.background===t.background&&this.flash===t.flash},e.copy=function(t){this.foreground=t.foreground,this.underline=t.underline,this.italics=t.italics,this.background=t.background,this.flash=t.flash},e.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},t}(),ye=function(){function t(t,e,r,n,i,a){this.uchar=void 0,this.penState=void 0,this.uchar=t||" ",this.penState=new me(e,r,n,i,a)}var e=t.prototype;return e.reset=function(){this.uchar=" ",this.penState.reset()},e.setChar=function(t,e){this.uchar=t,this.penState.copy(e)},e.setPenState=function(t){this.penState.copy(t)},e.equals=function(t){return this.uchar===t.uchar&&this.penState.equals(t.penState)},e.copy=function(t){this.uchar=t.uchar,this.penState.copy(t.penState)},e.isEmpty=function(){return" "===this.uchar&&this.penState.isDefault()},t}(),_e=function(){function t(){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.chars=[];for(var t=0;t<100;t++)this.chars.push(new ye);this.pos=0,this.currPenState=new me}var e=t.prototype;return e.equals=function(t){for(var e=!0,r=0;r<100;r++)if(!this.chars[r].equals(t.chars[r])){e=!1;break}return e},e.copy=function(t){for(var e=0;e<100;e++)this.chars[e].copy(t.chars[e])},e.isEmpty=function(){for(var t=!0,e=0;e<100;e++)if(!this.chars[e].isEmpty()){t=!1;break}return t},e.setCursor=function(t){this.pos!==t&&(this.pos=t),this.pos<0?(ve.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>100&&(ve.log("ERROR","Too large cursor position "+this.pos),this.pos=100)},e.moveCursor=function(t){var e=this.pos+t;if(t>1)for(var r=this.pos+1;r<e+1;r++)this.chars[r].setPenState(this.currPenState);this.setCursor(e)},e.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},e.insertChar=function(t){t>=144&&this.backSpace();var e=ue(t);this.pos>=100?ve.log("ERROR","Cannot insert "+t.toString(16)+" ("+e+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(e,this.currPenState),this.moveCursor(1))},e.clearFromPos=function(t){var e;for(e=t;e<100;e++)this.chars[e].reset()},e.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},e.clearToEndOfRow=function(){this.clearFromPos(this.pos)},e.getTextString=function(){for(var t=[],e=!0,r=0;r<100;r++){var n=this.chars[r].uchar;" "!==n&&(e=!1),t.push(n)}return e?"":t.join("")},e.setPenStyles=function(t){this.currPenState.setStyles(t),this.chars[this.pos].setPenState(this.currPenState)},t}(),be=function(){function t(){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.rows=[];for(var t=0;t<15;t++)this.rows.push(new _e);this.currRow=14,this.nrRollUpRows=null,this.reset()}var e=t.prototype;return e.reset=function(){for(var t=0;t<15;t++)this.rows[t].clear();this.currRow=14},e.equals=function(t){for(var e=!0,r=0;r<15;r++)if(!this.rows[r].equals(t.rows[r])){e=!1;break}return e},e.copy=function(t){for(var e=0;e<15;e++)this.rows[e].copy(t.rows[e])},e.isEmpty=function(){for(var t=!0,e=0;e<15;e++)if(!this.rows[e].isEmpty()){t=!1;break}return t},e.backSpace=function(){this.rows[this.currRow].backSpace()},e.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},e.insertChar=function(t){this.rows[this.currRow].insertChar(t)},e.setPen=function(t){this.rows[this.currRow].setPenStyles(t)},e.moveCursor=function(t){this.rows[this.currRow].moveCursor(t)},e.setCursor=function(t){ve.log("INFO","setCursor: "+t),this.rows[this.currRow].setCursor(t)},e.setPAC=function(t){ve.log("INFO","pacData = "+JSON.stringify(t));var e=t.row-1;if(this.nrRollUpRows&&e<this.nrRollUpRows-1&&(e=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==e){for(var r=0;r<15;r++)this.rows[r].clear();var n=this.currRow+1-this.nrRollUpRows,i=this.lastOutputScreen;if(i){var a=i.rows[n].cueStartTime;if(a&&ve.time&&a<ve.time)for(var o=0;o<this.nrRollUpRows;o++)this.rows[e-this.nrRollUpRows+o+1].copy(i.rows[n+o])}}this.currRow=e;var s=this.rows[this.currRow];if(null!==t.indent){var l=Math.max(t.indent-1,0);s.setCursor(t.indent),t.color=s.chars[l].penState.foreground}this.setPen({foreground:t.color,underline:t.underline,italics:t.italics,background:"black",flash:!1})},e.setBkgData=function(t){ve.log("INFO","bkgData = "+JSON.stringify(t)),this.backSpace(),this.setPen(t),this.insertChar(32)},e.setRollUpRows=function(t){this.nrRollUpRows=t},e.rollUp=function(){if(null!==this.nrRollUpRows){ve.log("TEXT",this.getDisplayText());var t=this.rows.splice(this.currRow+1-this.nrRollUpRows,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),ve.log("INFO","Rolling up")}else ve.log("DEBUG","roll_up but nrRollUpRows not set yet")},e.getDisplayText=function(t){t=t||!1;for(var e=[],r="",n=0;n<15;n++){var i=this.rows[n].getTextString();i&&e.push(t?"Row "+(n+1)+": '"+i+"'":i.trim())}return e.length>0&&(r=t?"["+e.join(" | ")+"]":e.join("\n")),r},e.getTextAndFormat=function(){return this.rows},t}(),Ee=function(){function t(t,e){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.lastCueEndTime=void 0,this.chNr=t,this.outputFilter=e,this.mode=null,this.verbose=0,this.displayedMemory=new be,this.nonDisplayedMemory=new be,this.lastOutputScreen=new be,this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}var e=t.prototype;return e.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},e.getHandler=function(){return this.outputFilter},e.setHandler=function(t){this.outputFilter=t},e.setPAC=function(t){this.writeScreen.setPAC(t)},e.setBkgData=function(t){this.writeScreen.setBkgData(t)},e.setMode=function(t){t!==this.mode&&(this.mode=t,ve.log("INFO","MODE="+t),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=t)},e.insertChars=function(t){for(var e=0;e<t.length;e++)this.writeScreen.insertChar(t[e]);ve.log("INFO",(this.writeScreen===this.displayedMemory?"DISP":"NON_DISP")+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(ve.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},e.ccRCL=function(){ve.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},e.ccBS=function(){ve.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},e.ccAOF=function(){},e.ccAON=function(){},e.ccDER=function(){ve.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},e.ccRU=function(t){ve.log("INFO","RU("+t+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(t)},e.ccFON=function(){ve.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})},e.ccRDC=function(){ve.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},e.ccTR=function(){ve.log("INFO","TR"),this.setMode("MODE_TEXT")},e.ccRTD=function(){ve.log("INFO","RTD"),this.setMode("MODE_TEXT")},e.ccEDM=function(){ve.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},e.ccCR=function(){ve.log("INFO","CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},e.ccENM=function(){ve.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},e.ccEOC=function(){if(ve.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var t=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=t,this.writeScreen=this.nonDisplayedMemory,ve.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},e.ccTO=function(t){ve.log("INFO","TO("+t+") - Tab Offset"),this.writeScreen.moveCursor(t)},e.ccMIDROW=function(t){var e={flash:!1};if(e.underline=t%2==1,e.italics=t>=46,e.italics)e.foreground="white";else{var r=Math.floor(t/2)-16;e.foreground=["white","green","blue","cyan","red","yellow","magenta"][r]}ve.log("INFO","MIDROW: "+JSON.stringify(e)),this.writeScreen.setPen(e)},e.outputDataUpdate=function(t){void 0===t&&(t=!1);var e=ve.time;null!==e&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,e,this.lastOutputScreen),t&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:e):this.cueStartTime=e,this.lastOutputScreen.copy(this.displayedMemory))},e.cueSplitAtTime=function(t){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,t,this.displayedMemory),this.cueStartTime=t))},t}(),Te=function(){function t(t,e,r){this.field=void 0,this.outputs=void 0,this.channels=void 0,this.currChNr=void 0,this.lastCmdA=void 0,this.lastCmdB=void 0,this.lastTime=void 0,this.dataCounters=void 0,this.field=t||1,this.outputs=[e,r],this.channels=[new Ee(1,e),new Ee(2,r)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0}}var e=t.prototype;return e.getHandler=function(t){return this.channels[t].getHandler()},e.setHandler=function(t,e){this.channels[t].setHandler(e)},e.addData=function(t,e){var r,n,i,a=!1;this.lastTime=t,ve.setTime(t);for(var o=0;o<e.length;o+=2)i=127&e[o+1],0!=(n=127&e[o])||0!==i?(ve.log("DATA","["+ge([e[o],e[o+1]])+"] -> ("+ge([n,i])+")"),(r=this.parseCmd(n,i))||(r=this.parseMidrow(n,i)),r||(r=this.parsePAC(n,i)),r||(r=this.parseBackgroundAttributes(n,i)),r||(a=this.parseChars(n,i))&&(this.currChNr&&this.currChNr>=0?this.channels[this.currChNr-1].insertChars(a):ve.log("WARNING","No channel found yet. TEXT-MODE?")),r?this.dataCounters.cmd+=2:a?this.dataCounters.char+=2:(this.dataCounters.other+=2,ve.log("WARNING","Couldn't parse cleaned data "+ge([n,i])+" orig: "+ge([e[o],e[o+1]])))):this.dataCounters.padding+=2},e.parseCmd=function(t,e){var r;if(!((20===t||28===t)&&e>=32&&e<=47||(23===t||31===t)&&e>=33&&e<=35))return!1;if(t===this.lastCmdA&&e===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,ve.log("DEBUG","Repeated command ("+ge([t,e])+") is dropped"),!0;var n=this.channels[(r=20===t||23===t?1:2)-1];return 20===t||28===t?32===e?n.ccRCL():33===e?n.ccBS():34===e?n.ccAOF():35===e?n.ccAON():36===e?n.ccDER():37===e?n.ccRU(2):38===e?n.ccRU(3):39===e?n.ccRU(4):40===e?n.ccFON():41===e?n.ccRDC():42===e?n.ccTR():43===e?n.ccRTD():44===e?n.ccEDM():45===e?n.ccCR():46===e?n.ccENM():47===e&&n.ccEOC():n.ccTO(e-32),this.lastCmdA=t,this.lastCmdB=e,this.currChNr=r,!0},e.parseMidrow=function(t,e){var r=null;return(17===t||25===t)&&e>=32&&e<=47&&((r=17===t?1:2)!==this.currChNr?(ve.log("ERROR","Mismatch channel in midrow parsing"),!1):(this.channels[r-1].ccMIDROW(e),ve.log("DEBUG","MIDROW ("+ge([t,e])+")"),!0))},e.parsePAC=function(t,e){var r;if(!((t>=17&&t<=23||t>=25&&t<=31)&&e>=64&&e<=127||(16===t||24===t)&&e>=64&&e<=95))return!1;if(t===this.lastCmdA&&e===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,!0;r=t<=23?1:2;var n=this.interpretPAC(e>=64&&e<=95?1===r?de[t]:he[t]:1===r?ce[t]:fe[t],e);return this.channels[r-1].setPAC(n),this.lastCmdA=t,this.lastCmdB=e,this.currChNr=r,!0},e.interpretPAC=function(t,e){var r,n={color:null,italics:!1,indent:null,underline:!1,row:t};return n.underline=1==(1&(r=e>95?e-96:e-64)),r<=13?n.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)]:r<=15?(n.italics=!0,n.color="white"):n.indent=4*Math.floor((r-16)/2),n},e.parseChars=function(t,e){var r,n=null,i=null,a=null;if(t>=25?(n=2,a=t-8):(n=1,a=t),a>=17&&a<=19?(ve.log("INFO","Special char '"+ue(r=17===a?e+80:18===a?e+112:e+144)+"' in channel "+n),i=[r]):t>=32&&t<=127&&(i=0===e?[t]:[t,e]),i){var o=ge(i);ve.log("DEBUG","Char codes =  "+o.join(",")),this.lastCmdA=null,this.lastCmdB=null}return i},e.parseBackgroundAttributes=function(t,e){var r,n;return((16===t||24===t)&&e>=32&&e<=47||(23===t||31===t)&&e>=45&&e<=47)&&(r={},16===t||24===t?(n=Math.floor((e-32)/2),r.background=pe[n],e%2==1&&(r.background=r.background+"_semi")):45===e?r.background="transparent":(r.foreground="black",47===e&&(r.underline=!0)),this.channels[(t<24?1:2)-1].setBkgData(r),this.lastCmdA=null,this.lastCmdB=null,!0)},e.reset=function(){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].reset();this.lastCmdA=null,this.lastCmdB=null},e.cueSplitAtTime=function(t){for(var e=0;e<this.channels.length;e++)this.channels[e]&&this.channels[e].cueSplitAtTime(t)},t}(),Se=function(){function t(t,e){this.timelineController=void 0,this.trackName=void 0,this.startTime=void 0,this.endTime=void 0,this.screen=void 0,this.timelineController=t,this.trackName=e,this.startTime=null,this.endTime=null,this.screen=null}var e=t.prototype;return e.dispatchCue=function(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen),this.startTime=null)},e.newCue=function(t,e,r){(null===this.startTime||this.startTime>t)&&(this.startTime=t),this.endTime=e,this.screen=r,this.timelineController.createCaptionsTrack(this.trackName)},t}(),we=function(t,e,r){return t.substr(r||0,e.length)===e},Ae=function(t){for(var e=5381,r=t.length;r;)e=33*e^t.charCodeAt(--r);return(e>>>0).toString()};function Ce(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Re(t,e){return t&&t.label===e.name&&!(t.textTrack1||t.textTrack2)}var Le=function(t){var e,r;function n(e){var r;if((r=t.call(this,e,u.a.MEDIA_ATTACHING,u.a.MEDIA_DETACHING,u.a.FRAG_PARSING_USERDATA,u.a.FRAG_DECRYPTED,u.a.MANIFEST_LOADING,u.a.MANIFEST_LOADED,u.a.FRAG_LOADED,u.a.INIT_PTS_FOUND)||this).media=null,r.config=void 0,r.enabled=!0,r.Cues=void 0,r.textTracks=[],r.tracks=[],r.initPTS=[],r.unparsedVttFrags=[],r.cueRanges=[],r.captionsTracks={},r.captionsProperties=void 0,r.cea608Parser=void 0,r.lastSn=-1,r.prevCC=-1,r.vttCCs=null,r.hls=e,r.config=e.config,r.Cues=e.config.cueHandler,r.captionsProperties={textTrack1:{label:r.config.captionsTextTrack1Label,languageCode:r.config.captionsTextTrack1LanguageCode},textTrack2:{label:r.config.captionsTextTrack2Label,languageCode:r.config.captionsTextTrack2LanguageCode}},r.config.enableCEA708Captions){var n=new Se(Ce(r),"textTrack1"),i=new Se(Ce(r),"textTrack2");r.cea608Parser=new Te(0,n,i)}return r}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var i=n.prototype;return i.addCues=function(t,e,r,n){for(var i,a,o=this.cueRanges,s=!1,l=o.length;l--;){var u=o[l],d=(i=u[0],a=e,Math.min(u[1],r)-Math.max(i,a));if(d>=0&&(u[0]=Math.min(u[0],e),u[1]=Math.max(u[1],r),s=!0,d/(r-e)>.5))return}s||o.push([e,r]),this.Cues.newCue(this.captionsTracks[t],e,r,n)},i.onInitPtsFound=function(t){var e=this,r=this.unparsedVttFrags;"main"===t.id&&(this.initPTS[t.frag.cc]=t.initPTS),r.length&&(this.unparsedVttFrags=[],r.forEach((function(t){e.onFragLoaded(t)})))},i.getExistingTrack=function(t){var e=this.media;if(e)for(var r=0;r<e.textTracks.length;r++){var n=e.textTracks[r];if(n[t])return n}return null},i.createCaptionsTrack=function(t){var e=this.captionsTracks,r=this.media,n=this.captionsProperties[t],i=n.label,a=n.languageCode;if(!e[t]){var o=this.getExistingTrack(t);if(o)e[t]=o,Ot(e[t]),kt(e[t],r);else{var s=this.createTextTrack("captions",i,a);s&&(s[t]=!0,e[t]=s)}}},i.createTextTrack=function(t,e,r){var n=this.media;if(n)return n.addTextTrack(t,e,r)},i.destroy=function(){t.prototype.destroy.call(this)},i.onMediaAttaching=function(t){this.media=t.media,this._cleanTracks()},i.onMediaDetaching=function(){var t=this.captionsTracks;Object.keys(t).forEach((function(e){Ot(t[e]),delete t[e]}))},i.onManifestLoading=function(){this.lastSn=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}},this._cleanTracks()},i._cleanTracks=function(){var t=this.media;if(t){var e=t.textTracks;if(e)for(var r=0;r<e.length;r++)Ot(e[r])}},i.onManifestLoaded=function(t){var e=this;if(this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.cueRanges=[],this.config.enableWebVTT){this.tracks=t.subtitles||[];var r=this.media?this.media.textTracks:[];this.tracks.forEach((function(t,n){var i;if(n<r.length){for(var a=null,o=0;o<r.length;o++)if(Re(r[o],t)){a=r[o];break}a&&(i=a)}i||(i=e.createTextTrack("subtitles",t.name,t.lang)),i.mode=t.default?e.hls.subtitleDisplay?"showing":"hidden":"disabled",e.textTracks.push(i)}))}},i.onFragLoaded=function(t){var e=t.frag,r=t.payload,n=this.cea608Parser,i=this.initPTS,a=this.unparsedVttFrags;if("main"===e.type){var o=e.sn;e.sn!==this.lastSn+1&&n&&n.reset(),this.lastSn=o}else if("subtitle"===e.type)if(r.byteLength){if(!Object(l.a)(i[e.cc]))return a.push(t),void(i.length&&this.hls.trigger(u.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e}));var s=e.decryptdata;null!=s&&null!=s.key&&"AES-128"===s.method||this._parseVTTs(e,r)}else this.hls.trigger(u.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e})},i._parseVTTs=function(t,e){var r=this.hls,n=this.textTracks,i=this.vttCCs;i[t.cc]||(i[t.cc]={start:t.start,prevCC:this.prevCC,new:!0},this.prevCC=t.cc),function(t,e,r,n,i,a){var o,s=Object(Dt.b)(new Uint8Array(t)).trim().replace(/\r\n|\n\r|\n|\r/g,"\n").split("\n"),u="00:00.000",d=0,c=0,h=0,f=[],p=!0,v=!1,g=new ae;g.oncue=function(t){var e=r[n],i=r.ccOffset;e&&e.new&&(void 0!==c?i=r.ccOffset=e.start:function(t,e,r){var n=t[e],i=t[n.prevCC];if(!i||!i.new&&n.new)return t.ccOffset=t.presentationOffset=n.start,void(n.new=!1);for(;i&&i.new;)t.ccOffset+=n.start-i.start,n.new=!1,i=t[(n=i).prevCC];t.presentationOffset=r}(r,n,h)),h&&(i=h-r.presentationOffset),v&&(t.startTime+=i-c,t.endTime+=i-c),t.id=Ae(t.startTime.toString())+Ae(t.endTime.toString())+Ae(t.text),t.text=decodeURIComponent(encodeURIComponent(t.text)),t.endTime>0&&f.push(t)},g.onparsingerror=function(t){o=t},g.onflush=function(){o&&a?a(o):i(f)},s.forEach((function(t){if(p){if(we(t,"X-TIMESTAMP-MAP=")){p=!1,v=!0,t.substr(16).split(",").forEach((function(t){we(t,"LOCAL:")?u=t.substr(6):we(t,"MPEGTS:")&&(d=parseInt(t.substr(7)))}));try{e+(9e4*r[n].start||0)<0&&(e+=8589934592),d-=e,c=function(t){var e=parseInt(t.substr(-3)),r=parseInt(t.substr(-6,2)),n=parseInt(t.substr(-9,2)),i=t.length>9?parseInt(t.substr(0,t.indexOf(":"))):0;if(!(Object(l.a)(e)&&Object(l.a)(r)&&Object(l.a)(n)&&Object(l.a)(i)))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+t);return e+=1e3*r,(e+=6e4*n)+36e5*i}(u)/1e3,h=d/9e4}catch(t){v=!1,o=t}return}""===t&&(p=!1)}g.parse(t+"\n")})),g.flush()}(e,this.initPTS[t.cc],i,t.cc,(function(e){var i=n[t.level];"disabled"!==i.mode?(e.forEach((function(t){if(!i.cues.getCueById(t.id))try{if(i.addCue(t),!i.cues.getCueById(t.id))throw new Error("addCue is failed for: "+t)}catch(r){d.b.debug("Failed occurred on adding cues: "+r);var e=new window.TextTrackCue(t.startTime,t.endTime,t.text);e.id=t.id,i.addCue(e)}})),r.trigger(u.a.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:t})):r.trigger(u.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t})}),(function(e){d.b.log("Failed to parse VTT cue: "+e),r.trigger(u.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t})}))},i.onFragDecrypted=function(t){var e=t.frag,r=t.payload;if("subtitle"===e.type){if(!Object(l.a)(this.initPTS[e.cc]))return void this.unparsedVttFrags.push(t);this._parseVTTs(e,r)}},i.onFragParsingUserdata=function(t){if(this.enabled&&this.cea608Parser)for(var e=0;e<t.samples.length;e++){var r=t.samples[e].bytes;if(r){var n=this.extractCea608Data(r);this.cea608Parser.addData(t.samples[e].pts,n)}}},i.extractCea608Data=function(t){for(var e,r,n,i=31&t[0],a=2,o=[],s=0;s<i;s++)e=t[a++],r=127&t[a++],n=127&t[a++],0===r&&0===n||0!=(4&e)&&0==(3&e)&&(o.push(r),o.push(n));return o},n}(h);function De(t){for(var e=[],r=0;r<t.length;r++){var n=t[r];"subtitles"===n.kind&&n.label&&e.push(t[r])}return e}var ke,Oe=function(t){var e,r;function n(e){var r;return(r=t.call(this,e,u.a.MEDIA_ATTACHED,u.a.MEDIA_DETACHING,u.a.MANIFEST_LOADED,u.a.SUBTITLE_TRACK_LOADED)||this).tracks=[],r.trackId=-1,r.media=null,r.stopped=!0,r.subtitleDisplay=!0,r.queuedDefaultTrack=null,r}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var i,a=n.prototype;return a.destroy=function(){h.prototype.destroy.call(this)},a.onMediaAttached=function(t){var e=this;this.media=t.media,this.media&&(Object(l.a)(this.queuedDefaultTrack)&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=null),this.trackChangeListener=this._onTextTracksChanged.bind(this),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.subtitlePollingInterval=setInterval((function(){e.trackChangeListener()}),500):this.media.textTracks.addEventListener("change",this.trackChangeListener))},a.onMediaDetaching=function(){this.media&&(this.useTextTrackPolling?clearInterval(this.subtitlePollingInterval):this.media.textTracks.removeEventListener("change",this.trackChangeListener),Object(l.a)(this.subtitleTrack)&&(this.queuedDefaultTrack=this.subtitleTrack),De(this.media.textTracks).forEach((function(t){Ot(t)})),this.subtitleTrack=-1,this.media=null)},a.onManifestLoaded=function(t){var e=this,r=t.subtitles||[];this.tracks=r,this.hls.trigger(u.a.SUBTITLE_TRACKS_UPDATED,{subtitleTracks:r}),r.forEach((function(t){t.default&&(e.media?e.subtitleTrack=t.id:e.queuedDefaultTrack=t.id)}))},a.onSubtitleTrackLoaded=function(t){var e=this,r=t.id,n=t.details,i=this.trackId,a=this.tracks,o=a[i];if(r>=a.length||r!==i||!o||this.stopped)this._clearReloadTimer();else if(d.b.log("subtitle track "+r+" loaded"),n.live){var s=tt(o.details,n,t.stats.trequest);d.b.log("Reloading live subtitle playlist in "+s+"ms"),this.timer=setTimeout((function(){e._loadCurrentTrack()}),s)}else this._clearReloadTimer()},a.startLoad=function(){this.stopped=!1,this._loadCurrentTrack()},a.stopLoad=function(){this.stopped=!0,this._clearReloadTimer()},a._clearReloadTimer=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},a._loadCurrentTrack=function(){var t=this.trackId,e=this.hls,r=this.tracks[t];t<0||!r||r.details&&!r.details.live||(d.b.log("Loading subtitle track "+t),e.trigger(u.a.SUBTITLE_TRACK_LOADING,{url:r.url,id:t}))},a._toggleTrackModes=function(t){var e=this.media,r=this.subtitleDisplay,n=this.trackId;if(e){var i=De(e.textTracks);if(-1===t)[].slice.call(i).forEach((function(t){t.mode="disabled"}));else{var a=i[n];a&&(a.mode="disabled")}var o=i[t];o&&(o.mode=r?"showing":"hidden")}},a._setSubtitleTrackInternal=function(t){var e=this.hls,r=this.tracks;!Object(l.a)(t)||t<-1||t>=r.length||(this.trackId=t,d.b.log("Switching to subtitle track "+t),e.trigger(u.a.SUBTITLE_TRACK_SWITCH,{id:t}),this._loadCurrentTrack())},a._onTextTracksChanged=function(){if(this.media){for(var t=-1,e=De(this.media.textTracks),r=0;r<e.length;r++)if("hidden"===e[r].mode)t=r;else if("showing"===e[r].mode){t=r;break}this.subtitleTrack=t}},(i=[{key:"subtitleTracks",get:function(){return this.tracks}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(t){this.trackId!==t&&(this._toggleTrackModes(t),this._setSubtitleTrackInternal(t))}}])&&function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(n.prototype,i),n}(h),Ne=r(7),xe=window.performance,Ie=function(t){var e,r;function n(e,r){var n;return(n=t.call(this,e,u.a.MEDIA_ATTACHED,u.a.MEDIA_DETACHING,u.a.ERROR,u.a.KEY_LOADED,u.a.FRAG_LOADED,u.a.SUBTITLE_TRACKS_UPDATED,u.a.SUBTITLE_TRACK_SWITCH,u.a.SUBTITLE_TRACK_LOADED,u.a.SUBTITLE_FRAG_PROCESSED,u.a.LEVEL_UPDATED)||this).fragmentTracker=r,n.config=e.config,n.state=ct,n.tracks=[],n.tracksBuffered=[],n.currentTrackId=-1,n.decrypter=new Ne.a(e,e.config),n.lastAVStart=0,n._onMediaSeeking=n.onMediaSeeking.bind(function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(n)),n}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var i=n.prototype;return i.onSubtitleFragProcessed=function(t){var e=t.frag,r=t.success;if(this.fragPrevious=e,this.state=ft,r){var n=this.tracksBuffered[this.currentTrackId];if(n){for(var i,a=e.start,o=0;o<n.length;o++)if(a>=n[o].start&&a<=n[o].end){i=n[o];break}var s=e.start+e.duration;i?i.end=s:n.push(i={start:a,end:s})}}},i.onMediaAttached=function(t){var e=t.media;this.media=e,e.addEventListener("seeking",this._onMediaSeeking),this.state=ft},i.onMediaDetaching=function(){var t=this;this.media&&(this.media.removeEventListener("seeking",this._onMediaSeeking),this.fragmentTracker.removeAllFragments(),this.currentTrackId=-1,this.tracks.forEach((function(e){t.tracksBuffered[e.id]=[]})),this.media=null,this.state=ct)},i.onError=function(t){var e=t.frag;e&&"subtitle"===e.type&&(this.state=ft)},i.onSubtitleTracksUpdated=function(t){var e=this;d.b.log("subtitle tracks updated"),this.tracksBuffered=[],this.tracks=t.subtitleTracks,this.tracks.forEach((function(t){e.tracksBuffered[t.id]=[]}))},i.onSubtitleTrackSwitch=function(t){if(this.currentTrackId=t.id,this.tracks&&this.tracks.length&&-1!==this.currentTrackId){var e=this.tracks[this.currentTrackId];e&&e.details&&this.setInterval(500)}else this.clearInterval()},i.onSubtitleTrackLoaded=function(t){var e=t.id,r=t.details,n=this.currentTrackId,i=this.tracks,a=i[n];e>=i.length||e!==n||!a||(r.live&&function(t,e,r){void 0===r&&(r=0);var n=-1;Q(t,e,(function(t,e,r){e.start=t.start,n=r}));var i=e.fragments;if(n<0)i.forEach((function(t){t.start+=r}));else for(var a=n+1;a<i.length;a++)i[a].start=i[a-1].start+i[a-1].duration}(a.details,r,this.lastAVStart),a.details=r,this.setInterval(500))},i.onKeyLoaded=function(){this.state===pt&&(this.state=ft)},i.onFragLoaded=function(t){var e=this.fragCurrent,r=t.frag.decryptdata,n=t.frag,i=this.hls;if(this.state===vt&&e&&"subtitle"===t.frag.type&&e.sn===t.frag.sn&&t.payload.byteLength>0&&r&&r.key&&"AES-128"===r.method){var a=xe.now();this.decrypter.decrypt(t.payload,r.key.buffer,r.iv.buffer,(function(t){var e=xe.now();i.trigger(u.a.FRAG_DECRYPTED,{frag:n,payload:t,stats:{tstart:a,tdecrypt:e}})}))}},i.onLevelUpdated=function(t){var e=t.details.fragments;this.lastAVStart=e.length?e[0].start:0},i.doTick=function(){if(this.media)switch(this.state){case ft:var t=this.config,e=this.currentTrackId,r=this.fragmentTracker,n=this.media,i=this.tracks;if(!i||!i[e]||!i[e].details)break;var a,o=t.maxBufferHole,s=t.maxFragLookUpTolerance,l=Math.min(t.maxBufferLength,t.maxMaxBufferLength),c=B.bufferedInfo(this._getBuffered(),n.currentTime,o),h=c.end,f=i[e].details,p=f.fragments,v=p.length;if(c.len>l)return;var g=this.fragPrevious;h<p[v-1].start+p[v-1].duration?(g&&f.hasProgramDateTime&&(a=it(p,g.endProgramDateTime,s)),a||(a=at(g,p,h,s))):a=p[v-1],a&&a.encrypted?(d.b.log("Loading key for "+a.sn),this.state=pt,this.hls.trigger(u.a.KEY_LOADING,{frag:a})):a&&r.getState(a)===I&&(this.fragCurrent=a,this.state=vt,this.hls.trigger(u.a.FRAG_LOADING,{frag:a}))}else this.state=ft},i.stopLoad=function(){this.lastAVStart=0,t.prototype.stopLoad.call(this)},i._getBuffered=function(){return this.tracksBuffered[this.currentTrackId]||[]},i.onMediaSeeking=function(){this.fragPrevious=null},n}(At);!function(t){t.WIDEVINE="com.widevine.alpha",t.PLAYREADY="com.microsoft.playready"}(ke||(ke={}));var Pe="undefined"!=typeof window&&window.navigator&&window.navigator.requestMediaKeySystemAccess?window.navigator.requestMediaKeySystemAccess.bind(window.navigator):null,Me=function(t){var e,r;function n(e){var r;return(r=t.call(this,e,u.a.MEDIA_ATTACHED,u.a.MEDIA_DETACHED,u.a.MANIFEST_PARSED)||this)._widevineLicenseUrl=void 0,r._licenseXhrSetup=void 0,r._emeEnabled=void 0,r._requestMediaKeySystemAccess=void 0,r._config=void 0,r._mediaKeysList=[],r._media=null,r._hasSetMediaKeys=!1,r._requestLicenseFailureCount=0,r._onMediaEncrypted=function(t){d.b.log('Media is encrypted using "'+t.initDataType+'" init data type'),r._attemptSetMediaKeys(),r._generateRequestWithPreferredKeySession(t.initDataType,t.initData)},r._config=e.config,r._widevineLicenseUrl=r._config.widevineLicenseUrl,r._licenseXhrSetup=r._config.licenseXhrSetup,r._emeEnabled=r._config.emeEnabled,r._requestMediaKeySystemAccess=r._config.requestMediaKeySystemAccessFunc,r}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var i,a=n.prototype;return a.getLicenseServerUrl=function(t){switch(t){case ke.WIDEVINE:if(!this._widevineLicenseUrl)break;return this._widevineLicenseUrl}throw new Error('no license server URL configured for key-system "'+t+'"')},a._attemptKeySystemAccess=function(t,e,r){var n=this,i=function(t,e,r){switch(t){case ke.WIDEVINE:return function(t,e){var r={videoCapabilities:[]};return e.forEach((function(t){r.videoCapabilities.push({contentType:'video/mp4; codecs="'+t+'"'})})),[r]}(0,r);default:throw new Error("Unknown key-system: "+t)}}(t,0,r);d.b.log("Requesting encrypted media key-system access"),this.requestMediaKeySystemAccess(t,i).then((function(e){n._onMediaKeySystemAccessObtained(t,e)})).catch((function(e){d.b.error('Failed to obtain key-system "'+t+'" access:',e)}))},a._onMediaKeySystemAccessObtained=function(t,e){var r=this;d.b.log('Access for key-system "'+t+'" obtained');var n={mediaKeysSessionInitialized:!1,mediaKeySystemAccess:e,mediaKeySystemDomain:t};this._mediaKeysList.push(n),e.createMediaKeys().then((function(e){n.mediaKeys=e,d.b.log('Media-keys created for key-system "'+t+'"'),r._onMediaKeysCreated()})).catch((function(t){d.b.error("Failed to create media-keys:",t)}))},a._onMediaKeysCreated=function(){var t=this;this._mediaKeysList.forEach((function(e){e.mediaKeysSession||(e.mediaKeysSession=e.mediaKeys.createSession(),t._onNewMediaKeySession(e.mediaKeysSession))}))},a._onNewMediaKeySession=function(t){var e=this;d.b.log("New key-system session "+t.sessionId),t.addEventListener("message",(function(r){e._onKeySessionMessage(t,r.message)}),!1)},a._onKeySessionMessage=function(t,e){d.b.log("Got EME message event, creating license request"),this._requestLicense(e,(function(e){d.b.log("Received license data (length: "+(e?e.byteLength:e)+"), updating key-session"),t.update(e)}))},a._attemptSetMediaKeys=function(){if(!this._media)throw new Error("Attempted to set mediaKeys without first attaching a media element");if(!this._hasSetMediaKeys){var t=this._mediaKeysList[0];if(!t||!t.mediaKeys)return d.b.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),void this.hls.trigger(u.a.ERROR,{type:s.b.KEY_SYSTEM_ERROR,details:s.a.KEY_SYSTEM_NO_KEYS,fatal:!0});d.b.log("Setting keys for encrypted media"),this._media.setMediaKeys(t.mediaKeys),this._hasSetMediaKeys=!0}},a._generateRequestWithPreferredKeySession=function(t,e){var r=this,n=this._mediaKeysList[0];if(!n)return d.b.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),void this.hls.trigger(u.a.ERROR,{type:s.b.KEY_SYSTEM_ERROR,details:s.a.KEY_SYSTEM_NO_ACCESS,fatal:!0});if(n.mediaKeysSessionInitialized)d.b.warn("Key-Session already initialized but requested again");else{var i=n.mediaKeysSession;if(!i)return d.b.error("Fatal: Media is encrypted but no key-session existing"),void this.hls.trigger(u.a.ERROR,{type:s.b.KEY_SYSTEM_ERROR,details:s.a.KEY_SYSTEM_NO_SESSION,fatal:!0});if(!e)return d.b.warn("Fatal: initData required for generating a key session is null"),void this.hls.trigger(u.a.ERROR,{type:s.b.KEY_SYSTEM_ERROR,details:s.a.KEY_SYSTEM_NO_INIT_DATA,fatal:!0});d.b.log('Generating key-session request for "'+t+'" init data type'),n.mediaKeysSessionInitialized=!0,i.generateRequest(t,e).then((function(){d.b.debug("Key-session generation succeeded")})).catch((function(t){d.b.error("Error generating key-session request:",t),r.hls.trigger(u.a.ERROR,{type:s.b.KEY_SYSTEM_ERROR,details:s.a.KEY_SYSTEM_NO_SESSION,fatal:!1})}))}},a._createLicenseXhr=function(t,e,r){var n=new XMLHttpRequest,i=this._licenseXhrSetup;try{if(i)try{i(n,t)}catch(e){n.open("POST",t,!0),i(n,t)}n.readyState||n.open("POST",t,!0)}catch(t){throw new Error("issue setting up KeySystem license XHR "+t)}return n.responseType="arraybuffer",n.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,n,t,e,r),n},a._onLicenseRequestReadyStageChange=function(t,e,r,n){switch(t.readyState){case 4:if(200===t.status)this._requestLicenseFailureCount=0,d.b.log("License request succeeded"),"arraybuffer"!==t.responseType&&d.b.warn("xhr response type was not set to the expected arraybuffer for license request"),n(t.response);else{if(d.b.error("License Request XHR failed ("+e+"). Status: "+t.status+" ("+t.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount>3)return void this.hls.trigger(u.a.ERROR,{type:s.b.KEY_SYSTEM_ERROR,details:s.a.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0});d.b.warn("Retrying license request, "+(3-this._requestLicenseFailureCount+1)+" attempts left"),this._requestLicense(r,n)}}},a._generateLicenseRequestChallenge=function(t,e){switch(t.mediaKeySystemDomain){case ke.WIDEVINE:return e}throw new Error("unsupported key-system: "+t.mediaKeySystemDomain)},a._requestLicense=function(t,e){d.b.log("Requesting content license for key-system");var r=this._mediaKeysList[0];if(!r)return d.b.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),void this.hls.trigger(u.a.ERROR,{type:s.b.KEY_SYSTEM_ERROR,details:s.a.KEY_SYSTEM_NO_ACCESS,fatal:!0});try{var n=this.getLicenseServerUrl(r.mediaKeySystemDomain),i=this._createLicenseXhr(n,t,e);d.b.log("Sending license request to URL: "+n);var a=this._generateLicenseRequestChallenge(r,t);i.send(a)}catch(t){d.b.error("Failure requesting DRM license: "+t),this.hls.trigger(u.a.ERROR,{type:s.b.KEY_SYSTEM_ERROR,details:s.a.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},a.onMediaAttached=function(t){if(this._emeEnabled){var e=t.media;this._media=e,e.addEventListener("encrypted",this._onMediaEncrypted)}},a.onMediaDetached=function(){this._media&&(this._media.removeEventListener("encrypted",this._onMediaEncrypted),this._media=null)},a.onManifestParsed=function(t){if(this._emeEnabled){var e=t.levels.map((function(t){return t.audioCodec})),r=t.levels.map((function(t){return t.videoCodec}));this._attemptKeySystemAccess(ke.WIDEVINE,e,r)}},(i=[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}])&&function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(n.prototype,i),n}(h);function Fe(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Ue=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable})))),n.forEach((function(e){Fe(t,e,r[e])}))}return t}({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,liveDurationInfinity:!1,liveBackBufferLength:1/0,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:qt,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,abrController:Mt,bufferController:Ut,capLevelController:jt,fpsController:Ht,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,requestMediaKeySystemAccessFunc:Pe},{cueHandler:n,enableCEA708Captions:!0,enableWebVTT:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es"},{subtitleStreamController:Ie,subtitleTrackController:Oe,timelineController:Le,audioStreamController:Xt,audioTrackController:Yt,emeController:Me});function Be(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function je(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ge(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function He(t,e,r){return e&&Ge(t.prototype,e),r&&Ge(t,r),t}r.d(e,"default",(function(){return Ke}));var Ke=function(t){var e,r;function n(e){var r;void 0===e&&(e={}),(r=t.call(this)||this).config=void 0,r._autoLevelCapping=void 0,r.abrController=void 0,r.capLevelController=void 0,r.levelController=void 0,r.streamController=void 0,r.networkControllers=void 0,r.audioTrackController=void 0,r.subtitleTrackController=void 0,r.emeController=void 0,r.coreComponents=void 0,r.media=null,r.url=null;var i=n.DefaultConfig;if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");r.config=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable})))),n.forEach((function(e){Be(t,e,r[e])}))}return t}({},i,e);var a=je(r).config;if(void 0!==a.liveMaxLatencyDurationCount&&a.liveMaxLatencyDurationCount<=a.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==a.liveMaxLatencyDuration&&(void 0===a.liveSyncDuration||a.liveMaxLatencyDuration<=a.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');Object(d.a)(a.debug),r._autoLevelCapping=-1;var o=r.abrController=new a.abrController(je(r)),s=new a.bufferController(je(r)),l=r.capLevelController=new a.capLevelController(je(r)),u=new a.fpsController(je(r)),c=new O(je(r)),h=new N(je(r)),f=new x(je(r)),p=new Nt(je(r)),v=r.levelController=new Lt(je(r)),g=new F(je(r)),m=[v,r.streamController=new Ct(je(r),g)],y=a.audioStreamController;y&&m.push(new y(je(r),g)),r.networkControllers=m;var _=[c,h,f,o,s,l,u,p,g];if(y=a.audioTrackController){var b=new y(je(r));r.audioTrackController=b,_.push(b)}if(y=a.subtitleTrackController){var E=new y(je(r));r.subtitleTrackController=E,m.push(E)}if(y=a.emeController){var T=new y(je(r));r.emeController=T,_.push(T)}return(y=a.subtitleStreamController)&&m.push(new y(je(r),g)),(y=a.timelineController)&&_.push(new y(je(r))),r.coreComponents=_,r}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r,n.isSupported=function(){return function(){var t=K();if(!t)return!1;var e=self.SourceBuffer||self.WebKitSourceBuffer;return!(!t||"function"!=typeof t.isTypeSupported||!t.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')||e&&(!e.prototype||"function"!=typeof e.prototype.appendBuffer||"function"!=typeof e.prototype.remove))}()},He(n,null,[{key:"version",get:function(){return"0.13.2"}},{key:"Events",get:function(){return u.a}},{key:"ErrorTypes",get:function(){return s.b}},{key:"ErrorDetails",get:function(){return s.a}},{key:"DefaultConfig",get:function(){return n.defaultConfig?n.defaultConfig:Ue},set:function(t){n.defaultConfig=t}}]);var i=n.prototype;return i.destroy=function(){d.b.log("destroy"),this.trigger(u.a.DESTROYING),this.detachMedia(),this.coreComponents.concat(this.networkControllers).forEach((function(t){t.destroy()})),this.url=null,this.removeAllListeners(),this._autoLevelCapping=-1},i.attachMedia=function(t){d.b.log("attachMedia"),this.media=t,this.trigger(u.a.MEDIA_ATTACHING,{media:t})},i.detachMedia=function(){d.b.log("detachMedia"),this.trigger(u.a.MEDIA_DETACHING),this.media=null},i.loadSource=function(t){t=o.buildAbsoluteURL(window.location.href,t,{alwaysNormalize:!0}),d.b.log("loadSource:"+t),this.url=t,this.trigger(u.a.MANIFEST_LOADING,{url:t})},i.startLoad=function(t){void 0===t&&(t=-1),d.b.log("startLoad("+t+")"),this.networkControllers.forEach((function(e){e.startLoad(t)}))},i.stopLoad=function(){d.b.log("stopLoad"),this.networkControllers.forEach((function(t){t.stopLoad()}))},i.swapAudioCodec=function(){d.b.log("swapAudioCodec"),this.streamController.swapAudioCodec()},i.recoverMediaError=function(){d.b.log("recoverMediaError");var t=this.media;this.detachMedia(),t&&this.attachMedia(t)},He(n,[{key:"levels",get:function(){return this.levelController.levels}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(t){d.b.log("set currentLevel:"+t),this.loadLevel=t,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(t){d.b.log("set nextLevel:"+t),this.levelController.manualLevel=t,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(t){d.b.log("set loadLevel:"+t),this.levelController.manualLevel=t}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(t){this.levelController.nextLoadLevel=t}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(t){d.b.log("set firstLevel:"+t),this.levelController.firstLevel=t}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(t){d.b.log("set startLevel:"+t),-1!==t&&(t=Math.max(t,this.minAutoLevel)),this.levelController.startLevel=t}},{key:"capLevelToPlayerSize",set:function(t){var e=!!t;e!==this.config.capLevelToPlayerSize&&(e?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=e)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(t){d.b.log("set autoLevelCapping:"+t),this._autoLevelCapping=t}},{key:"bandwidthEstimate",get:function(){var t=this.abrController._bwEstimator;return t?t.getEstimate():NaN}},{key:"autoLevelEnabled",get:function(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){for(var t=this.levels,e=this.config.minAutoBitrate,r=t?t.length:0,n=0;n<r;n++)if((t[n].realBitrate?Math.max(t[n].realBitrate,t[n].bitrate):t[n].bitrate)>e)return n;return 0}},{key:"maxAutoLevel",get:function(){var t=this.levels,e=this.autoLevelCapping;return-1===e&&t&&t.length?t.length-1:e}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(t){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,t)}},{key:"audioTracks",get:function(){var t=this.audioTrackController;return t?t.audioTracks:[]}},{key:"audioTrack",get:function(){var t=this.audioTrackController;return t?t.audioTrack:-1},set:function(t){var e=this.audioTrackController;e&&(e.audioTrack=t)}},{key:"liveSyncPosition",get:function(){return this.streamController.liveSyncPosition}},{key:"subtitleTracks",get:function(){var t=this.subtitleTrackController;return t?t.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var t=this.subtitleTrackController;return t?t.subtitleTrack:-1},set:function(t){var e=this.subtitleTrackController;e&&(e.subtitleTrack=t)}},{key:"subtitleDisplay",get:function(){var t=this.subtitleTrackController;return!!t&&t.subtitleDisplay},set:function(t){var e=this.subtitleTrackController;e&&(e.subtitleDisplay=t)}}]),n}(W);Ke.defaultConfig=void 0}]).default}));